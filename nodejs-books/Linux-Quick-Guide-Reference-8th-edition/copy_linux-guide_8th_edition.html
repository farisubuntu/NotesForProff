<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
     "http://www.w3.org/TR/html4/transitional.dtd">
<html>
<head>

  <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
  <title></title>
  <meta name="generator" content="LibreOffice 6.4.5.2 (Linux)"/>
  <meta name="created" content="00:00:00"/>
  <meta name="changed" content="2020-08-22T03:49:14.822368324"/>
</head>
<body text="#373B97" bgcolor="#FFFFFF" link="#000080" vlink="#BA1D1D" alink="#0F8316">
<h1></h1>
<p><b>Linux</b></p>
<p><b>Quick Reference Guide</b></p>
<p><b>8</b></p>
<p><b>th</b></p>
<p><b> edition     January 2020</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Foreword</b></p>
<p>This guide stems from the notes I have been taking while studying and working as a Linux sysadmin and engineer.</p>
<p>It contains useful information about standards and tools for Linux system administration, as well as a good amount of topics </p>
<p>from the certification exams LPIC-1 (Linux Professional Institute Certification level 1), LPIC-2, RHCSA (Red Hat Certified </p>
<p>System Administrator), and RHCE (Red Hat Certified Engineer).  Unless otherwise specified, the shell of reference is Bash.</p>
<p>This is an independent publication and is not affiliated with LPI or Red Hat.  You can freely use and share the whole guide or </p>
<p>the single pages, provided that you distribute them unmodified and not for profit.</p>
<p>This document has been composed with Apache OpenOffice.</p>
<p>Happy Linux hacking,</p>
<p>Daniele Raffo</p>
<p><b>Version history</b></p>
<p>1</p>
<p>st</p>
<p> edition</p>
<p>2</p>
<p>nd</p>
<p> edition</p>
<p>3</p>
<p>rd</p>
<p> edition</p>
<p>4</p>
<p>th</p>
<p> edition</p>
<p>5</p>
<p>th</p>
<p> edition</p>
<p>6</p>
<p>th</p>
<p> edition</p>
<p>7</p>
<p>th</p>
<p> edition</p>
<p>8</p>
<p>th</p>
<p> edition</p>
<p>May 2013</p>
<p>September 2014</p>
<p>July 2015</p>
<p>June 2016</p>
<p>September 2017</p>
<p>August 2018</p>
<p>May 2019</p>
<p>January 2020</p>
<p><b>Bibliography and suggested readings</b></p>
<p>●</p>
<p>Evi Nemeth et al., <i>UNIX and Linux System Administration Handbook</i>, O'Reilly</p>
<p>●</p>
<p>Rebecca Thomas et al., <i>Advanced Programmer's Guide to Unix System V</i>, McGraw-Hill</p>
<p>●</p>
<p>Mendel Cooper, <i>Advanced Bash-Scripting Guide</i>, </p>
<p>http://tldp.org/LDP/abs/html</p>
<p>●</p>
<p>Adam Haeder et al., <i>LPI Linux Certification in a Nutshell</i>, O'Reilly</p>
<p>●</p>
<p>Heinrich W. Klöpping et al., <i>The LPIC-2 Exam Prep</i>, </p>
<p>http://lpic2.unix.nl</p>
<p>●</p>
<p>Michael Jang, <i>RHCSA/RHCE Red Hat Linux Certification Study Guide</i>, McGraw-Hill</p>
<p>●</p>
<p>Asghar Ghori, <i>RHCSA &amp; RHCE RHEL 7: Training and Exam Preparation Guide</i>, Lightning Source Inc.</p>
<p>●</p>
<p>Colin Barschel, <i>Unix Toolbox</i>, </p>
<p>http://cb.vu/unixtoolbox.xhtml</p>
<p>●</p>
<p>Ellen Siever et al., <i>Linux in a Nutshell</i>, O'Reilly, </p>
<p>http://archive.oreilly.com/linux/cmd</p>
<p>●</p>
<p>Christoph Braun, <i>Unix System Security Essentials</i>, Addison-Wesley </p>
<p>●</p>
<p>Bruce Barnett, <i>The Grymoire</i>, </p>
<p>http://www.grymoire.com/Unix</p>
<p>●</p>
<p>Brendan Gregg, <i>Linux performance</i>, </p>
<p>http://www.brendangregg.com/linuxperf.html</p>
<p>●</p>
<p>Linus Torvalds' Linux documentation, </p>
<p>https://github.com/torvalds/linux/tree/master/Documentation</p>
<p>●</p>
<p>RHEL manuals, </p>
<p>https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux</p>
<p>●</p>
<p>A-Z index of Bash command line, </p>
<p>http://ss64.com/bash</p>
<p>●</p>
<p>GNU software manuals, </p>
<p>http://www.gnu.org/manual</p>
<p>●</p>
<p>Shell command line snippets, </p>
<p>http://www.commandlinefu.com</p>
<p>●</p>
<p>Bash command line snippets, </p>
<p>http://www.bashoneliners.com</p>
<p>●</p>
<p>RAM management in Linux, </p>
<p>http://www.linuxatemyram.com</p>
<p>●</p>
<p>Regular expressions tester, </p>
<p>http://www.regextester.com</p>
<p>●</p>
<p>Bash pitfalls, </p>
<p>http://mywiki.wooledge.org/BashPitfalls</p>
<p>●</p>
<p>Linux man pages, </p>
<p>https://www.kernel.org/doc/man-pages</p>
<p>●</p>
<p>CentOS 7 man pages, </p>
<p>https://www.unix.com/man-page-centos-repository.php</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p><b>Index</b></p>
<p>LVM................................................1</p>
<p>LVM commands................................2</p>
<p>System boot....................................3</p>
<p>SysV startup sequence.....................4</p>
<p>Login..............................................5</p>
<p>Runlevels........................................6</p>
<p>SysV service management................7</p>
<p>Systemd service management...........8</p>
<p>/etc/inittab......................................9</p>
<p>Filesystem Hierarchy Standard.........10</p>
<p>Partitions and filesystem.................11</p>
<p>mount..........................................12</p>
<p>Filesystem types............................13</p>
<p>Swap............................................14</p>
<p>/etc/fstab......................................15</p>
<p>Filesystem operations.....................16</p>
<p>Filesystem maintenance..................17</p>
<p>XFS, ReiserFS, CD-ROM fs...............18</p>
<p>AutoFS..........................................19</p>
<p>RAID............................................20</p>
<p>Bootloader....................................21</p>
<p>GRUB 2 configuration......................22</p>
<p>GRUB 2 operations.........................23</p>
<p>GRUB Legacy.................................24</p>
<p>dpkg and apt.................................25</p>
<p>rpm..............................................26</p>
<p>yum.............................................27</p>
<p>yum repositories............................28</p>
<p>Backup.........................................29</p>
<p>Archive formats..............................30</p>
<p>Documentation..............................31</p>
<p>Shell usage...................................32</p>
<p>Text filters.....................................33</p>
<p>Advanced text filters.......................34</p>
<p>Regular expressions........................35</p>
<p>File management...........................36</p>
<p>Directory management...................37</p>
<p>File operations...............................38</p>
<p>I/O streams...................................39</p>
<p>read and echo................................40</p>
<p>Processes......................................41</p>
<p>Signals.........................................42</p>
<p>Resource monitoring.......................43</p>
<p>vmstat..........................................44</p>
<p>free..............................................45</p>
<p>File permissions.............................46</p>
<p>File attributes................................47</p>
<p>ACLs.............................................48</p>
<p>Links............................................49</p>
<p>Find system files............................50</p>
<p>Shell variables...............................51</p>
<p>Shell operations.............................52</p>
<p>Shell options..................................53</p>
<p>Shell scripting................................54</p>
<p>getopts.........................................55</p>
<p>Command execution.......................56</p>
<p>Tests............................................57</p>
<p>Operators......................................58</p>
<p>Flow control...................................59</p>
<p>Text processors..............................60</p>
<p>less..............................................61</p>
<p>Vi commands.................................62</p>
<p>Vi options......................................63</p>
<p>SQL..............................................64</p>
<p>SQL SELECT..................................65</p>
<p>SQL JOIN......................................66</p>
<p>MySQL..........................................67</p>
<p>MySQL tools..................................68</p>
<p>MySQL syntax................................69</p>
<p>MySQL status................................70</p>
<p>MySQL recipes...............................71</p>
<p>MySQL operations..........................72</p>
<p>PostgreSQL...................................73</p>
<p>X..................................................74</p>
<p>X tools..........................................75</p>
<p>X keysim codes..............................76</p>
<p>/etc/passwd...................................77</p>
<p>User management..........................78</p>
<p>Group management........................79</p>
<p>UID and GID..................................80</p>
<p>sudo and su...................................81</p>
<p>Terminals......................................82</p>
<p>Messaging.....................................83</p>
<p>cron.............................................84</p>
<p>at.................................................85</p>
<p>Utilities.........................................86</p>
<p>Localization...................................87</p>
<p>System time..................................88</p>
<p>syslog...........................................89</p>
<p>E-mail...........................................90</p>
<p>SMTP............................................91</p>
<p>Sendmail.......................................92</p>
<p>Exim.............................................93</p>
<p>Postfix..........................................94</p>
<p>Postfix configuration.......................95</p>
<p>Procmail........................................96</p>
<p>Courier POP configuration................97</p>
<p>Courier IMAP configuration..............98</p>
<p>Dovecot........................................99</p>
<p>Dovecot mailbox configuration........100</p>
<p>Dovecot POP/IMAP configuration.....101</p>
<p>Dovecot authentication..................102</p>
<p>FTP.............................................103</p>
<p>vsftpd.........................................104</p>
<p>CUPS..........................................105</p>
<p>IP addressing...............................106</p>
<p>Subnetting...................................107</p>
<p>Network services..........................108</p>
<p>Network configuration commands...109</p>
<p>Network configuration files.............110</p>
<p>Red Hat vs Debian network config...111</p>
<p>nmcli..........................................112</p>
<p>Teaming and bridging....................113</p>
<p>Wireless networking......................114</p>
<p>Network tools...............................115</p>
<p>Network monitoring......................116</p>
<p>tcpdump......................................117</p>
<p>netcat.........................................118</p>
<p>TCP Wrapper................................119</p>
<p>Routing.......................................120</p>
<p>iptables.......................................121</p>
<p>iptables rules...............................122</p>
<p>iptables NAT routing......................123</p>
<p>firewalld......................................124</p>
<p>firewalld rules..............................125</p>
<p>SSH............................................126</p>
<p>SSH tools....................................127</p>
<p>SSH operations............................128</p>
<p>SSH configuration.........................129</p>
<p>X.509..........................................130</p>
<p>OpenSSL.....................................131</p>
<p>CA.pl..........................................132</p>
<p>GnuPG........................................133</p>
<p>OpenVPN.....................................134</p>
<p>Security tools...............................135</p>
<p>Key bindings - terminal.................136</p>
<p>Key bindings - X Window...............137</p>
<p>udev...........................................138</p>
<p>Kernel.........................................139</p>
<p>Kernel management......................140</p>
<p>Kernel compile and patching..........141</p>
<p>Kernel modules............................142</p>
<p>/proc..........................................143</p>
<p>/dev...........................................144</p>
<p>System recovery..........................145</p>
<p>DNS............................................146</p>
<p>DNS configuration.........................147</p>
<p>DNS zone file...............................148</p>
<p>HTTP response codes....................149</p>
<p>Apache........................................150</p>
<p>Apache server configuration...........151</p>
<p>Apache main configuration.............152</p>
<p>Apache virtual hosts.....................153</p>
<p>Apache authorization....................154</p>
<p>Apache SSL/TLS...........................155</p>
<p>Apache proxy...............................156</p>
<p>Tomcat........................................157</p>
<p>Samba server..............................158</p>
<p>Samba client................................159</p>
<p>Samba global configuration............160</p>
<p>Samba share configuration............161</p>
<p>Samba access configuration...........162</p>
<p>Samba setup...............................163</p>
<p>NFS............................................164</p>
<p>/etc/exports.................................165</p>
<p>NFS setup....................................166</p>
<p>iSCSI..........................................167</p>
<p>iSCSI setup.................................168</p>
<p>DHCP..........................................169</p>
<p>PAM............................................170</p>
<p>LDAP..........................................171</p>
<p>ldapsearch...................................172</p>
<p>OpenLDAP...................................173</p>
<p>SELinux.......................................174</p>
<p>semanage...................................175</p>
<p>sealert........................................176</p>
<p>Kickstart.....................................177</p>
<p>Red Hat Satellite 6........................178</p>
<p>KVM............................................179</p>
<p>Git..............................................180</p>
<p>Git search and configuration..........181</p>
<p>Vagrant.......................................182</p>
<p>Puppet........................................183</p>
<p>Ansible........................................184</p>
<p>HTML 4.01 components.................185</p>
<p>HTML 4.01 text............................186</p>
<p>HTML 4.01 images........................187</p>
<p>HTML 4.01 tables..........................188</p>
<p>7-bit ASCII table..........................189</p>
<h1 style="page-break-before:always; "></h1>
<p><b>1/189</b></p>
<p><b>LVM</b></p>
<p><i>LVM</i></p>
<p>Logical Volume Management (LVM) introduces an abstraction between physical and logical storage, allowing a more versatile</p>
<p>use of filesystems.  LVM uses the Linux device mapper feature (</p>
<p>/dev/mapper</p>
<p>).</p>
<p>Disks, partitions, and RAID devices are made of <b>Physical Volumes</b>, which are grouped into a <b>Volume Group</b>.</p>
<p>A Volume Group is divided into small fixed-size chunks called Physical Extents, which are mapped 1-to-1 to Logical Extents. </p>
<p>Logical Extents are grouped into <b>Logical Volumes</b>, on which filesystems are created. </p>
<p><b>How to create a Logical Volume</b></p>
<p>1.</p>
<p>Add a new disk to the machine</p>
<p>2.</p>
<p>lsblk</p>
<p>Verify that the new disk is recognized e.g. as </p>
<p>/dev/sda</p>
<p>3.</p>
<p>fdisk /dev/sda</p>
<p>Create a new partition (of type 0x8E = Linux LVM) on the </p>
<p>new disk.  This is not necessary but recommended, </p>
<p>because other OSes might not recognize the LVM header </p>
<p>and see the whole unpartitioned disk as empty</p>
<p>4.</p>
<p>pvcreate /dev/sda1</p>
<p>Initialize the Physical Volume to be used with LVM</p>
<p>5.</p>
<p>vgcreate -s 8M myvg0 /dev/sda1 </p>
<p>Create a Volume Group and define the size of Physical </p>
<p>Extents to 8 Mb (default value is 4 Mb)</p>
<p>or</p>
<p>vgextend myvg0 /dev/sda1</p>
<p>or add the Physical Volume to an existing Volume Group</p>
<p>6.</p>
<p>lvcreate -L 1024M -n mylv myvg0</p>
<p>Create a Logical Volume</p>
<p>7.</p>
<p>mkfs -t ext3 /dev/myvg0/mylv</p>
<p>Create a filesystem on the Logical Volume</p>
<p>8.</p>
<p>mount /dev/myvg0/mylv /mnt/mystuff</p>
<p>Mount the Logical Volume</p>
<p><b>How to increase the size of a Logical Volume (operation possible only if the underlying filesystem allows it)</b></p>
<p>1.</p>
<p>Add a new disk to the machine, to provide the extra disk space </p>
<p>2.</p>
<p>pvcreate /dev/sdc</p>
<p>Initialize the Physical Volume </p>
<p>3.</p>
<p>vgextend myvg0 /dev/sdc</p>
<p>Add the Physical Volume to an existing Volume Group</p>
<p>or</p>
<p>1.</p>
<p>Increase the size of an existing disk (already initialized as PV)</p>
<p>2.</p>
<p>partprobe</p>
<p>Notify the kernel of the new disk size</p>
<p>3.</p>
<p>pvresize /dev/sdc</p>
<p>Accommodate the Physical Volume to the new size </p>
<p>Then:</p>
<p>4.</p>
<p>lvextend -L 2048M /dev/myvg0/mylv</p>
<p>Extend the Logical Volume by 2 Gb</p>
<p>or</p>
<p>lvresize -L+2048M /dev/myvg0/mylv</p>
<p>or</p>
<p>lvresize -l+100%FREE /dev/myvg/mylv</p>
<p>or extend the Logical Volume taking all free space </p>
<p>5.</p>
<p>resize2fs /dev/myvg0/mylv   </p>
<p>(ext)</p>
<p>xfs_growfs /dev/myvg0/mylv  </p>
<p>(XFS)</p>
<p>Extend the filesystem.</p>
<p>Alternatively, use </p>
<p>lvresize -r</p>
<p> on the previous step</p>
<p><b>How to reduce the size of a Logical Volume (operation possible only if the underlying filesystem allows it)</b></p>
<p>1.</p>
<p>resize2fs /dev/myvg0/mylv 900M</p>
<p>Shrink the filesystem to 900 Mb</p>
<p>2.</p>
<p>lvreduce -L 900M /dev/myvg0/mylv</p>
<p>Shrink the Logical Volume to 900 Mb</p>
<p>or</p>
<p>lvresize -L 900M /dev/myvg0/mylv</p>
<p><b>How to snapshot and backup a Logical Volume</b></p>
<p>1.</p>
<p>lvcreate -s -L 1024M -n mysnap /dev/myvg0/mylv</p>
<p>Create the snapshot like a Logical Volume</p>
<p>2.</p>
<p>tar cvzf mysnap.tar.gz mysnap </p>
<p>Backup the snapshot with any backup tool</p>
<p>3.</p>
<p>lvremove /dev/mvvg0/mysnap</p>
<p>Delete the snapshot</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>2/189</b></p>
<p><b>LVM commands</b></p>
<p><i>LVM commands</i></p>
<p><b>PV commands</b></p>
<p><b>VG commands</b></p>
<p><b>LV commands</b></p>
<p>pvs</p>
<p>Report information about</p>
<p>Physical Volumes</p>
<p>vgs</p>
<p>Report information </p>
<p>about Volume Groups</p>
<p>lvs</p>
<p>Report information </p>
<p>about Logical Volumes</p>
<p>pvscan</p>
<p>Scan all disks for </p>
<p>Physical Volumes</p>
<p>vgscan</p>
<p>Scan all disks for </p>
<p>Volume Groups</p>
<p>lvscan</p>
<p>Scan all disks for </p>
<p>Logical Volumes</p>
<p>pvdisplay</p>
<p>Display Physical Volume </p>
<p>attributes</p>
<p>vgdisplay</p>
<p>Display Volume Group </p>
<p>attributes</p>
<p>lvdisplay</p>
<p>Display Logical Volume </p>
<p>attributes</p>
<p>pvck</p>
<p>Check Physical Volume </p>
<p>metadata</p>
<p>vgck</p>
<p>Check Volume Group </p>
<p>metadata</p>
<p>pvcreate</p>
<p>Initialize a disk or </p>
<p>partition for use with </p>
<p>LVM</p>
<p>vgcreate</p>
<p>Create a Volume Group</p>
<p>using Physical Volumes</p>
<p>lvcreate</p>
<p>Create a Logical </p>
<p>Volume in a Volume </p>
<p>Group</p>
<p>pvchange</p>
<p>Change Physical Volume </p>
<p>attributes</p>
<p>vgchange</p>
<p>Change Volume Group </p>
<p>attributes</p>
<p>lvchange</p>
<p>Change Logical Volume </p>
<p>attributes</p>
<p>pvremove</p>
<p>Remove a Physical </p>
<p>Volume</p>
<p>vgremove</p>
<p>Remove a Volume </p>
<p>Group</p>
<p>lvremove</p>
<p>Remove a Logical </p>
<p>Volume</p>
<p>vgextend</p>
<p>Add a Physical Volume </p>
<p>to a Volume Group</p>
<p>lvextend</p>
<p>Increase the size of a </p>
<p>Logical Volume</p>
<p>vgreduce </p>
<p>Remove a Physical </p>
<p>Volume from a Volume </p>
<p>Group</p>
<p>lvreduce</p>
<p>Shrink the size a </p>
<p>Logical Volume</p>
<p>pvresize</p>
<p>Modify the size of a  </p>
<p>Physical Volume</p>
<p>lvresize</p>
<p>Modify the size of a </p>
<p>Logical Volume</p>
<p>vgmerge</p>
<p>Merge two Volume </p>
<p>Groups</p>
<p>vgsplit</p>
<p>Split two Volume </p>
<p>Groups</p>
<p>vgimport</p>
<p>Import a Volume Group</p>
<p>into a system</p>
<p>vgexport</p>
<p>Export a Volume Group </p>
<p>from a system </p>
<p>pvmove </p>
<p>Move the Logical Extents</p>
<p>on a Physical Volume to </p>
<p>wherever there are </p>
<p>available Physical </p>
<p>Extents (within the </p>
<p>Volume Group) and then</p>
<p>put the Physical Volume </p>
<p>offline </p>
<p><b>LVM global commands</b></p>
<p>dmsetup <i>command</i></p>
<p>Perform low-level LVM operations</p>
<p>lvm <i>command</i></p>
<p>Perform LVM operations.  May also be used as an interactive tool</p>
<p>lvmsar</p>
<p>LVM system activity reporter.  Unsupported on LVM2</p>
<p>lvmdiskscan</p>
<p>Scan the system for disks and partitions usable by LVM</p>
<p>lvmconfig</p>
<p>Show the current LVM disk configuration</p>
<p>/dev/mapper/<i>vgname-lvname</i></p>
<p>/dev/<i>vgname</i>/<i>lvname</i></p>
<p>Mapping of Logical Volumes in the filesystem</p>
<p>/etc/lvm/archive/ </p>
<p>Directory containing Volume Groups metadata backups</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>3/189</b></p>
<p><b>System boot</b></p>
<p><i>System boot</i></p>
<p><b>Boot sequence</b></p>
<p><b>POST</b></p>
<p><b>(Power-On Self Test)</b></p>
<p>Low-level check of PC hardware.</p>
<p><b>BIOS</b></p>
<p><b>(Basic I/O System)</b></p>
<p>Detection of disks and hardware.</p>
<p><b>Chain loader</b></p>
<p><b>GRUB</b></p>
<p><b>(GRand Unified</b></p>
<p><b>Bootloader)</b></p>
<p>GRUB stage 1 is loaded from the MBR and executes GRUB stage 2 from filesystem.  </p>
<p>GRUB chooses which OS to boot on.</p>
<p>The chain loader hands over to the boot sector of the partition on which resides the OS.</p>
<p>The chain loader also mounts </p>
<p>initrd</p>
<p>, an initial ramdisk (typically a compressed ext2 </p>
<p>filesystem) to be used as the initial root device during kernel boot; this make possible to </p>
<p>load kernel modules that recognize hard drives hardware and that are hence needed to </p>
<p>mount the real root filesystem.  Afterwards, the system runs </p>
<p>/linuxrc</p>
<p> with PID 1.</p>
<p>(From Linux 2.6.13 onwards, the system instead loads into memory </p>
<p>initramfs</p>
<p>, a cpio-</p>
<p>compressed image, and unpacks it into an instance of tmpfs in RAM.  The kernel then </p>
<p>executes </p>
<p>/init</p>
<p> from within the image.)</p>
<p><b>Linux kernel</b></p>
<p>Kernel decompression into memory.</p>
<p>Kernel execution.</p>
<p>Detection of devices.</p>
<p>The real root filesystem is mounted on </p>
<p>/</p>
<p> in place of the initial ramdisk.</p>
<p><b>init</b></p>
<p>Execution of </p>
<p>init</p>
<p>, the first process (PID 1). </p>
<p>The system tries to execute in the following order:</p>
<p>/sbin/init</p>
<p>/etc/init</p>
<p>/bin/init</p>
<p>/bin/sh</p>
<p>If none of these succeeds, the kernel panics.</p>
<p><b>Startup</b></p>
<p>The system loads startup scripts and runlevel scripts.</p>
<p><b>Login</b></p>
<p>If in text mode, </p>
<p>init</p>
<p> calls the </p>
<p>getty</p>
<p> process, which runs the </p>
<p>login</p>
<p> command that asks </p>
<p>the user for login and password. </p>
<p>If in graphical mode, the X Display Manager starts the X Server.</p>
<p>Newer systems use UEFI (Unified Extensible Firmware Interface) instead of BIOS.  UEFI does not use the MBR boot code; it </p>
<p>has knowledge of partition table and filesystems, and stores its application files required for launch in a EFI System </p>
<p>Partition, mostly formatted as FAT32.</p>
<p>After the POST, the system loads the UEFI firmware which initializes the hardware required for booting, then reads its Boot </p>
<p>Manager data to determine which UEFI application to launch.  The launched UEFI application may then launch another </p>
<p>application, e.g. the kernel and </p>
<p>initramfs</p>
<p> in case of a boot loader like GRUB.</p>
<p>Information about the boot process can be found in the manpages </p>
<p>man 7 boot</p>
<p> and </p>
<p>man 7 bootup</p>
<p>.</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>4/189</b></p>
<p><b>SysV startup sequence</b></p>
<p><i>SysV startup sequence</i></p>
<p><b>Startup sequence</b></p>
<p><b>Debian</b></p>
<p><b>Red Hat</b></p>
<p>At startup </p>
<p>/sbin/init</p>
<p> executes all </p>
<p>instructions on </p>
<p>/etc/inittab</p>
<p>.  This script</p>
<p>at first switches to the default runlevel... </p>
<p>id:2:initdefault:</p>
<p>id:5:initdefault:</p>
<p>... then it runs the following script (same for </p>
<p>all runlevels) which configures peripheral </p>
<p>hardware, applies kernel parameters, sets </p>
<p>hostname, and provides disks initialization...</p>
<p>/etc/init.d/rcS</p>
<p>/etc/rc.d/rc.sysinit </p>
<p>or </p>
<p>/etc/rc.sysinit</p>
<p>... and then, for runlevel <i>N</i>, it calls the script</p>
<p>/etc/init.d/rc <i>N </i></p>
<p>(i.e. with the runlevel </p>
<p>number as parameter) which launches all </p>
<p>services and daemons specified in the </p>
<p>following startup directories:</p>
<p>/etc/rc<i>N</i>.d/</p>
<p>/etc/rc.d/rc<i>N</i>.d/</p>
<p>The startup directories contain symlinks to the init scripts in </p>
<p>/etc/init.d/</p>
<p> which are executed in numerical order.</p>
<p>Links starting with K are called with argument </p>
<p>stop</p>
<p>, links starting with S are called with argument </p>
<p>start</p>
<p>. </p>
<p> </p>
<p>lrwxrwxrwx.  1 root root   14 Feb 11 22:32 K88sssd -&gt; ../init.d/sssd</p>
<p>lrwxrwxrwx.  1 root root   15 Nov 28 14:50 K89rdisc -&gt; ../init.d/rdisc</p>
<p>lrwxrwxrwx.  1 root root   17 Nov 28 15:01 S01sysstat -&gt; ../init.d/sysstat</p>
<p>lrwxrwxrwx.  1 root root   18 Nov 28 14:54 S05cgconfig -&gt; ../init.d/cgconfig</p>
<p>lrwxrwxrwx.  1 root root   16 Nov 28 14:52 S07iscsid -&gt; ../init.d/iscsid</p>
<p>lrwxrwxrwx.  1 root root   18 Nov 28 14:42 S08iptables -&gt; ../init.d/iptables</p>
<p>The last script to be run is </p>
<p>S99local -&gt; ../init.d/rc.local</p>
<p>; therefore, an easy way to run a specific program upon</p>
<p>boot is to call it from this script file. </p>
<p>/etc/init.d/boot.local    </p>
<p>/etc/init.d/before.local  </p>
<p>(SUSE) </p>
<p>/etc/init.d/after.local   </p>
<p>(SUSE) </p>
<p>runs only at boot time, not when switching runlevel.</p>
<p>runs only at boot time, before the scripts in the startup directories.</p>
<p>runs only at boot time, after the scripts in the startup directories.</p>
<p>To add or remove services at boot sequence: </p>
<p>update-rc.d <i>service</i> defaults</p>
<p>update-rc.d -f <i>service</i> remove</p>
<p>chkconfig --add <i>service</i></p>
<p>chkconfig --del <i>service</i></p>
<p>When adding or removing a service at boot, startup directories will be updated by creating or deleting symlinks for the</p>
<p>default runlevels: K symlinks for runlevels 0 1 6, and S symlinks for runlevels 2 3 4 5.</p>
<p>Service will be run via the </p>
<p>xinetd</p>
<p> super server.</p>
<p><b>Supported service operations</b></p>
<p>start</p>
<p>Start the service</p>
<p>Mandatory</p>
<p>stop</p>
<p>Stop the service</p>
<p>restart</p>
<p>Restart the service (stop, then start)</p>
<p>status</p>
<p>Display daemon PID and execution status</p>
<p>force-reload</p>
<p>Reload configuration if service supports it, otherwise restart</p>
<p>condrestart</p>
<p>try-restart</p>
<p>Restart the service only if already running</p>
<p>Optional</p>
<p>reload</p>
<p>Reload the service configuration</p>
<p><b>Linux Standard Base (LSB)</b></p>
<p>The Linux Standard Base defines a format to specify default values on an init script </p>
<p>/etc/init.d/foo</p>
<p>:</p>
<p>### BEGIN INIT INFO</p>
<p># Provides: foo</p>
<p># Required-Start: bar</p>
<p># Defalt-Start: 2 3 4 5</p>
<p># Default-Stop: 0 1 6</p>
<p># Description: Service Foo init script</p>
<p>### END INIT INFO</p>
<p>Default runlevels and S/K symlinks values can also be specified as such:</p>
<p># chkconfig: 2345 85 15</p>
<p># description: Foo service</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>5/189</b></p>
<p><b>Login</b></p>
<p><i>Login</i></p>
<p>/etc/init/start-ttys.conf  </p>
<p>(Red Hat)</p>
<p>Start the specified number of terminals at bootup via </p>
<p>getty</p>
<p>, which </p>
<p>manages physical or virtual terminals (TTYs)</p>
<p>/etc/sysconfig/init  </p>
<p>(Red Hat)</p>
<p>Control appearance and functioning of the system during bootup</p>
<p>/etc/machine-id  </p>
<p>(Red Hat)</p>
<p>Randomly-generated machine ID.  </p>
<p>The machine ID can be safely regenerated by deleting this file and then </p>
<p>running the command </p>
<p>systemd-machine-id-setup</p>
<p>/etc/securetty</p>
<p>List of TTYs from which the root user is allowed to login</p>
<p>/etc/issue</p>
<p>Message printed before the login prompt.  Can contain these escape codes:</p>
<p>\b  </p>
<p>Baudrate of line</p>
<p>\d  </p>
<p>Date</p>
<p>\s  </p>
<p>System name and OS</p>
<p>\l  </p>
<p>Terminal device line</p>
<p>\m  </p>
<p>Machine architecture identifier</p>
<p>\n  </p>
<p>Nodename aka hostname</p>
<p>\o  </p>
<p>Domain name</p>
<p>\r  </p>
<p>OS release number</p>
<p>\t  </p>
<p>Time</p>
<p>\u  </p>
<p>Number of users logged in</p>
<p>\U  </p>
<p>&quot;<i>n</i> users&quot; logged in</p>
<p>\v  </p>
<p>OS version and build date</p>
<p>/etc/issue.net</p>
<p>Message printed before the login prompt on a remote session</p>
<p>/etc/motd</p>
<p>Message Of The Day, printed after a successful login, but before execution </p>
<p>of the login shell</p>
<p>/etc/nologin</p>
<p>If this file exists, </p>
<p>login</p>
<p> and </p>
<p>sshd</p>
<p> deny login to all unprivileged users.</p>
<p>Useful when doing system maintenance</p>
<p>/var/log/secure    </p>
<p>(Red Hat)</p>
<p>/var/log/auth.log  </p>
<p>(Debian)</p>
<p>Logfile containing user logins (both successful and failed) and </p>
<p>authentication mechanisms</p>
<p>/var/log/pwdfail</p>
<p>Logfile containing failed authentication attempts</p>
<p>To prevent a specific user to log in, their shell can be set either as:</p>
<p>/bin/false</p>
<p>user is forced to exit immediately</p>
<p>/sbin/nologin</p>
<p>user is prompted a message and forced to exit; the message is &quot;This account is currently not available&quot;</p>
<p>or the contents of file </p>
<p>/etc/nologin.txt</p>
<p> if it exists</p>
<p>who</p>
<p>Print the list of users logged into the system</p>
<p>w</p>
<p>Print the list of users logged into the system, and what they are doing</p>
<p>last</p>
<p>Print the list of users that logged in and out.  Searches through the file </p>
<p>/var/log/wtmp</p>
<p> </p>
<p>lastb</p>
<p>Print the list of bad login attempts.  Searches through the file </p>
<p>/var/log/btmp</p>
<p>fail2ban</p>
<p>Temporarily ban IP addresses (via firewall rules) that have too many failed password logins.</p>
<p>This information is taken from authentication logs</p>
<p>pam_tally2</p>
<p>Deny access to users that have too many failed logins </p>
<p>acct on</p>
<p>acct off</p>
<p>Turn process accounting on or off</p>
<p>ac</p>
<p>Print statistics about connect time of users</p>
<p>lastcomm</p>
<p>Print information about previously executed commands</p>
<p>sa</p>
<p>Print summarized information about previously executed commands</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>6/189</b></p>
<p><b>Runlevels</b></p>
<p><i>Runlevels</i></p>
<p><b>Runlevel</b></p>
<p><b>(SysV)</b></p>
<p><b>Target</b></p>
<p><b>(Systemd)</b></p>
<p><b>Debian</b></p>
<p><b>Red Hat</b></p>
<p><b>0</b></p>
<p>Shutdown</p>
<p><b>1</b></p>
<p>Single user / maintenance mode</p>
<p>default</p>
<p>runlevels</p>
<p><b>2</b></p>
<p>Multi-user mode</p>
<p>(default)</p>
<p>Multi-user mode without network</p>
<p><b>3</b></p>
<p><b>multi-user.target</b></p>
<p>Multi-user mode</p>
<p>Multi-user mode with network</p>
<p><b>4</b></p>
<p>Multi-user mode</p>
<p>Unused, for custom use</p>
<p><b>5</b></p>
<p><b>graphical.target</b></p>
<p>Multi-user mode</p>
<p>Multi-user mode with network and X</p>
<p>(default)</p>
<p><b>6</b></p>
<p>Reboot</p>
<p><b>S</b></p>
<p>Single user / maintenance mode</p>
<p>(usually accessed through runlevel 1)</p>
<p>Systemd's target </p>
<p>runlevel<i>n</i>.target</p>
<p> emulates a SysV's runlevel <i>n</i>.</p>
<p>runlevel</p>
<p>who -r</p>
<p>Display the previous and the current runlevel</p>
<p>init <i>runlevel</i></p>
<p>telinit <i>runlevel</i></p>
<p>Change to <i>runlevel</i> </p>
<p>systemctl get-default</p>
<p>Get the default target</p>
<p>systemctl set-default <i>target</i></p>
<p>Set <i>target</i> as the default target</p>
<p>systemctl isolate <i>target</i></p>
<p>Change to <i>target</i></p>
<p>systemctl emergency</p>
<p>Change to maintenance single-user mode with only </p>
<p>/root</p>
<p> filesystem mounted </p>
<p>systemctl rescue</p>
<p>Change to maintenance single-user mode with only local filesystems mounted </p>
<p>systemctl -t target</p>
<p>List targets</p>
<p>init 0</p>
<p>telinit 0</p>
<p>shutdown -h now</p>
<p>halt</p>
<p>poweroff</p>
<p>systemctl isolate shutdown.target</p>
<p>Halt the system</p>
<p>init 6</p>
<p>telinit 6</p>
<p>shutdown -r now</p>
<p>reboot</p>
<p>systemctl isolate reboot.target</p>
<p>Reboot the system</p>
<p>shutdown</p>
<p>Shut down the system in a secure way: all logged-in users are notified via a </p>
<p>message to their terminal, and login is disabled.  Can only be run by the root user</p>
<p>shutdown -a</p>
<p>Non-root users that are listed in </p>
<p>/etc/shutdown.allow</p>
<p> can use this command to </p>
<p>shut down the system</p>
<p> </p>
<p>shutdown -h 16:00 <i>message</i></p>
<p>Schedule a shutdown for 4 PM and send a warning message to all logged-in users </p>
<p>shutdown -f</p>
<p>Skip fsck on reboot</p>
<p>shutdown -F</p>
<p>Force fsck on reboot</p>
<p>shutdown -c</p>
<p>Cancel a shutdown that has been already initiated</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>7/189</b></p>
<p><b>SysV service management</b></p>
<p><i>SysV service management</i></p>
<p>/etc/init.d/<i>service</i> <i>operation</i></p>
<p>service <i>service</i> <i>operation</i>      </p>
<p>(Red Hat)</p>
<p>rc<i>service</i> <i>operation</i>            </p>
<p>(SUSE)</p>
<p>Perform the specified operation (</p>
<p>start</p>
<p>, </p>
<p>stop</p>
<p>, </p>
<p>status</p>
<p>, etc.) on the </p>
<p>specified service</p>
<p>update-rc.d <i>service</i> defaults   </p>
<p>(Debian)</p>
<p>chkconfig --add <i>service </i>       </p>
<p>(Red Hat)</p>
<p>Add a service at boot </p>
<p>update-rc.d -f <i>service</i> remove  </p>
<p>(Debian)</p>
<p>chkconfig --del <i>service</i>        </p>
<p>(Red Hat)</p>
<p>Remove a service at boot </p>
<p>update-rc.d -f <i>service</i> \</p>
<p>start 30 2 3 4 5 . stop 70 0 1 6 .</p>
<p>Add a service on the default runlevels; creates S30 symlinks for </p>
<p>starting the service and K70 symlinks for stopping it</p>
<p>chkconfig --levels 245 <i>service</i> on</p>
<p>Add the service on runlevels 2 4 5</p>
<p>chkconfig <i>service</i> on</p>
<p>Add the service on default runlevels </p>
<p>chkconfig <i>service</i> off</p>
<p>Remove the service on default runlevels</p>
<p>chkconfig <i>service</i></p>
<p>Check if the service is enabled on the current runlevel</p>
<p>chkconfig <i>service</i> reset</p>
<p>Reset the on/off state of the service for all runlevels to whatever </p>
<p>the LSB specifies in the init script</p>
<p>chkconfig <i>service</i> resetpriorities</p>
<p>Reset the start/stop priorities of the service for all runlevels to </p>
<p>whatever the LSB specifies in the init script</p>
<p>chkconfig --list <i>service</i></p>
<p>Display current configuration of service (its status and the </p>
<p>runlevels in which it is active)</p>
<p>chkconfig</p>
<p>chkconfig --list</p>
<p>List all active services and their current configuration</p>
<p>ls /etc/rc<i>n</i>.d  </p>
<p>(Debian)</p>
<p>List services started on runlevel <i>n</i> </p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>8/189</b></p>
<p><b>Systemd service management</b></p>
<p><i>Systemd service management</i></p>
<p>systemctl <i>operation</i> <i>service</i> </p>
<p>Perform the specified operation (</p>
<p>start</p>
<p>, </p>
<p>stop</p>
<p>, </p>
<p>status</p>
<p>, etc.) on the </p>
<p>specified service (unit file)</p>
<p>systemctl enable <i>service</i> </p>
<p>Add the service on the current target </p>
<p>systemctl disable <i>service</i> </p>
<p>Remove the service on the current target </p>
<p>systemctl is-enabled <i>service</i> </p>
<p>Check if the service is enabled on the current target </p>
<p>systemctl mask <i>service</i> </p>
<p>Mask the service on the current target.  This prevents the service </p>
<p>to be enabled or started </p>
<p>systemctl unmask <i>service</i> </p>
<p>Unmask the service on the current target</p>
<p>systemctl list-unit-files --type=service</p>
<p>List all active services and their current configuration</p>
<p>systemctl</p>
<p>List loaded and active units </p>
<p>systemctl --all</p>
<p>List all units, including inactive ones </p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>9/189</b></p>
<p><b>/etc/inittab</b></p>
<p><i>/etc/inittab</i></p>
<p><b>/etc/inittab</b></p>
<p># The default runlevel.</p>
<p>id:2:initdefault:</p>
<p># Boot-time system configuration/initialization script.</p>
<p># This is run first except when booting in emergency (-b) mode.</p>
<p>si::sysinit:/etc/init.d/rcS</p>
<p># What to do in single-user mode.</p>
<p>~~:S:wait:/sbin/sulogin</p>
<p># /etc/init.d executes the S and K scripts upon change of runlevel.</p>
<p>l0:0:wait:/etc/init.d/rc 0</p>
<p>l1:1:wait:/etc/init.d/rc 1</p>
<p>l2:2:wait:/etc/init.d/rc 2</p>
<p>l3:3:wait:/etc/init.d/rc 3</p>
<p>l4:4:wait:/etc/init.d/rc 4</p>
<p>l5:5:wait:/etc/init.d/rc 5</p>
<p>l6:6:wait:/etc/init.d/rc 6</p>
<p># Normally not reached, but fall through in case of emergency.</p>
<p>z6:6:respawn:/sbin/sulogin</p>
<p># /sbin/getty invocations for the runlevels.</p>
<p># Id field must be the same as the last characters of the device (after &quot;tty&quot;).</p>
<p>1:2345:respawn:/sbin/getty 38400 tty1</p>
<p>2:23:respawn:/sbin/getty 38400 tty2</p>
<p>/etc/inittab</p>
<p> describes which processes are started at bootup and during normal operation; it is read and executed by </p>
<p>init</p>
<p> at bootup.</p>
<p>All its entries have the form </p>
<p><i><b>id</i>:<i>runlevels</i>:<i>action</i>:<i>process</b></i></p>
<p><i>.</i></p>
<p><b>id</b></p>
<p>1-4 characters, uniquely identifies an entry.  </p>
<p>For gettys and other login processes it should be equal to the suffix of the corresponding tty</p>
<p><b>runlevels</b></p>
<p>Runlevels for which the specified action must be performed.  </p>
<p>If empty, action is performed on all runlevels</p>
<p><b>action</b></p>
<p>respawn</p>
<p>Process will be restarted when it terminates </p>
<p>wait</p>
<p>Process is started at the specified runlevel and </p>
<p>init</p>
<p> will wait for its termination</p>
<p>(i.e. execution of further lines of </p>
<p>/etc/inittab</p>
<p> stops until the process exits)</p>
<p>once</p>
<p>Process is executed once at the specified runlevel</p>
<p>boot</p>
<p>Process is executed at system boot.  Runlevels field is ignored</p>
<p>bootwait</p>
<p>Process is executed at system boot and </p>
<p>init</p>
<p> will wait for its termination.  </p>
<p>Runlevels field is ignored</p>
<p>off</p>
<p>Does nothing</p>
<p>ondemand</p>
<p>Process is executed when an on-demand runlevel (A, B, C) is called </p>
<p>initdefault</p>
<p>Specifies the default runlevel to boot on.  Process field is ignored</p>
<p>sysinit</p>
<p>Process is executed at system boot, before any </p>
<p>boot</p>
<p> or </p>
<p>bootwait</p>
<p> entries.  </p>
<p>Runlevels field is ignored</p>
<p>powerfail</p>
<p>Process is executed when power goes down and an UPS kicks in.  </p>
<p>init</p>
<p> will not wait for its termination</p>
<p>powerwait</p>
<p>Process is executed when power goes down and an UPS kicks in.  </p>
<p>init</p>
<p> will wait for its termination</p>
<p>powerfailnow</p>
<p>Process is executed when power is down and the UPS battery is almost empty</p>
<p>powerokwait</p>
<p>Process is executed when power has been restored from UPS</p>
<p>ctrlaltdel</p>
<p>Process is executed when </p>
<p>init</p>
<p> receives a SIGINT via </p>
<p>kbdrequest</p>
<p>Process is executed when a special key combination is pressed on console</p>
<p><b>process</b></p>
<p>Process to execute.  If prepended by a </p>
<p>+</p>
<p>, </p>
<p>utmp</p>
<p> and </p>
<p>wtmp</p>
<p> accounting will not be performed</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>CTRL</p>
<p>ALT</p>
<p>DEL</p>
<h1 style="page-break-before:always; "></h1>
<p><b>10/189</b></p>
<p><b>Filesystem Hierarchy Standard</b></p>
<p><i>Filesystem Hierarchy Standard</i></p>
<p><b>Filesystem Hierarchy Standard (FHS)</b></p>
<p>/bin</p>
<p>Essential command binaries for all users</p>
<p>/boot</p>
<p>Bootloader files (OS loader, kernel image, initrd, etc.)</p>
<p>/dev</p>
<p>Virtual filesystem containing device nodes to devices and partitions</p>
<p>/etc</p>
<p>System configuration files and scripts</p>
<p>/home</p>
<p>Home directories for users</p>
<p>/lib</p>
<p>Libraries for the binaries in </p>
<p>/bin</p>
<p> and </p>
<p>/sbin</p>
<p>, kernel modules</p>
<p>/lost+found</p>
<p>Storage directory for recovered files in this partition</p>
<p>/media</p>
<p>Mount points for removable media</p>
<p>/mnt</p>
<p>Mount points for temporary filesystems</p>
<p>/net</p>
<p>Access to directory tree on different external NFS servers</p>
<p>/opt</p>
<p>Optional, large add-on application software packages</p>
<p>/proc</p>
<p>Virtual filesystem providing kernel and processes information</p>
<p>/root</p>
<p>Home directory for the root user</p>
<p>/run</p>
<p>Runtime variable data; replaces </p>
<p>/var/run</p>
<p>/sbin</p>
<p>Essential system binaries, system administration commands</p>
<p>/srv</p>
<p>Data for services provided by the system</p>
<p>/sys</p>
<p>Virtual filesystem providing information about hotplug hardware devices</p>
<p>/tmp</p>
<p>Temporary files; deleted at reboot</p>
<p>/usr</p>
<p>User utilities and applications</p>
<p>   /usr/bin</p>
<p>Non-essential command binaries for all users</p>
<p>   /usr/include</p>
<p>C header files</p>
<p>   /usr/lib</p>
<p>Libraries for the binaries in </p>
<p>/usr/bin</p>
<p> and </p>
<p>/usr/sbin</p>
<p>   /usr/local</p>
<p>Software installed locally</p>
<p>      /usr/local/bin</p>
<p>Local software binaries</p>
<p>      /usr/local/games</p>
<p>Local game binaries</p>
<p>      /usr/local/include</p>
<p>Local C header files</p>
<p>      /usr/local/lib</p>
<p>Local libraries for the binaries in </p>
<p>/usr/local/bin</p>
<p> and </p>
<p>/usr/local/sbin</p>
<p>      /usr/local/man</p>
<p>Local man pages</p>
<p>      /usr/local/sbin</p>
<p>Local system binaries</p>
<p>      /usr/local/share</p>
<p>Local architecture-independent hierarchy</p>
<p>      /usr/local/src</p>
<p>Local source code</p>
<p>   /usr/sbin</p>
<p>Non-essential system binaries (daemons and services)</p>
<p>   /usr/share</p>
<p>Architecture-independent files (e.g. icons, fonts, documentation)</p>
<p>      /usr/share/doc</p>
<p>Package-specific documentation not included in man pages</p>
<p>      /usr/share/man</p>
<p>Man pages</p>
<p>      /usr/share/info</p>
<p>Documentation in Info format</p>
<p>   /usr/src</p>
<p>Source code for the current OS</p>
<p>/var</p>
<p>Variable files (e.g. logs, caches, mail spools)</p>
<p>   /var/log</p>
<p>Logfiles</p>
<p>   /var/opt</p>
<p>Variable files for the application software installed in </p>
<p>/opt</p>
<p>   /var/spool</p>
<p>Queued items to be processed (e.g. mail messages, cron jobs, print jobs)</p>
<p>   /var/tmp</p>
<p>Temporary files that need to be stored for a longer time; preserved between reboots</p>
<p>The manpage </p>
<p>man hier</p>
<p> contains information about filesystem hierarchy.</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>11/189</b></p>
<p><b>Partitions and filesystem</b></p>
<p><i>Partitions and filesystem</i></p>
<p>The <b>superblock</b> contains information relative to the filesystem e.g. filesystem type, size, status, metadata structures.</p>
<p>The <b>Master Boot Record (MBR)</b> is a 512-byte program located in the first sector of the hard disk; it contains information </p>
<p>about hard disk partitions and has the duty of loading the OS.  On recent systems, the MBR has been replaced by the <b>GUID </b></p>
<p><b>Partition Table (GPT)</b>.</p>
<p>Almost all modern filesystems use <b>journaling</b>; in a journaling filesystem, the journal logs changes before committing them </p>
<p>to the filesystem, which ensures faster recovery and less risk of corruption in case of a crash.</p>
<p>Partitioning limits for Linux using MBR:</p>
<p>Max 4 primary partitions per hard disk, or 3 primary partitions + 1 extended partition.  Partitions are numbered from 1 to 4.</p>
<p>Max 11 logical partitions (inside the extended partition) per hard disk.  Partitions are numbered from 5 to 15.</p>
<p>Max disk size is 2 Tb.</p>
<p>GPT makes no difference between primary, extended, or logical partitions.  Furthermore, it practically has no limits </p>
<p>concerning number and size of partitions.</p>
<p><b>FUSE (Filesystem in Userspace)</b> is an interface for userspace programs to export a filesystem to the Linux kernel, and is </p>
<p>particularly useful for virtual file systems.</p>
<p>fdisk /dev/sda</p>
<p>Disk partitioning interactive tool</p>
<p>fdisk -l /dev/sda</p>
<p>List the partition table of </p>
<p>/dev/sda</p>
<p>parted</p>
<p>Disk partitioning interactive tool</p>
<p>sfdisk /dev/sda</p>
<p>Disk partitioning non-interactive tool</p>
<p>cfdisk</p>
<p>Disk partitioning tool with text-based UI </p>
<p>gparted</p>
<p>gnome-disks</p>
<p>Disk partitioning tool with GUI</p>
<p>partprobe <i>device</i></p>
<p>hdparm -z <i>device</i></p>
<p>Notify the OS about partition table changes.  Otherwise, the changes will take place </p>
<p>only after reboot</p>
<p>mkfs -t <i>fstype</i> <i>device</i></p>
<p>Create a filesystem of the specified type on a partition (i.e. format the partition).</p>
<p>mkfs is a wrapper utility for the actual filesystem-specific maker commands:</p>
<p>mkfs.ext2     </p>
<p>aka</p>
<p> mke2fs</p>
<p>mkfs.ext3     </p>
<p>aka</p>
<p> mke3fs</p>
<p>mkfs.ext4     </p>
<p> </p>
<p>mkfs.msdos    </p>
<p>aka</p>
<p> mkdosfs</p>
<p>mkfs.ntfs     </p>
<p>aka</p>
<p> mkntfs</p>
<p>mkfs.reiserfs </p>
<p>aka</p>
<p> mkreiserfs</p>
<p>mkfs.jfs      </p>
<p>  </p>
<p>mkfs.xfs      </p>
<p>   </p>
<p>mkfs -t ext2 /dev/sda</p>
<p>mkfs.ext2 /dev/sda</p>
<p>mke2fs /dev/sda</p>
<p>Create an ext2 filesystem on </p>
<p>/dev/sda</p>
<p>mke2fs -j /dev/sda</p>
<p>mkfs.ext3 /dev/sda</p>
<p>mke3fs /dev/sda</p>
<p>Create an ext3 filesystem (ext2 with journaling) on </p>
<p>/dev/sda</p>
<p>mkfs -t msdos /dev/sda</p>
<p>mkfs.msdos /dev/sda</p>
<p>mkdosfs /dev/sda</p>
<p>Create a MS-DOS filesystem on </p>
<p>/dev/sda</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>12/189</b></p>
<p><b>mount</b></p>
<p><i>mount</i></p>
<p>mount</p>
<p>cat /proc/mounts</p>
<p>cat /etc/mtab</p>
<p>Display the currently mounted filesystems.</p>
<p>The commands </p>
<p>mount</p>
<p> and </p>
<p>umount</p>
<p> maintain in </p>
<p>/etc/mtab </p>
<p>a database of currently </p>
<p>mounted filesystems, but </p>
<p>/proc/mounts</p>
<p> is authoritative</p>
<p>mount -a</p>
<p>Mount all devices listed in </p>
<p>/etc/fstab</p>
<p>, except those indicated as </p>
<p>noauto</p>
<p>mount -t ext3 /dev/sda /mnt</p>
<p>Mount a Linux-formatted disk.  The mount point (directory) must exist </p>
<p>mount -t msdos /dev/fd0 /mnt</p>
<p>Mount a MS-DOS filesystem floppy disk to mount point </p>
<p>/mnt</p>
<p>mount /dev/fd0</p>
<p>Mount a floppy disk.  </p>
<p>/etc/fstab</p>
<p> must contain an entry for </p>
<p>/dev/fd0</p>
<p> </p>
<p>mount -o remount,rw /</p>
<p>Remount the root directory as read-write, supposing it was mounted read-only.  </p>
<p>Useful to change flags (in this case, read-only to read-write) for a mounted </p>
<p>filesystem that cannot be unmounted at the moment</p>
<p>mount -o nolock 10.7.7.7:/export/ /mnt/nfs</p>
<p>Mount a NFS share without running NFS daemons.</p>
<p>Useful during system recovery</p>
<p>mount -t iso9660 -o ro,loop=/dev/loop0 cd.img /mnt/cdrom</p>
<p>Mount a CD-ROM ISO9660 image file like a CD-ROM </p>
<p>(via the loop device)</p>
<p>umount /dev/fd0</p>
<p>umount /mnt</p>
<p>Unmount a floppy disk that was mounted on </p>
<p>/mnt</p>
<p> (device must not be busy)</p>
<p>umount -l /dev/fd0</p>
<p>Unmount the floppy disk as soon as it is not in use anymore</p>
<p>eject /dev/fd0</p>
<p>eject /mnt</p>
<p>Eject a removable media device</p>
<p>mountpoint /mnt</p>
<p>Tell if a directory is a mount point</p>
<p>blockdev --getbsz /dev/sda1</p>
<p>Get the block size of the specified partition</p>
<p>The <b>UUID (Universal Unique Identifier)</b> of a partition is a 128-bit hash number, which is associated to the partition when</p>
<p>the partition is initialized. </p>
<p>blkid /dev/sda1</p>
<p>Print the UUID of the specified partition</p>
<p>blkid -L /boot</p>
<p>Print the UUID of the specified partition, given its label </p>
<p>blkid -U 652b786e-b87f-49d2-af23-8087ced0c667</p>
<p>Print the name of the specified partition, given its UUID</p>
<p>findfs UUID=652b786e-b87f-49d2-af23-8087ced0c667</p>
<p>Print the name of the specified partition, given its UUID</p>
<p>findfs LABEL=/boot</p>
<p>Print the name of the specified partition, given its label</p>
<p>e2label /dev/sda1</p>
<p>Print the label of the specified partition</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>13/189</b></p>
<p><b>Filesystem types</b></p>
<p><i>Filesystem types</i></p>
<p><b>Partition types</b></p>
<p>0x00  </p>
<p>0x01  </p>
<p>0x02  </p>
<p>0x03  </p>
<p>0x04  </p>
<p>0x05  </p>
<p>0x06  </p>
<p>0x07  </p>
<p>0x08  </p>
<p>0x09  </p>
<p>0x0a  </p>
<p>0x0b  </p>
<p>0x0c  </p>
<p>0x0e  </p>
<p>0x0f  </p>
<p>0x10  </p>
<p>0x11  </p>
<p>0x12  </p>
<p>0x14  </p>
<p>0x16  </p>
<p>0x17  </p>
<p>0x18  </p>
<p>0x1b  </p>
<p>0x1c  </p>
<p>0x1e </p>
<p>0x24  </p>
<p>0x27  </p>
<p>0x39  </p>
<p>0x3c  </p>
<p>0x40  </p>
<p>0x41  </p>
<p>0x42  </p>
<p>0x4d  </p>
<p>Empty</p>
<p>FAT12</p>
<p>XENIX root</p>
<p>XENIX usr</p>
<p>FAT16 &lt;32M</p>
<p>Extended</p>
<p>FAT16</p>
<p>HPFS / NTFS / exFAT</p>
<p>AIX</p>
<p>AIX bootable</p>
<p>OS/2 Boot Manager</p>
<p>W95 FAT32</p>
<p>W95 FAT32 (LBA)</p>
<p>W95 FAT16 (LBA)</p>
<p>W95 extended (LBA)</p>
<p>OPUS</p>
<p>Hidden FAT12</p>
<p>Compaq diagnostics</p>
<p>Hidden FAT16 &lt;32Mb</p>
<p>Hidden FAT16</p>
<p>Hidden HPFS/NTFS</p>
<p>AST SmartSleep</p>
<p>Hidden W95 FAT32</p>
<p>Hidden W95 FAT32 (LBA)</p>
<p>Hidden W95 FAT16 (LBA)</p>
<p>NEC DOS</p>
<p>Hidden NTFS WinRE</p>
<p>Plan 9</p>
<p>PartitionMagic recovery</p>
<p>Venix 80286</p>
<p>PPC PReP Boot</p>
<p>SFS</p>
<p>QNX4.x</p>
<p>0x4e  </p>
<p>0x4f  </p>
<p>0x50  </p>
<p>0x51  </p>
<p>0x52  </p>
<p>0x53  </p>
<p>0x54  </p>
<p>0x55  </p>
<p>0x56  </p>
<p>0x5c  </p>
<p>0x61  </p>
<p>0x63  </p>
<p>0x64  </p>
<p>0x65  </p>
<p>0x70  </p>
<p>0x75  </p>
<p>0x80  </p>
<p>0x81  </p>
<p>0x82  </p>
<p>0x83  </p>
<p>0x84  </p>
<p>0x85  </p>
<p>0x86  </p>
<p>0x87  </p>
<p>0x88  </p>
<p>0x8e  </p>
<p>0x93  </p>
<p>0x94  </p>
<p>0x9f  </p>
<p>0xa0  </p>
<p>0xa5  </p>
<p>0xa6  </p>
<p>0xa7  </p>
<p>QNX4.x 2nd part</p>
<p>QNX4.x 3rd part</p>
<p>OnTrack DM</p>
<p>OnTrack DM6 Aux1</p>
<p>CP/M</p>
<p>OnTrack DM6 Aux3</p>
<p>OnTrackDM6</p>
<p>EZ-Drive</p>
<p>Golden Bow</p>
<p>Priam Edisk</p>
<p>SpeedStor</p>
<p>GNU HURD or SysV</p>
<p>Novell Netware 286</p>
<p>Novell Netware 386</p>
<p>DiskSecure Multi-Boot</p>
<p>PC/IX</p>
<p>Old Minix</p>
<p>Minix / old Linux</p>
<p>Linux swap / Solaris</p>
<p>Linux</p>
<p>OS/2 hidden C: drive</p>
<p>Linux extended</p>
<p>NTFS volume set</p>
<p>NTFS volume set</p>
<p>Linux plaintext</p>
<p>Linux LVM</p>
<p>Amoeba</p>
<p>Amoeba BBT</p>
<p>BSD/OS</p>
<p>IBM Thinkpad hibernation</p>
<p>FreeBSD</p>
<p>OpenBSD</p>
<p>NeXTSTEP</p>
<p>0xa8  </p>
<p>0xa9  </p>
<p>0xab  </p>
<p>0xaf  </p>
<p>0xb7  </p>
<p>0xb8  </p>
<p>0xbb  </p>
<p>0xbe  </p>
<p>0xbf  </p>
<p>0xc1  </p>
<p>0xc4  </p>
<p>0xc6  </p>
<p>0xc7  </p>
<p>0xda  </p>
<p>0xdb  </p>
<p>0xde  </p>
<p>0xdf  </p>
<p>0xe1  </p>
<p>0xe3  </p>
<p>0xe4  </p>
<p>0xeb  </p>
<p>0xee  </p>
<p>0xef  </p>
<p>0xf0  </p>
<p>0xf1  </p>
<p>0xf4  </p>
<p>0xf2  </p>
<p>0xfb  </p>
<p>0xfc  </p>
<p>0xfd  </p>
<p>0xfe  </p>
<p>0xff  </p>
<p>Darwin UFS</p>
<p>NetBSD</p>
<p>Darwin boot</p>
<p>HFS / HFS+</p>
<p>BSDI fs</p>
<p>BSDI swap</p>
<p>Boot Wizard hidden</p>
<p>Solaris boot</p>
<p>Solaris</p>
<p>DRDOS/sec (FAT-12)</p>
<p>DRDOS/sec (FAT-16 &lt; 32Mb)</p>
<p>DRDOS/sec (FAT-16)</p>
<p>Syrinx</p>
<p>Non-FS data</p>
<p>CP/M / CTOS / ...</p>
<p>Dell Utility</p>
<p>BootIt</p>
<p>DOS access</p>
<p>DOS R/O</p>
<p>SpeedStor</p>
<p>BeOS fs</p>
<p>GPT</p>
<p>EFI (FAT-12/16/32)</p>
<p>Linux/PA-RISC boot</p>
<p>SpeedStor</p>
<p>SpeedStor</p>
<p>DOS secondary</p>
<p>VMware VMFS</p>
<p>VMware VMKCORE</p>
<p>Linux raid autodetect</p>
<p>LANstep</p>
<p>BBT</p>
<p>The command </p>
<p>sfdisk -T</p>
<p> prints the above list of partition IDs and names. </p>
<p><b>Most used Linux-supported filesystems</b></p>
<p>ext2</p>
<p>The oldest Linux ext filesystem, without journaling</p>
<p>ext3</p>
<p>ext2 with journaling</p>
<p>ext4</p>
<p>Linux journaling filesystem, an upgrade from ext3 </p>
<p>Reiserfs</p>
<p>Journaling filesystem</p>
<p>XFS</p>
<p>Journaling filesystem, developed by SGI</p>
<p>JFS</p>
<p>Journaling filesystem, developed by IBM</p>
<p>Btrfs</p>
<p>B-tree filesystem, developed by Oracle</p>
<p>msdos</p>
<p>DOS filesystem, supporting only 8-char filenames</p>
<p>umsdos</p>
<p>Extended DOS filesystem used by Linux, compatible with DOS </p>
<p>fat32</p>
<p>MS-Windows FAT filesystem</p>
<p>vfat</p>
<p>Extended DOS filesystem, with support for long filenames</p>
<p>ntfs</p>
<p>Replacement for fat32 and vfat filesystems</p>
<p>minix</p>
<p>Native filesystem of the MINIX OS </p>
<p>iso9660</p>
<p>CD-ROM filesystem</p>
<p>cramfs</p>
<p>Compressed RAM disk</p>
<p>nfs</p>
<p>Network filesystem, used to access files on remote machines</p>
<p>SMB</p>
<p>Server Message Block, used to mount Windows network shares</p>
<p>proc</p>
<p>Pseudo filesystem, used as an interface to kernel data structures</p>
<p>swap</p>
<p>Pseudo filesystem, Linux swap area</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>14/189</b></p>
<p><b>Swap</b></p>
<p><i>Swap</i></p>
<p>The <b>swap</b> space is an area on disk (a file or a partition) used as a RAM extension.  When there is not enough free physical </p>
<p>RAM for a process, inactive pages in memory are temporarily <b>swapped out</b> of memory to disk, to later be <b>swapped in</b> to </p>
<p>memory when RAM resources are available again.  If both RAM and swap space become nearly full, the system may get </p>
<p>clogged by spending all the time paging blocks of memory back and forth between RAM and swap (<b>thrashing</b>).    </p>
<p>The amount of RAM plus the swap is defined as the <b>virtual memory</b>.</p>
<p>In Linux, a swap partition is usually preferred over a swap file.  While a swap file can be resized more easily, it cannot be </p>
<p>used for hibernation; this because the system must first locate the swap file's header, but in order to do so the filesystem </p>
<p>containing the swap file must be mounted, and journaled filesystems such as ext3 or ext4 cannot be mounted during </p>
<p>resume from disk.  Also, in older Linux versions a swap partition used to have faster disk access and less fragmentation than</p>
<p>a swap file, but the difference is negligible nowadays.  </p>
<p>Although listed as filesystem type 0x82, the swap partition is not a filesystem but a raw addressable memory space with no </p>
<p>structure; therefore it does not appear in the output of </p>
<p>mount</p>
<p> or </p>
<p>df</p>
<p> commands.</p>
<p>A swap partition can be created via any partitioning tool e.g. </p>
<p>fdisk</p>
<p>. </p>
<p>dd if=/dev/zero of=/<i>swapfile</i> bs=1024 count=512000</p>
<p>Create a 512-Mb swap file</p>
<p>mkswap /<i>swapfile</i></p>
<p>Initialize a (already created) swap file or partition</p>
<p>swapon /<i>swapfile</i></p>
<p>Enable a swap file or partition, thus telling the kernel that it </p>
<p>can use it now</p>
<p>swapoff /<i>swapfile</i></p>
<p>Disable a swap file or partition</p>
<p>swapon -s</p>
<p>cat /proc/swaps</p>
<p>cat /proc/meminfo</p>
<p>free</p>
<p>top</p>
<p>Show the sizes of total and used swap areas</p>
<p><b>How to extend a LVM swap partition</b></p>
<p>1.</p>
<p>lvs</p>
<p>Determine the name of the swap Logical Volume</p>
<p>2.</p>
<p>swapoff /dev/volgroup0/swap_lv</p>
<p>Turn off the swap volume</p>
<p>3.</p>
<p>lvresize -L+1G /dev/volgroup0/swap_lv</p>
<p>Extend the swap volume with an additional 1 Gb of space</p>
<p>4.</p>
<p>mkswap /dev/volgroup0/swap_lv</p>
<p>Format the swap volume</p>
<p>5.</p>
<p>swapon /dev/volgroup0/swap_lv</p>
<p>Turn on the swap volume</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>15/189</b></p>
<p><b>/etc/fstab</b></p>
<p><i>/etc/fstab</i></p>
<p><b>/etc/fstab</b></p>
<p># &lt;filesystem&gt;     &lt;mount point&gt;     &lt;type&gt;    &lt;options&gt;                        &lt;dump&gt; &lt;pass&gt;</p>
<p>/dev/sda2          /                 ext2      defaults                              0 1</p>
<p>/dev/sdb1          /home             ext2      defaults                              1 2</p>
<p>/dev/cdrom         /media/cdrom      auto      ro,noauto,user,exec                   0 0</p>
<p>/dev/fd0           /media/floppy     auto      rw,noauto,user,sync                   0 0</p>
<p>proc               /proc             proc      defaults                              0 0</p>
<p>/dev/hda1          swap              swap      pri=42                                0 0</p>
<p>nfsserver:/dirs    /mnt              nfs       intr                                  0 0</p>
<p>//smbserver/jdoe   /shares/jdoe      cifs      auto,credentials=/etc/smbcreds        0 0</p>
<p>LABEL=/boot        /boot             ext2      defaults                              0 0</p>
<p>UUID=652b786e-b87f-49d2-af23-8087ced0c667  /test  ext4  errors=remount-ro,noatime    0 0</p>
<p>/etc/fstab</p>
<p> contains information about filesystems, including all filesystems that must be automatically mounted at bootup.</p>
<p><b>filesystem</b></p>
<p>Device or partition.  The filesystem can be identified either by its name, label, or UUID </p>
<p><b>mount point</b></p>
<p>Directory on which the partition will be mounted</p>
<p><b>type</b></p>
<p>Filesystem type, or </p>
<p>auto</p>
<p> if detected automatically </p>
<p><b>options</b></p>
<p>defaults</p>
<p>Use the default options.  The default options depend on the filesystem type </p>
<p>and can be found via the command:</p>
<p>tune2fs -l <i>device</i> | grep &quot;Default mount options&quot;</p>
<p>Most common default options: </p>
<p>rw, suid, dev, auto, nouser, exec, async</p>
<p>ro</p>
<p>Mount read-only</p>
<p>rw</p>
<p>Mount read-write (default)</p>
<p>suid</p>
<p>Permit SUID and SGID bit operations (default)</p>
<p>nosuid</p>
<p>Do not permit SUID and SGID bit operations</p>
<p>dev</p>
<p>Interpret block special devices on the filesystem (default)</p>
<p>nodev</p>
<p>Do not interpret block special devices on the filesystem</p>
<p>auto</p>
<p>Mount automatically at bootup, or when command </p>
<p>mount -a</p>
<p> is given (default)</p>
<p>noauto</p>
<p>Mount only if explicitly demanded</p>
<p>user</p>
<p>Partition can be mounted by any user</p>
<p>nouser</p>
<p>Partition can be mounted only by the root user (default)</p>
<p>exec</p>
<p>Binaries contained on the partition can be executed (default)</p>
<p>noexec</p>
<p>Binaries contained on the partition cannot be executed</p>
<p>sync</p>
<p>Write files immediately to the partition</p>
<p>async</p>
<p>Buffer write operations and commit them at once later, or when device is </p>
<p>unmounted (default)</p>
<p>noatime</p>
<p>Do not update atime (access time) information for the filesystem.  This results </p>
<p>in a performance improvement because the system does not need anymore to </p>
<p>do filesystem writes for files which are just being read </p>
<p>acl</p>
<p>Support ACLs on files contained in the partition</p>
<p>context=&quot;<i>context</i>&quot;</p>
<p>Apply a specific SELinux context to the mount</p>
<p>Other specific options apply to specific partition types (e.g. NFS or Samba)</p>
<p><b>dump</b></p>
<p>Options for the </p>
<p>dump</p>
<p> backup utility.  </p>
<p>0</p>
<p> = do not backup</p>
<p><b>pass</b></p>
<p>Order in which the filesystem must be checked by </p>
<p>fsck</p>
<p>.  </p>
<p>0</p>
<p> = do not check</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>16/189</b></p>
<p><b>Filesystem operations</b></p>
<p><i>Filesystem operations</i></p>
<p>df</p>
<p>Report filesystem disk space usage</p>
<p>df -h</p>
<p>Report filesystem disk space usage in human-readable output</p>
<p>df <i>directory</i></p>
<p>Shows on which device the specified <i>directory</i> is mounted</p>
<p>du <i>directory</i></p>
<p>Report disk usage, as the size of each file contained in <i>directory</i>, in Kb</p>
<p>du -s <i>directory</i></p>
<p>Show the total sum of the sizes of all files contained in <i>directory</i></p>
<p>du -h <i>directory</i></p>
<p>Report disk usage in human-readable output</p>
<p>du -hs * | sort -hr</p>
<p>Print out all files and directories in the current directory, ordered by size</p>
<p>(largest first), in human-readable output</p>
<p>du -a <i>/path</i> | sort -nr | head</p>
<p>Print out the 10 biggest files and directories under <i>path</i></p>
<p>find <i>/path</i> -type f -exec du -Sh {} + \</p>
<p>| sort -hr | head</p>
<p>Print out the 10 biggest files under <i>path</i></p>
<p>ncdu</p>
<p>Disk usage analyzer with Ncurses UI</p>
<p>resize2fs <i>options device size</i></p>
<p>Resize an ext2/ext3/ext4 filesystem</p>
<p>lsblk</p>
<p>List information about all available block devices</p>
<p>lsscsi</p>
<p>List information about all SCSI devices</p>
<p>sync</p>
<p>Flush the buffer and commit all pending writes.  </p>
<p>To improve performance of Linux filesystems, many write operations are</p>
<p>buffered in RAM and written at once; writes are done in any case before</p>
<p>unmount, reboot, or shutdown</p>
<p>chroot <i>/path/to/newrootdir command</i></p>
<p>Run a command in a chroot jail (i.e. in a new root directory).  The </p>
<p>command process will be unable to access files outside the chroot jail </p>
<p>chroot /mnt/sysimage</p>
<p>Start a shell with </p>
<p>/mnt/sysimage</p>
<p> as filesystem root.  </p>
<p>Useful during system recovery when the machine has been booted from</p>
<p>a removable media; this device is defined as the filesystem root and </p>
<p>often needs to be changed to perform operations on the machine</p>
<p>mknod /dev/sda</p>
<p>Create a directory allocating the proper inode.</p>
<p>Useful if experiencing filesystem problems during system recovery </p>
<p>multipath <i>options device</i></p>
<p>Detect and aggregate multiple I/O paths (SAN connections) to a device</p>
<p>hdparm</p>
<p>Get/set drive parameters for SATA/IDE devices</p>
<p>hdparm -g /dev/hda</p>
<p>Display drive geometry (cylinders, heads, sectors) of </p>
<p>/dev/hda</p>
<p>hdparm -i /dev/hda</p>
<p>Display identification information for </p>
<p>/dev/hda</p>
<p>hdparm -tT /dev/hda</p>
<p>Perform disk read benchmarks on the </p>
<p>/dev/hda</p>
<p> drive</p>
<p>hdparm -p 12 /dev/hda</p>
<p>Reprogram IDE interface chipset of </p>
<p>/dev/hda</p>
<p> to mode 4.</p>
<p>Warning: using an unsupported mode can cause filesystem corruption</p>
<p>sdparm</p>
<p>Access drive parameters for SCSI devices</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>17/189</b></p>
<p><b>Filesystem maintenance</b></p>
<p><i>Filesystem maintenance</i></p>
<p>fsck <i>device</i></p>
<p>Check and repair a Linux filesystem (which must be unmounted).</p>
<p>Corrupted files will be placed into the </p>
<p>/lost+found</p>
<p> directory of the partition.</p>
<p>The exit code returned is the sum of the following conditions:</p>
<p>0    No errors</p>
<p>1    File system errors corrected</p>
<p>2    System should be rebooted</p>
<p>4    File system errors left uncorrected</p>
<p>8       Operational error</p>
<p>16     Usage or syntax error</p>
<p>32     Fsck canceled by user </p>
<p>128   Shared library error</p>
<p>Fsck is a wrapper utility for the actual filesystem-specific checker commands: </p>
<p>fsck.ext2 </p>
<p>aka</p>
<p> e2fsck</p>
<p>fsck.ext3 </p>
<p>aka</p>
<p> e2fsck</p>
<p>fsck.ext4 </p>
<p>aka</p>
<p> e2fsck</p>
<p>fsck.msdos</p>
<p>fsck.vfat</p>
<p>fsck.cramfs</p>
<p>fsck</p>
<p>fsck -As</p>
<p>Check and repair serially all filesystems listed in </p>
<p>/etc/fstab</p>
<p>fsck -f /dev/sda1</p>
<p>Force a filesystem check on </p>
<p>/dev/sda1</p>
<p> even if it thinks is not necessary</p>
<p>fsck -y /dev/sda1</p>
<p>During filesystem repair, do not ask questions and assume that the answer is always yes</p>
<p>fsck.ext2 -c /dev/sda1</p>
<p>e2fsck -c /dev/sda1</p>
<p>Check an ext2 filesystem, running the </p>
<p>badblocks</p>
<p> command to mark all bad blocks and </p>
<p>add them to the bad block inode so they will not be allocated to files or directories</p>
<p>touch /forcefsck  </p>
<p>(Red Hat)</p>
<p>Force a filesystem check after next reboot</p>
<p>tune2fs <i>options device</i></p>
<p>Adjust tunable filesystem parameters on ext2/ext3/ext4 filesystems</p>
<p>tune2fs -l /dev/sda1</p>
<p>List the contents of the filesystem superblock</p>
<p>tune2fs -j /dev/sda1</p>
<p>Add a journal to this ext2 filesystem, making it an ext3</p>
<p>tune2fs -m 1 /dev/sda1</p>
<p>Reserve 1% of the partition size to privileged processes.  This space (5% by default, but </p>
<p>can be reduced on modern filesystems) is reserved to avoid filesystem fragmentation </p>
<p>and to allow privileged processes to continue to run correctly when the partition is full </p>
<p>tune2fs -C 7 /dev/sda1</p>
<p>Set the mount count of the filesystem to 7</p>
<p>tune2fs -c 20 /dev/sda1</p>
<p>Set the filesystem to be checked by fsck after 20 mounts</p>
<p>tune2fs -i 15d /dev/sda1</p>
<p>Set the filesystem to be checked by fsck each 15 days</p>
<p>Both mount-count-dependent and time-dependent checking are enabled by default for all hard drives on Linux, to avoid the </p>
<p>risk of filesystem corruption going unnoticed.</p>
<p>dumpe2fs <i>options device</i></p>
<p>Dump ext2/ext3/ext4 filesystem information</p>
<p>dumpe2fs -h /dev/sda1</p>
<p>Display filesystem's superblock information (number of mounts, last </p>
<p>checks, UUID, etc.)</p>
<p>dumpe2fs /dev/sda1 | grep -i superblock</p>
<p>Display locations of superblock (primary and backup) of filesystem</p>
<p>dumpe2fs -b /dev/sda1</p>
<p>Display blocks that are marked as bad in the filesystem </p>
<p>debugfs <i>device</i></p>
<p>Interactive ext2/ext3/ext4 filesystem debugger</p>
<p>debugfs -w /dev/sda1</p>
<p>Debug </p>
<p>/dev/sda1</p>
<p> in read-write mode (by default, debugfs accesses the </p>
<p>device in read-only mode) </p>
<p>Many hard drives feature the <b>Self-Monitoring, Analysis and Reporting Technology (SMART)</b> whose purpose is to </p>
<p>monitor the reliability of the drive, predict drive failures, and carry out different types of drive self-tests.</p>
<p>The </p>
<p>smartd</p>
<p> daemon attempts to poll this information from all drives every 30 minutes, logging all data to syslog.  </p>
<p>smartctl -a /dev/sda</p>
<p>Print SMART information for drive </p>
<p>/dev/sda</p>
<p>smartctl -s off /dev/sda</p>
<p>Disable SMART monitoring and log collection for drive </p>
<p>/dev/sda</p>
<p>smartctl -t long /dev/sda</p>
<p>Begin an extended SMART self-test on drive </p>
<p>/dev/sda</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>18/189</b></p>
<p><b>XFS, ReiserFS, CD-ROM fs</b></p>
<p><i>XFS, ReiserFS, CD-ROM fs</i></p>
<p>xfs_growfs <i>options mountpoint</i></p>
<p>Expand an XFS filesystem.</p>
<p>Note that a XFS filesystem cannot be shrunk</p>
<p>xfs_info /dev/sda1</p>
<p>xfs_growfs -n /dev/sda1</p>
<p>Print XFS filesystem geometry </p>
<p>xfs_check <i>options device</i></p>
<p>Check XFS filesystem consistency</p>
<p>xfs_repair <i>options device</i></p>
<p>Repair a damaged or corrupt XFS filesystem</p>
<p>xfsdump -v silent -f /dev/tape /</p>
<p>Dump the root of a XFS filesystem to tape, with the lowest verbosity.</p>
<p>Incremental and resumed dumps are stored in the inventory database </p>
<p>/var/lib/xfsdump/inventory</p>
<p>xfsrestore -f /dev/tape /</p>
<p>Restore a XFS filesystem from tape</p>
<p>xfsdump -J - / | xfsrestore -J - /new</p>
<p>Copy the contents of a XFS filesystem to another directory, without </p>
<p>updating the inventory database</p>
<p>reiserfstune <i>options device</i></p>
<p>Adjust tunable filesystem parameters on ReiserFS filesystem</p>
<p>debugreiserfs <i>device</i></p>
<p>Interactive ReiserFS filesystem debugger</p>
<p>mkisofs -r -o cdrom.img data/</p>
<p>Create a CD-ROM image from the contents of the target directory.</p>
<p>Enables Rock Ridge extension and set all content on CD to be public </p>
<p>readable, instead of inheriting the permissions from the original files </p>
<p><b>CD-ROM filesystems</b></p>
<p><b>Filesystem</b></p>
<p><b>Commands</b></p>
<p>ISO9660</p>
<p>mkisofs</p>
<p>Create a ISO9660 filesystem</p>
<p>UDF (Universal Disk Format)</p>
<p>mkudffs</p>
<p>Create a UDF filesystem</p>
<p>udffsck</p>
<p>Check a UDF filesystem</p>
<p>wrudf</p>
<p>Maintain a UDF filesystem</p>
<p>cdrwtool</p>
<p>Manage CD-RW drives (e.g. disk format, read/write speed) </p>
<p>HFS (Hierarchical File System)</p>
<p><b>CD-ROM filesystem extensions</b></p>
<p>Rock Ridge</p>
<p>Contains the original file information (e.g. permissions, filename) for MS Windows 8.3 filenames</p>
<p>MS Joliet</p>
<p>Used to create more MS Windows friendly CD-ROMs</p>
<p>El Torito</p>
<p>Used to create bootable CD-ROMs</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>19/189</b></p>
<p><b>AutoFS</b></p>
<p><i>AutoFS</i></p>
<p>AutoFS is a client-side service that allows automounting of filesystems, even for nonprivileged users.</p>
<p>AutoFS is composed of the </p>
<p>autofs</p>
<p> kernel module that monitors specific directories for attempts to access them; in this case,</p>
<p>the kernel module signals the </p>
<p>automount</p>
<p> userspace daemon, which mounts the directory when it needs to be accessed and </p>
<p>unmounts it when is no longer accessed. </p>
<p>Mounts managed by AutoFS should not be mounted/unmounted manually or via </p>
<p>/etc/fstab</p>
<p>, to avoid inconsistencies.</p>
<p><b>AutoFS configuration files</b></p>
<p>/etc/sysconfig/autofs</p>
<p>AutoFS configuration file.</p>
<p>/etc/auto.master</p>
<p>Master map file for AutoFS. </p>
<p>Each line is an indirect map, and each map file stores the configuration for the </p>
<p>automounting of the subdirectory.</p>
<p>The </p>
<p>-hosts</p>
<p> map tells AutoFS to mount/unmount automatically any export from the NFS </p>
<p>server <i>nfsserver</i> when the directory </p>
<p>/net/<i>nfsserver</i>/</p>
<p> is accessed.</p>
<p># mount point   map              options</p>
<p>/net            -hosts</p>
<p>/-              /etc/auto.direct</p>
<p>/misc           /etc/auto.misc</p>
<p>/home           /etc/auto.home   --timeout=60</p>
<p><b>AutoFS map files</b></p>
<p>/etc/auto.direct</p>
<p>Direct map file for automounting of a NFS share.</p>
<p># dir      filesystem</p>
<p>/mydir     nfsserver1.foo.org:/myshare</p>
<p>/etc/auto.misc</p>
<p>Indirect map file for automounting of directory </p>
<p>/misc</p>
<p>.</p>
<p># subdir   options                          filesystem</p>
<p>public     -ro,soft,intr                    ftp.example.org:/pub</p>
<p>cd         -fstype=iso9660,ro,nosuid,nodev  :/dev/cdrom</p>
<p>/etc/auto.home</p>
<p>Indirect map file for automounting of directory </p>
<p>/home</p>
<p> on a NFS share.</p>
<p>The </p>
<p>*</p>
<p> wildcard matches any subdirectory the system attempts to access, and the </p>
<p>&amp;</p>
<p> variable </p>
<p>takes the value of the match.</p>
<p># subdir   options                          filesystem</p>
<p>*          -rw,soft,intr                    nfsserver2.bar.org:/home/&amp;</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>20/189</b></p>
<p><b>RAID</b></p>
<p><i>RAID</i></p>
<p><b>RAID levels</b></p>
<p><b>Level</b></p>
<p><b>Description</b></p>
<p><b>Storage capacity</b></p>
<p>RAID 0</p>
<p>Striping (data is written across all member disks).</p>
<p>High I/O but no redundancy</p>
<p>Sum of the capacity of member disks</p>
<p>RAID 1</p>
<p>Mirroring (data is mirrored on all disks).</p>
<p>High redundancy but high cost</p>
<p>Capacity of the smaller member disk </p>
<p>RAID 4</p>
<p>Parity on a single disk.</p>
<p>I/O bottleneck unless coupled to write-back caching</p>
<p>Sum of the capacity of member disks, </p>
<p>minus one</p>
<p>RAID 5</p>
<p>Parity distributed across all disks.  </p>
<p>Can sustain one disk crash </p>
<p>Sum of the capacity of member disks, </p>
<p>minus one</p>
<p>RAID 6</p>
<p>Double parity distributed across all disks.</p>
<p>Can sustain two disk crashes</p>
<p>Sum of the capacity of member disks, </p>
<p>minus two</p>
<p>RAID 10 (1+0)</p>
<p>Striping + mirroring.</p>
<p>High redundancy but high cost</p>
<p>Capacity of the smaller member disk </p>
<p>Linear RAID</p>
<p>Data written sequentially across all disks.</p>
<p>No redundancy</p>
<p>Sum of the capacity of member disks</p>
<p>mdadm -C /dev/md0 -l 5 \</p>
<p>-n 3 /dev/sdb1 /dev/sdc1 /dev/sdd1 \</p>
<p>-x 1 /dev/sde1</p>
<p>Create a RAID 5 array from three partitions and a spare.</p>
<p>Partitions type must be set to 0xFD.</p>
<p>Once the RAID device has been created, it must be formatted e.g. via </p>
<p>mke2fs -j /dev/md0</p>
<p>  </p>
<p>mdadm --manage /dev/md0 -f /dev/sdd1</p>
<p>Mark a drive as faulty, before removing it</p>
<p>mdadm --manage /dev/md0 -r /dev/sdd1</p>
<p>Remove a drive from the RAID array.  </p>
<p>The faulty drive can now be physically removed </p>
<p>mdadm --manage /dev/md0 -a /dev/sdd1</p>
<p>Add a drive to the RAID array.</p>
<p>To be run after the faulty drive has been physically replaced </p>
<p>mdadm --misc -Q /dev/sdd1</p>
<p>Display information about a device</p>
<p>mdadm --misc -D /dev/md0</p>
<p>Display detailed information about the RAID array</p>
<p>mdadm --misc -o /dev/md0</p>
<p>Mark the RAID array as readonly</p>
<p>mdadm --misc -w /dev/md0</p>
<p>Mark the RAID array as read &amp; write</p>
<p>/etc/mdadm.conf</p>
<p>Configuration file for the </p>
<p>mdadm</p>
<p> command</p>
<p>DEVICE /dev/sdb1 /dev/sdc1 /dev/sdd1 /dev/sde1</p>
<p>ARRAY /dev/md0 level=raid5 num-devices=3</p>
<p>  UUID=0098af43:812203fa:e665b421:002f5e42</p>
<p>  devices=/dev/sdb1,/dev/sdc1,/dev/sdd1,/dev/sde1</p>
<p>cat /proc/mdstat</p>
<p>Display information about RAID arrays and devices</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>21/189</b></p>
<p><b>Bootloader</b></p>
<p><i>Bootloader</i></p>
<p><b>Non-GRUB bootloaders</b></p>
<p>LILO </p>
<p>(Linux Loader)</p>
<p>Obsolete.  Small bootloader that can be placed in the MBR or the boot sector of a partition.  </p>
<p>The configuration file is </p>
<p>/etc/lilo.conf</p>
<p> (run </p>
<p>/sbin/lilo</p>
<p> afterwards to validate changes).</p>
<p>SYSLINUX</p>
<p>SYSLINUX</p>
<p>Able to boot from FAT and NTFS filesystems e.g. floppy disks and USB drives.</p>
<p>Used for boot floppy disks, rescue floppy disks, and Live USBs.</p>
<p>ISOLINUX</p>
<p>Able to boot from CD-ROM ISO 9660 filesystems.  </p>
<p>Used for Live CDs and bootable install CDs.</p>
<p>The CD must contain the following files:</p>
<p>isolinux/isolinux.bin</p>
<p>ISOLINUX image, from the SYSLINUX distro</p>
<p>boot/isolinux/isolinux.cfg</p>
<p>ISOLINUX configuration</p>
<p>images/</p>
<p>Floppy images to boot</p>
<p>kernel/memdisk</p>
<p>and can be burnt with the command:</p>
<p>mkisofs -o output.iso -b isolinux/isolinux.bin -c isolinux/boot.cat \</p>
<p>-no-emul-boot -boot-load-size 4 -boot-info-table <i>cd_root_dir</i></p>
<p>PXELINUX</p>
<p>Able to boot from PXE (Pre-boot eXecution Environment).  PXE uses DHCP or BOOTP to enable </p>
<p>basic networking, then uses TFTP to download a bootstrap program that loads and configures </p>
<p>the kernel.</p>
<p>Used for Linux installations from a central server or network boot of diskless workstations.</p>
<p>The boot TFTP server must contain the following files:</p>
<p>/tftpboot/pxelinux.0</p>
<p>PXELINUX image, from the SYSLINUX distribution</p>
<p>/tftpboot/pxelinux.cfg/</p>
<p>Directory containing a configuration file for each machine.</p>
<p>A machine with Ethernet MAC address 88:99:AA:BB:CC:DD </p>
<p>and IP address 192.0.2.91 (C000025B in hexadecimal) will </p>
<p>search for its configuration filename in this order:</p>
<p>01-88-99-aa-bb-cc-dd </p>
<p>C000025B</p>
<p>C000025</p>
<p>C00002</p>
<p>C0000</p>
<p>C000</p>
<p>C00</p>
<p>C0</p>
<p>C</p>
<p>default</p>
<p>EXTLINUX</p>
<p>General-purpose bootloader like LILO or GRUB.  Now merged with SYSLINUX.</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>22/189</b></p>
<p><b>GRUB 2 configuration</b></p>
<p><i>GRUB 2 configuration</i></p>
<p>GRUB (Grand Unified Bootloader) is the standard boot manager on Linux distributions.  The latest version is GRUB 2; the </p>
<p>older version is GRUB Legacy.  </p>
<p>GRUB Stage 1 (446 bytes), as well as the partition table (64 bytes) and the boot signature (2 bytes), is stored in the 512-</p>
<p>byte MBR.  It then accesses the GRUB configuration and commands available on the filesystem, usually on </p>
<p>/boot/grub</p>
<p>.</p>
<p><b>/boot/grub/grub.cfg</b></p>
<p><b> or </b></p>
<p><b>/boot/grub2/grub.cfg</b></p>
<p><b>     GRUB 2 configuration file</b></p>
<p># Linux Red Hat</p>
<p>menuentry &quot;Fedora 2.6.32&quot; {   # Menu item to show on GRUB bootmenu</p>
<p>set root=(hd0,1)              # root filesystem is /dev/hda1</p>
<p>linux /vmlinuz-2.6.32 ro root=/dev/hda5 mem=2048M</p>
<p>initrd /initrd-2.6.32</p>
<p>}</p>
<p># Linux Debian</p>
<p>menuentry &quot;Debian 2.6.36-experimental&quot; {</p>
<p>set root=(hd0,1)</p>
<p>linux (hd0,1)/bzImage-2.6.36-experimental ro root=/dev/hda6</p>
<p>}</p>
<p># Windows</p>
<p>menuentry &quot;Windows&quot; {</p>
<p>set root=(hd0,2)</p>
<p>chainloader +1</p>
<p>}</p>
<p>The GRUB 2 configuration file must not be edited manually.  Instead, one must edit the files in </p>
<p>/etc/grub.d/</p>
<p> (these are </p>
<p>scripts that will be run in order) and the file </p>
<p>/etc/default/grub</p>
<p> (the configuration file for menu display settings), then run </p>
<p>update-grub</p>
<p> (Debian) or </p>
<p>grub2-mkconfig</p>
<p> (Red Hat) which will recreate this configuration file.</p>
<p>Common </p>
<p>kernel </p>
<p>parameters:</p>
<p>root=</p>
<p>Specify the location of the filesystem root.  This is a required parameter</p>
<p>ro</p>
<p>Mount read-only on boot</p>
<p>quiet</p>
<p>Disable non-critical kernel messages during boot</p>
<p>debug</p>
<p>Enable kernel debugging</p>
<p>splash</p>
<p>Show splash image</p>
<p>single</p>
<p>Boot in single-user mode (runlevel 1)</p>
<p>emergency</p>
<p>Emergency mode: after the kernel is booted, run </p>
<p>sulogin</p>
<p> (single-user login) </p>
<p>which asks for the root password for system maintenance, then run a Bash shell. </p>
<p>Does not load </p>
<p>init</p>
<p> or any daemon or configuration setting</p>
<p>init=/bin/bash</p>
<p>Run a Bash shell (may also be any other executable) instead of </p>
<p>init</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>23/189</b></p>
<p><b>GRUB 2 operations</b></p>
<p><i>GRUB 2 operations</i></p>
<p>The GRUB menu, presented at startup, allows to choose the OS or kernel to boot:</p>
<p>Boot the currently selected GRUB entry</p>
<p>Get a GRUB command line</p>
<p>Edit the selected GRUB entry (e.g. to edit kernel parameters in order to boot in single-user emergency mode, </p>
<p>or to change IRQ or I/O port of a device driver compiled in the kernel)</p>
<p>Boot the currently selected GRUB entry.  This is usually done after finishing modifying the entry</p>
<p>Bring up the GRUB password prompt.  Necessary if a GRUB password has been set</p>
<p>grub2-mkconfig -o /boot/grub2/grub.cfg           </p>
<p>(BIOS)</p>
<p>grub2-mkconfig -o /boot/efi/EFI/centos/grub.cfg  </p>
<p>(EFI)</p>
<p>Regenerate GRUB configuration file</p>
<p>grub-install /dev/sda</p>
<p>Install GRUB on first SATA drive</p>
<p>grub</p>
<p>Access the GRUB shell</p>
<p>grub2-set-default 1</p>
<p>Set GRUB to automatically boot the second entry in the GRUB menu</p>
<p>grub2-editenv list</p>
<p>Display the current GRUB menu entry that is automatically booted</p>
<p>/boot/grub/device.map </p>
<p>This file can be created to map Linux device filenames to BIOS drives</p>
<p>(fd0)  /dev/fd0</p>
<p>(hd0)  /dev/hda</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>ENTER</p>
<p>C</p>
<p>E</p>
<p>B</p>
<p>P</p>
<h1 style="page-break-before:always; "></h1>
<p><b>24/189</b></p>
<p><b>GRUB Legacy</b></p>
<p><i>GRUB Legacy</i></p>
<p><b>GRUB Legacy shell commands</b></p>
<p>blocklist <i>file</i></p>
<p>Print the block list notation of a file</p>
<p>kernel <i>file</i></p>
<p>Load a kernel</p>
<p>boot</p>
<p>Boot the loaded OS</p>
<p>lock</p>
<p>Lock a GRUB menu entry </p>
<p>cat <i>file</i></p>
<p>Show the contents of a file </p>
<p>makeactive</p>
<p>Set active partition on root disk to </p>
<p>GRUB's root device </p>
<p>chainloader <i>file</i></p>
<p>Chainload another bootloader </p>
<p>map <i>drive1</i> <i>drive2</i></p>
<p>Map a drive to another drive</p>
<p>cmp <i>file1</i> <i>file2</i></p>
<p>Compare two files </p>
<p>md5crypt</p>
<p>Encrypt a password in MD5 format</p>
<p>configfile <i>file</i></p>
<p>Load a configuration file </p>
<p>module <i>file</i></p>
<p>Load a kernel module</p>
<p>debug</p>
<p>Toggle debugging mode</p>
<p>modulenounzip <i>file</i></p>
<p>Load a kernel module without </p>
<p>decompressing it</p>
<p>displayapm</p>
<p>Display APM BIOS information </p>
<p>pause <i>message</i></p>
<p>Print a message and wait for a key</p>
<p>press</p>
<p>displaymem</p>
<p>Display memory configuration </p>
<p>quit</p>
<p>Quit the GRUB shell</p>
<p>embed <i>stage</i> <i>device</i></p>
<p>Embed Stage 1.5 in the device</p>
<p>reboot</p>
<p>Reboot the system</p>
<p>find <i>file</i></p>
<p>Find a file</p>
<p>read <i>address</i></p>
<p>Read a 32-bit value from memory </p>
<p>and print it</p>
<p>fstest</p>
<p>Toggle filesystem test mode </p>
<p>root <i>device</i></p>
<p>Set the current root device </p>
<p>geometry <i>drive</i></p>
<p>Print information on a drive </p>
<p>geometry </p>
<p>rootnoverify <i>device</i></p>
<p>Set the current root device without</p>
<p>mounting it</p>
<p>halt</p>
<p>Shut down the system</p>
<p>savedefault</p>
<p>Save current menu entry as the </p>
<p>default entry </p>
<p>help <i>command</i></p>
<p>Show help for a command, or the </p>
<p>available commands</p>
<p>setup <i>device</i></p>
<p>Install GRUB automatically on the </p>
<p>device</p>
<p>impsprobe</p>
<p>Probe the Intel Multiprocessor </p>
<p>Specification </p>
<p>testload <i>file</i></p>
<p>Test the filesystem code on a file</p>
<p>initrd <i>file</i></p>
<p>Load an initial ramdisk image file </p>
<p>testvbe <i>mode</i></p>
<p>Test a VESA BIOS EXTENSION </p>
<p>mode </p>
<p>install <i>options</i></p>
<p>Install GRUB (deprecated, use </p>
<p>setup</p>
<p> instead)</p>
<p>uppermem <i>kbytes</i></p>
<p>Set the upper memory size (only </p>
<p>for old machines) </p>
<p>ioprobe <i>drive</i></p>
<p>Probe I/O ports used for a drive</p>
<p>vbeprobe <i>mode</i></p>
<p>Probe a VESA BIOS EXTENSION </p>
<p>mode </p>
<p><b>/boot/grub/menu.lst </b></p>
<p><b>or</b></p>
<p><b> /boot/grub/grub.conf</b></p>
<p><b>     GRUB Legacy configuration file</b></p>
<p>timeout 10   # Boot the default kernel after 10 seconds</p>
<p>default 0    # Default kernel is 0</p>
<p># Section 0: Linux boot</p>
<p>title   Debian    # Menu item to show on GRUB bootmenu</p>
<p>root    (hd0,0)   # root filesystem is /dev/hda1</p>
<p>kernel /boot/vmlinuz-2.6.24-19-generic root=/dev/hda1 ro quiet splash</p>
<p>initrd /boot/initrd.img-2.6.24-19-generic</p>
<p># Section 1: Windows boot </p>
<p>title   Microsoft Windows XP</p>
<p>root    (hd0,1)   # root filesystem is /dev/hda2</p>
<p>savedefault</p>
<p>makeactive        # set the active flag on this partition </p>
<p>chainloader +1    # read 1 sector from start of partition and run</p>
<p># Section 2: Firmware/BIOS update from floppy disk</p>
<p>title   Firmware update</p>
<p>kernel /memdisk   # boot a floppy disk image</p>
<p>initrd /floppy-img-7.7.7</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>25/189</b></p>
<p><b>dpkg and apt</b></p>
<p><i>dpkg and apt</i></p>
<p>dpkg</p>
<p> is the low-level package manager for Debian.  It uses the DEB package format, which is compressed with </p>
<p>ar</p>
<p>.</p>
<p>dpkg -i <i>package</i>.deb</p>
<p>Install a package file</p>
<p>dpkg -r <i>package</i></p>
<p>Remove a package</p>
<p>dpkg -l</p>
<p>List installed packages and their state</p>
<p>dpkg -L <i>package</i></p>
<p>List the content of an installed package</p>
<p>dpkg -c <i>package</i>.deb</p>
<p>List the content of a package file</p>
<p>dpkg -S <i>file</i></p>
<p>Show the package containing a specific file</p>
<p>dpkg-reconfigure <i>package</i></p>
<p>Reconfigure a package</p>
<p>apt</p>
<p> is the high-level package manager for Debian.</p>
<p>High-level package managers are able to install remote packages and automatically solve dependencies.</p>
<p>apt-get install <i>package</i></p>
<p>Install a package</p>
<p>apt-get remove <i>package</i></p>
<p>Remove a package</p>
<p>apt-get upgrade</p>
<p>Upgrade all installed packages</p>
<p>apt-get dist-upgrade</p>
<p>Upgrade all installed packages and handle dependencies with new versions</p>
<p>apt-get source <i>package</i></p>
<p>Get the source code for a package</p>
<p>apt-get check</p>
<p>Check for broken dependencies and update package cache</p>
<p>apt-get install -f</p>
<p>Fix broken dependencies</p>
<p>apt-get update</p>
<p>Update information on available packages</p>
<p>apt-cache search <i>package</i></p>
<p>Search for a package</p>
<p>apt-cache depends <i>package</i></p>
<p>Show package dependencies</p>
<p>apt-cache show <i>package</i></p>
<p>Show package records</p>
<p>apt-cache showpkg <i>package</i></p>
<p>Show information about a package</p>
<p>apt-file update</p>
<p>Update information about package contents</p>
<p>apt-file list <i>package</i></p>
<p>List the content of an uninstalled package</p>
<p>apt-file search <i>file</i></p>
<p>Show which package provides a specific file</p>
<p>apt-key add <i>keyfile</i></p>
<p>Add a key to the list of keys used to authenticate packages</p>
<p>apt-cdrom add</p>
<p>Add a CD-ROM to the sources list</p>
<p>cat /etc/apt/sources.list</p>
<p>Print list of available repositories</p>
<p>alien -i <i>package</i>.rpm</p>
<p>Convert a RPM package to DEB and install it.</p>
<p>Warning: might break the package database system</p>
<p>dselect</p>
<p>Package manager with text interface, front-end to </p>
<p>dpkg</p>
<p>.  Obsolete </p>
<p>aptitude</p>
<p>Package manager with Ncurses UI, front-end to </p>
<p>apt</p>
<p>synaptic</p>
<p>Package manager with Gtk+ UI, front-end to </p>
<p>apt</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>26/189</b></p>
<p><b>rpm</b></p>
<p><i>rpm</i></p>
<p>rpm</p>
<p> is the low-level package manager for Red Hat.  It uses the RPM package format, which is cpio-compressed.  </p>
<p>rpm -i <i>package</i>.rpm</p>
<p>rpm -i ftp://<i>host/package</i>.rpm</p>
<p>rpm -i http://<i>host/package</i>.rpm</p>
<p>Install a package file</p>
<p>rpm -e <i>package</i></p>
<p>Remove a package</p>
<p>rpm -U <i>package</i>.rpm</p>
<p>Upgrade a package (and remove old versions)</p>
<p>rpm -F <i>package</i>.rpm</p>
<p>Upgrade a package (only if an old version is already installed)</p>
<p>rpm -qa</p>
<p>List installed packages and their state</p>
<p>rpm -qa --last</p>
<p>List installed packages and their installation date, from newest to oldest</p>
<p>rpm -ql <i>package</i></p>
<p>List the content of an installed package</p>
<p>rpm -qpl <i>package</i>.rpm</p>
<p>List the content of a package file</p>
<p>rpm -qf <i>file</i></p>
<p>Show the package containing a specific file</p>
<p>rpm -V <i>package</i></p>
<p>Verify an installed package</p>
<p>rpm -i <i>package</i>.src.rpm</p>
<p>Install a package source file</p>
<p>rpm -ba <i>package</i>.spec</p>
<p>Compile a package source file</p>
<p>rpm2cpio <i>package</i>.rpm</p>
<p>Convert a RPM package to a cpio archive</p>
<p>createrepo <i>directory</i></p>
<p>Create an XML file of repository metadata from the set of RPMs contained in </p>
<p><i>directory</i></p>
<p>pirut</p>
<p>Package manager with GUI.  Obsolete </p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>27/189</b></p>
<p><b>yum</b></p>
<p><i>yum</i></p>
<p>yum</p>
<p> is the high-level package manager for Red Hat up to RHEL 7.  In RHEL 8, it is a front-end to </p>
<p>dnf</p>
<p>.</p>
<p>yum install <i>package</i></p>
<p>Install a package</p>
<p>yum install <i>package</i>.rpm</p>
<p>yum localinstall <i>package</i>.rpm</p>
<p>Install a package file</p>
<p>yum remove <i>package</i></p>
<p>Remove a package</p>
<p>yum update <i>package</i></p>
<p>Upgrade an installed package</p>
<p>yum update</p>
<p>Upgrade all installed packages</p>
<p>yum swap <i>packageout packagein</i></p>
<p>Replace a package with another</p>
<p>yum list</p>
<p>List all installed and available packages</p>
<p>yum list <i>searchterm</i></p>
<p>List installed and available packages matching the search term</p>
<p>yum list installed</p>
<p>List installed packages</p>
<p>yum list available</p>
<p>List packages available for install </p>
<p>yum search <i>searchterm</i></p>
<p>Search for packages that match the search term in the package </p>
<p>name or summary</p>
<p>yum search all <i>searchterm</i></p>
<p>Search for packages that match the search term in the package </p>
<p>name, summary, or description</p>
<p>yum deplist <i>package</i></p>
<p>Show package dependencies (recursively)</p>
<p>yum list <i>package</i></p>
<p>Show package records</p>
<p>yum info <i>package</i></p>
<p>Show information about a package</p>
<p>yum history</p>
<p>yum history list</p>
<p>Show the installation history (installs, updates, etc.)</p>
<p>yum history list <i>n</i></p>
<p>Show item <i>n</i> of the installation history</p>
<p>yum history info <i>n</i></p>
<p>Show detailed information on item <i>n</i> of the installation history </p>
<p>(begin and end times, packages altered, etc.)</p>
<p>yum history package <i>package</i></p>
<p>yum history list package <i>package</i></p>
<p>Show the installation history about a package</p>
<p>yum whatprovides <i>file</i></p>
<p>Show which package provides a specific file</p>
<p>yum <i>cmd</i> --disablerepo=&quot;*&quot; --enablerepo=&quot;<i>repo</i>&quot;</p>
<p>Execute the yum command but only considering a specific </p>
<p>repository <i>repo</i></p>
<p>yum repolist</p>
<p>cat /etc/yum.repos.d/*.repo</p>
<p>Print list of available repositories</p>
<p>yum clean all</p>
<p>rm -rf /var/cache/yum</p>
<p>Delete temporary files for repositories</p>
<p>yumdownloader --resolve <i>package</i></p>
<p>Download package and all its dependencies</p>
<p>yumdownloader --urls <i>package</i></p>
<p>Show URLs that would be downloaded</p>
<p>yum-complete-transaction</p>
<p>Try to complete unfinished or aborted package installations</p>
<p>repoquery --tree-requires <i>package</i></p>
<p>Show a tree with all dependencies of <i>package</i></p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>28/189</b></p>
<p><b>yum repositories</b></p>
<p><i>yum repositories</i></p>
<p><b>Configuration of a Fedora repository (Red Hat)</b></p>
<p>[fedora]</p>
<p>Repository ID</p>
<p>name=Fedora $releasever - $basearch</p>
<p>Repository name</p>
<p>baseurl=http://download.fedoraproject.org/pub/fedora/\</p>
<p>        linux/releases/$releasever/Everything/$basearch/os/</p>
<p>        http://foo.org/linux/$releasever/$basearch/os/</p>
<p>        http://bar.org/linux/$releasever/$basearch/os/</p>
<p>List of URLs to the repository's repodata </p>
<p>directory.  Can be any of these types:</p>
<p>file:///   </p>
<p>local file</p>
<p>file://    </p>
<p>NFS</p>
<p>  </p>
<p>http://    </p>
<p>HTTP</p>
<p>  </p>
<p>https://   </p>
<p>HTTPS</p>
<p>  </p>
<p>ftp://     </p>
<p>FTP </p>
<p>enabled=1</p>
<p>Whether this repository is enabled</p>
<p>gpgcheck=1</p>
<p>Whether to perform a GPG signature check on </p>
<p>the packages downloaded from this repository</p>
<p>failovermethod=priority</p>
<p>Makes yum try the baseurls in the order they </p>
<p>are listed.  By default, if more than one baseurl</p>
<p>is specified, yum chooses one randomly </p>
<p>metalink=https://mirrors.fedoraproject.org/metalink?\</p>
<p>repo=fedora-$releasever&amp;arch=$basearch</p>
<p>URL to a metalink file that specifies the list of </p>
<p>mirrors to use.  Can be used with or in </p>
<p>alternative to a baseurl</p>
<p>gpgkey=file:///etc/pki/rpm-gpg/\</p>
<p>RPM-GPG-KEY-fedora-$releasever-$basearch</p>
<p>ASCII-armored GPG public key file of the </p>
<p>repository</p>
<p>This repository configuration must be located in a repo file e.g. </p>
<p>/etc/yum.repos.d/fedora.repo</p>
<p>.  The same repo file can </p>
<p>contain multiple repository definitions.</p>
<p>The manpage </p>
<p>man yum.conf</p>
<p> lists all repository configuration options.</p>
<p><b>How to install a package on an offline machine</b></p>
<p>The problem of installing a package on an offline machine is that the machine is unable to download the package </p>
<p>dependencies.  To solve this problem, first create an online machine identical to the offline machine, and with the smallest </p>
<p>possible set of packages installed.  Then proceed as follows.</p>
<p>On the online machine:</p>
<p>1.</p>
<p>Install the package and all its dependencies</p>
<p>in a local directory</p>
<p>mkdir /tmp/repo</p>
<p>yum --downloadonly --downloaddir=/tmp/repo install <i>package</i></p>
<p>2.</p>
<p>Create a local yum repository</p>
<p>createrepo /tmp/repo</p>
<p>chown -R root:root /tmp/repo</p>
<p>chmod -R 755 /tmp/repo</p>
<p>3.</p>
<p>Transfer the directory </p>
<p>/tmp/repo</p>
<p> from the online machine to the offline machine</p>
<p>On the offline machine:</p>
<p>4.</p>
<p>Create a yum repo file </p>
<p>/etc/yum.repos.d/local.repo</p>
<p> for the new repository</p>
<p>[local]</p>
<p>name=Local</p>
<p>baseurl=file:///tmp/repo</p>
<p>enabled=1</p>
<p>gpgcheck=0</p>
<p>protect=1</p>
<p>5.</p>
<p>Install the package from the local repository</p>
<p>yum install <i>package</i></p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>29/189</b></p>
<p><b>Backup</b></p>
<p><i>Backup</i></p>
<p>dd</p>
<p>Tool to copy data, byte by byte, from a file or block device.</p>
<p>Should not be used on a mounted block device, because of write cache </p>
<p>issues.</p>
<p>dd if=/dev/sda of=/dev/sdb</p>
<p>cat /dev/sda &gt; /dev/sdb</p>
<p>Copy the content of one hard disk over another</p>
<p>dd if=/dev/sda1 of=sda1.img</p>
<p>Generate the image file of a partition</p>
<p>dd if=/dev/cdrom of=cdrom.iso bs=2048</p>
<p>Create an ISO file from a CD-ROM, using a block size transfer of 2 Kb </p>
<p>dd if=install.iso of=/dev/sdc bs=512k</p>
<p>Write an installation ISO file to a device (e.g. a USB thumb drive)</p>
<p>ddrescue</p>
<p>Tool for data recovery.  Like </p>
<p>dd</p>
<p>, but with high tolerance for read errors</p>
<p>rsync</p>
<p>Tool for local and remote file synchronization.  For all copies subsequent </p>
<p>to the first, copies only the blocks that have changed, making it a very </p>
<p>efficient backup solution in terms of speed and bandwidth</p>
<p>rsync -rzv /home  /tmp/bak</p>
<p>rsync -rzv /home/ /tmp/bak/home</p>
<p>Synchronize the content of the home directory with the temporary </p>
<p>backup directory.  Use recursion, compression, and verbosity</p>
<p>rsync -avz /home root@10.0.0.7:/backup/</p>
<p>Synchronize the content of the home directory with the backup directory </p>
<p>on the remote server, using SSH.  Use archive mode (i.e. operates </p>
<p>recursively and preserves owner, group, permissions, timestamps, and </p>
<p>symlinks)</p>
<p>burp</p>
<p>Backup and restore program</p>
<p><b>Tape libraries</b></p>
<p>Devices</p>
<p>/dev/st0</p>
<p>First SCSI tape device</p>
<p>/dev/nst0</p>
<p>First SCSI tape device (no-rewind device file)</p>
<p>Utility for magnetic tapes</p>
<p>mt -f /dev/nst0 asf 3</p>
<p>Position the tape at the start of 3</p>
<p>rd</p>
<p> file  </p>
<p>Utility for tape libraries</p>
<p>mtx -f /dev/sg1 status</p>
<p>Display status of tape library </p>
<p>mtx -f /dev/sg1 load 3</p>
<p>Load tape from slot 3 to drive 0</p>
<p>mtx -f /dev/sg1 unload</p>
<p>Unload tape from drive 0 to original slot</p>
<p>mtx -f /dev/sg1 transfer 3 4</p>
<p>Transfer tape from slot 3 to slot 4</p>
<p>mtx -f /dev/sg1 inventory</p>
<p>Force robot to rescan all slots and drives</p>
<p>mtx -f /dev/sg1 inquiry</p>
<p>Inquiry about SCSI media device </p>
<p>(Medium Changer = tape library)</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>30/189</b></p>
<p><b>Archive formats</b></p>
<p><i>Archive formats</i></p>
<p><b>cpio</b></p>
<p>ls | cpio -o &gt; <i>archive</i>.cpio</p>
<p>ls | cpio -oF <i>archive</i>.cpio</p>
<p>Create a cpio archive of all files in the current directory</p>
<p>find /home/ | cpio -o &gt; <i>archive</i>.cpio</p>
<p>Create a cpio archive of all users' home directories</p>
<p>cpio -id &lt; <i>archive</i>.cpio</p>
<p>Extract all files, recreating the directory structure</p>
<p>cpio -i -t &lt; <i>archive</i>.cpio</p>
<p>List the contents of a cpio archive file </p>
<p><b>gzip</b></p>
<p>gzip <i>file</i></p>
<p>Compress a file with gzip</p>
<p>gzip &lt; <i>file</i> &gt; <i>file</i>.gz</p>
<p>Compress a file with gzip, leaving the original file into place </p>
<p>gunzip <i>file</i>.gz</p>
<p>Decompress a gzip-compressed file</p>
<p>gunzip -tv <i>file</i>.gz</p>
<p>Test the integrity of a gzip-compressed file</p>
<p>zcat <i>file</i>.gz</p>
<p>Read a gzip-compressed text file</p>
<p>zgrep <i>pattern</i> <i>file</i>.gz</p>
<p>grep</p>
<p> for a gzip-compressed text file</p>
<p>zless <i>file</i>.gz</p>
<p>less</p>
<p> for a gzip-compressed text file </p>
<p>zmore <i>file</i>.gz</p>
<p>more</p>
<p> for a gzip-compressed text file</p>
<p>pigz <i>file</i></p>
<p>Parallel, multicore-optimized gzip</p>
<p><b>bzip2</b></p>
<p>bzip2 <i>file</i></p>
<p>Compress a file with bzip2</p>
<p>bunzip2 <i>file</i>.bz2</p>
<p>Decompress a bzip2-compressed file</p>
<p>bzcat <i>file</i>.bz2 </p>
<p>Read a bzip2-compressed text file</p>
<p><b>7-Zip</b></p>
<p>7z a -t7z <i>archive</i>.7z <i>dir</i>/</p>
<p>Create a 7-Zip archive (has the highest compression ratio)</p>
<p><b>xz</b></p>
<p>xz <i>file</i></p>
<p>Compress a file with xz</p>
<p>unxz <i>file</i>.xz</p>
<p>xz -d <i>file</i>.xz</p>
<p>Decompress a xz-compressed file</p>
<p>xzcat <i>file</i>.xz</p>
<p>Read a xz-compressed file</p>
<p><b>LZMA</b></p>
<p>lzma <i>file</i></p>
<p>xz --format=lzma <i>file</i></p>
<p>Compress a file with LZMA</p>
<p>unlzma <i>file</i>.lzma</p>
<p>xz --format=lzma -d <i>file</i>.lzma</p>
<p>Decompress a LZMA-compressed file</p>
<p>lzcat <i>file</i>.lzma</p>
<p>xz --format=lzma --d --stdout <i>file</i>.lzma</p>
<p>Read a LZMA-compressed file</p>
<p><b>rar</b></p>
<p>rar a <i>archive</i>.rar <i>dir</i>/</p>
<p>Create a RAR archive</p>
<p>unrar x <i>archive</i>.rar</p>
<p>Extract a RAR archive</p>
<p><b>tar</b></p>
<p>tar cf <i>archive</i>.tar <i>dir</i>/</p>
<p>Create a tarred archive (bundles multiple files in a single one)</p>
<p>tar czf <i>archive</i>.tar.gz <i>dir</i>/ </p>
<p>Create a tarred gzip-compressed archive</p>
<p>tar xzf <i>archive</i>.tar.gz</p>
<p>Extract a tarred gzip-compressed archive</p>
<p>tar cjf <i>archive</i>.tar.bz2 <i>dir</i>/</p>
<p>Create a tarred bzip2-compressed archive</p>
<p>tar xjf <i>archive</i>.tar.bz2</p>
<p>Extract a tarred bzip2-compressed archive</p>
<p>tar cJf <i>archive</i>.tar.xz <i>dir</i>/</p>
<p>Create a tarred xz-compressed archive</p>
<p>tar xJf <i>archive</i>.tar.xz</p>
<p>Extract a tarred xz-compressed archive</p>
<p>tar tf <i>archive</i>.tar</p>
<p>List the contents of a tarred archive </p>
<p><b>star</b></p>
<p>star -c -f=<i>archive</i>.star <i>dir</i>/</p>
<p>Create a star archive</p>
<p>star -x -f=<i>archive</i>.star</p>
<p>Extract a star archive</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>31/189</b></p>
<p><b>Documentation</b></p>
<p><i>Documentation</i></p>
<p>man <i>command</i></p>
<p>Show the manpage for <i>command</i></p>
<p>man <i>n</i> <i>command</i></p>
<p>Show section <i>n</i> of the <i>command</i> manpage</p>
<p>man man</p>
<p>Show information about manpages' sections:</p>
<p>1 - Executable programs or shell commands</p>
<p>2 - System calls (functions provided by the kernel)</p>
<p>3 - Library calls (functions within program libraries)</p>
<p>4 - Special files</p>
<p>5 - File formats and conventions</p>
<p>6 - Games</p>
<p>7 - Miscellaneous</p>
<p>8 - System administration commands (only for root)</p>
<p>9 - Kernel routines</p>
<p>man <i>n</i> intro</p>
<p>Show an introduction to the contents of section <i>n</i></p>
<p>mandb</p>
<p>Generate or refresh the search database for manpage </p>
<p>entries.  This must be done after installing new packages, </p>
<p>in order to obtain results from </p>
<p>apropos</p>
<p> or </p>
<p>man -k</p>
<p>yum whatprovides /usr/share/man/man<i>n</i>/<i>command</i>.<i>n</i>.gz</p>
<p>Find which package provides section <i>n</i> of the <i>command</i> </p>
<p>manpage</p>
<p>yum install man-pages  </p>
<p>(Red Hat)</p>
<p>Install a large number of manpages from the Linux </p>
<p>Documentation Project</p>
<p>yum install man-db  </p>
<p>(Red Hat)</p>
<p>Install various manpage commands and utilities</p>
<p>apropos <i>keyword</i></p>
<p>man -k <i>keyword</i></p>
<p>Show the commands whose manpage's short description </p>
<p>matches the keyword.  Inverse of the </p>
<p>whatis</p>
<p> command</p>
<p>apropos -r <i>regex</i></p>
<p>man -k <i>regex</i></p>
<p>Show the commands whose manpage's short description </p>
<p>matches the regex</p>
<p>man -K <i>regex</i></p>
<p>Show the commands whose manpage's full text matches </p>
<p>the regex</p>
<p>whatis <i>command</i></p>
<p>Show the manpage's short description for a command</p>
<p>info <i>command</i></p>
<p>Show the Info documentation for a command</p>
<p>help</p>
<p>Show the list of available shell commands and functions</p>
<p>help <i>command</i></p>
<p>Show help about a shell command or function</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>32/189</b></p>
<p><b>Shell usage</b></p>
<p><i>Shell usage</i></p>
<p>history</p>
<p>Show the history of command lines executed up to this moment.</p>
<p>Commands prepended by a space will be executed but will not show up in the history.</p>
<p>After the user logs out from Bash, history is saved into </p>
<p>~/.bash_history</p>
<p>!<i>n</i></p>
<p>Execute command number <i>n</i> in the command line history </p>
<p>history -c</p>
<p>Clear the command line history</p>
<p>history -d <i>n</i></p>
<p>Delete command number <i>n</i> from the command line history</p>
<p>alias ls='ls -lap'</p>
<p>Set up an alias for the </p>
<p>ls</p>
<p> command</p>
<p>alias</p>
<p>Show defined aliases</p>
<p>unalias ls</p>
<p>Remove the alias for the </p>
<p>ls</p>
<p> command</p>
<p>\ls</p>
<p>/bin/ls</p>
<p>Run the non-aliased version of the </p>
<p>ls</p>
<p> command </p>
<p>Almost all Linux commands accept the option </p>
<p>-v</p>
<p> (verbose), and some commands also accept the options </p>
<p>-vv</p>
<p> or </p>
<p>-vvv</p>
<p> </p>
<p>(increasing levels of verbosity).</p>
<p>All Bash built-in commands, and many other commands, accept the flag </p>
<p>--</p>
<p> which denotes the end of options and the start </p>
<p>of positional parameters:</p>
<p>grep -- -i <i>file</i></p>
<p>Search for the string &quot;-i&quot; in <i>file</i></p>
<p>rm -- -rf</p>
<p>Delete a file called &quot;-rf&quot;</p>
<p>cat /etc/debian_version  </p>
<p>(Debian)</p>
<p>cat /etc/fedora-release  </p>
<p>(Fedora)</p>
<p>cat /etc/redhat-release  </p>
<p>(Red Hat) </p>
<p>cat /etc/lsb-release  </p>
<p> </p>
<p>lsb_release -a  </p>
<p> </p>
<p>cat /etc/os-release  </p>
<p> </p>
<p>Display Linux distribution name and version</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>33/189</b></p>
<p><b>Text filters</b></p>
<p><i>Text filters</i></p>
<p>cat <i>file</i></p>
<p>Print a text file</p>
<p>cat <i>file1</i> <i>file2</i> &gt; <i>file3</i></p>
<p>Concatenate text files</p>
<p>cat <i>file1</i> &gt; <i>file2</i></p>
<p>&gt; <i>file2</i> &lt; <i>file1</i> cat</p>
<p>Copy <i>file1</i> to <i>file2</i>.  The </p>
<p>cat</p>
<p> command is able to operate on binary streams as well </p>
<p>and therefore it works also with binary files (e.g. JPG images)</p>
<p>cat &gt; <i>file</i> &lt;&lt;<i>EOF</i></p>
<p><i>line 1</i></p>
<p><i>line 2</i></p>
<p><i>line 3</i></p>
<p><i>EOF</i></p>
<p>Create a <b>Here Document</b>, storing the lines entered in input to <i>file</i>.</p>
<p><i>EOF</i> can be any text</p>
<p><i>command</i> &lt;&lt;&lt; '<i>string</i>'</p>
<p>Create a <b>Here String</b>, passing <i>string</i> as input to <i>command</i></p>
<p>cat -etv &lt;&lt;&lt; '<i>string</i>'</p>
<p>Print <i>string</i>, showing all invisible characters</p>
<p>tac <i>file</i></p>
<p>Print or concatenate text files in opposite order line-wise, from last line to first line</p>
<p>rev <i>file</i></p>
<p>Print a text file with every line reversed character-wise, from last char to first char</p>
<p>head <i>file</i></p>
<p>head -n 10 <i>file</i></p>
<p>Print the first 10 lines of a text file</p>
<p>tail <i>file</i></p>
<p>tail -n 10 <i>file</i></p>
<p>Print the last 10 lines of a text file</p>
<p>tail -f <i>file</i></p>
<p>Output appended data as the text file grows.  Useful to read a logfile in real-time</p>
<p>tail -n +1 <i>file1 file2 file3</i></p>
<p>Print each file with a filename header</p>
<p>multitail -i <i>file1</i> -i <i>file2</i></p>
<p>tail</p>
<p> for multiple files at the same time (Ncurses UI)</p>
<p>column <i>file</i></p>
<p>Format a text file into columns</p>
<p>pr <i>file</i></p>
<p>Format a text file for a printer</p>
<p>fmt -w 75 <i>file</i></p>
<p>Format a text file so that each line has a max width of 75 characters</p>
<p>fold -w40 <i>file</i></p>
<p>Wrap each line of a text file to 40 characters</p>
<p>nl <i>file</i></p>
<p>Prepend line numbers to a text file</p>
<p>wc <i>file</i></p>
<p>Print the number of lines, words, and bytes of a text file</p>
<p>join <i>file1</i> <i>file2</i></p>
<p>Join lines of two text files on a common field</p>
<p>paste <i>file1</i> <i>file2</i></p>
<p>Merge lines of text files</p>
<p>split -l 1 <i>file</i></p>
<p>Split a text file into 1-line files; these will be named </p>
<p>xaa</p>
<p>, </p>
<p>xab</p>
<p>, </p>
<p>xac</p>
<p>, etc.</p>
<p>uniq <i>file</i></p>
<p>Print the unique lines of a text file, omitting consecutive identical lines</p>
<p>sort <i>file</i></p>
<p>Sort alphabetically the lines of a text file</p>
<p>shuf <i>file</i></p>
<p>Shuffle randomly the lines of a text file</p>
<p>expand <i>file</i></p>
<p>Convert tabs into spaces</p>
<p>unexpand <i>file</i></p>
<p>Convert spaces into tabs</p>
<p>diff <i>file1 file2</i></p>
<p>Compare two text files line by line and print the differences</p>
<p>cmp <i>file1 file2</i></p>
<p>Compare two files and print the differences</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>34/189</b></p>
<p><b>Advanced text filters</b></p>
<p><i>Advanced text filters</i></p>
<p>cut -d: -f3 <i>file</i></p>
<p>Cut the lines of a file, considering </p>
<p>:</p>
<p> as the delimiter and printing only </p>
<p>the 3</p>
<p>rd</p>
<p> field</p>
<p>cut -d: -f1 /etc/passwd</p>
<p>Print the list of local user accounts in the system</p>
<p>cut -c3-50 <i>file</i></p>
<p>Print character 3 to 50 of each line of a file</p>
<p>sed 's/foo/bar/' <i>file</i></p>
<p>Stream Editor: Replace the first occurrence on a line of &quot;foo&quot; with &quot;bar&quot;</p>
<p>in <i>file</i>, and print on stdout the result </p>
<p>sed -i 's/foo/bar/' <i>file</i></p>
<p>Replace &quot;foo&quot; with &quot;bar&quot;, overwriting the results in <i>file</i></p>
<p>sed 's/foo/bar/g' <i>file</i></p>
<p>Replace all occurrences of &quot;foo&quot; with &quot;bar&quot;</p>
<p>sed '0,/foo/s//bar/' <i>file</i></p>
<p>Replace only the first line match</p>
<p>sed -n '7,13p' <i>file</i></p>
<p>Print line 7 to 13 of a text file</p>
<p>sed &quot;s/foo/$var/&quot; <i>file</i></p>
<p>Replace &quot;foo&quot; with the value of variable $var.</p>
<p>The double quotes are necessary for variable expansion</p>
<p>tr a-z A-Z &lt;<i>file</i></p>
<p>tr [:lower:] [:upper:] &lt;<i>file</i></p>
<p>Translate characters: Convert all lowercase into uppercase in a text file</p>
<p>tr -d 0-9 &lt;<i>file</i></p>
<p>tr -d [:digit:] &lt;<i>file</i></p>
<p>Delete all digits from a text file</p>
<p>awk</p>
<p>Interpreter for the AWK programming language, designed for text </p>
<p>processing and data extraction</p>
<p>grep foo <i>file</i></p>
<p>Print the lines of a file containing &quot;foo&quot;</p>
<p>grep -v foo <i>file</i></p>
<p>Print the lines of a file not containing &quot;foo&quot;</p>
<p>grep -e foo -e bar <i>file</i></p>
<p>grep -E 'foo|bar' <i>file</i></p>
<p>Print the lines of a file containing &quot;foo&quot; or &quot;bar&quot;</p>
<p>grep -v -e foo -e bar <i>file</i></p>
<p>Print the lines of a file containing neither &quot;foo&quot; nor &quot;bar&quot;</p>
<p>grep -E <i>regex</i> <i>file</i></p>
<p>egrep <i>regex file</i></p>
<p>Print the lines of a file matching the given Extended Regex</p>
<p>tail -f <i>file</i> | grep --line-buffered foo</p>
<p>tail -f <i>file</i> | stdbuf -o0 grep foo</p>
<p>Output appended data as the text file grows, printing only the lines </p>
<p>containing &quot;foo&quot;</p>
<p>stdbuf <i>option command</i></p>
<p>Run <i>command</i> with modified stdin, stdout, or stderr buffering</p>
<p>rpl <i>oldstring newstring file</i></p>
<p>Replace strings in a file</p>
<p>tidy</p>
<p>Correct and tidy up the markup of HTML, XHTML, and XML files</p>
<p>tidy -asxml -xml -indent -wrap 2000 \</p>
<p>-quiet --hide-comments yes <i>file.xml</i></p>
<p>Strip out comments from an XML file</p>
<p>json_verify &lt; <i>file.json</i></p>
<p>Validate the syntax of a JSON file</p>
<p>json_reformat &lt; <i>file.json</i></p>
<p>Pretty format a JSON file</p>
<p>strings <i>file</i></p>
<p>Show all printable character sequences at least 4-characters long that </p>
<p>are contained in <i>file</i></p>
<p>antiword <i>file.doc</i></p>
<p>Show text and images from a MS Word document</p>
<p>catdoc <i>file.doc</i></p>
<p>Output plaintext from a MS Word document</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>35/189</b></p>
<p><b>Regular expressions</b></p>
<p><i>Regular expressions</i></p>
<p>^</p>
<p>Beginning of a line</p>
<p>$</p>
<p>End of a line</p>
<p>\&lt; \&gt;</p>
<p>Word boundaries (beginning of line, end of line, space, or punctuation mark)</p>
<p>.</p>
<p>Any character except newline</p>
<p>[abc]</p>
<p>Any of the characters specified</p>
<p>[a-z]</p>
<p>Any of the characters in the specified range</p>
<p>[^abc]</p>
<p>Any character except those specified</p>
<p>*</p>
<p>Zero or more times the preceding regex</p>
<p>+</p>
<p>One or more times the preceding regex</p>
<p>?</p>
<p>Zero or one time the preceding regex</p>
<p>{5}</p>
<p>Exactly 5 times the preceding regex</p>
<p>{5,}</p>
<p>5 times or more the preceding regex</p>
<p>{,10}</p>
<p>At most 10 times the preceding regex</p>
<p>{5,10}</p>
<p>Between 5 and 10 times the preceding regex</p>
<p>|</p>
<p>The regex either before or after the vertical bar</p>
<p>( )</p>
<p>Grouping, to be used for back-references.  </p>
<p>\1</p>
<p> expands to the 1</p>
<p>st</p>
<p> match, </p>
<p>\2</p>
<p> to the 2</p>
<p>nd</p>
<p>, etc. until </p>
<p>\9</p>
<p>The symbols above are used in POSIX EREs (Extended Regular Expressions).  </p>
<p>In POSIX BREs (Basic Regular Expressions), the symbols </p>
<p>? + { | ( )</p>
<p> need to be escaped (by adding a backslash character</p>
<p>\</p>
<p> in front of them).</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>36/189</b></p>
<p><b>File management</b></p>
<p><i>File management</i></p>
<p>cp <i>file file2</i></p>
<p>Copy a file</p>
<p>Common options:</p>
<p>-i  </p>
<p>Prompt before overwriting/deleting files (interactive)</p>
<p>-f  </p>
<p>Don't ask before overwriting/deleting files (force)</p>
<p>cp <i>file dir/</i></p>
<p>Copy a file to a directory</p>
<p>cp -ar /<i>dir1</i>/. /<i>dir2</i>/</p>
<p>Copy a directory recursively</p>
<p>mv <i>file file2</i></p>
<p>Rename a file</p>
<p>mv <i>file dir/</i></p>
<p>Move a file to a directory</p>
<p>rm <i>file</i></p>
<p>Delete a file</p>
<p>pv <i>file</i> &gt; <i>file2</i></p>
<p>Copy a file, monitoring the progress of data through a pipe</p>
<p>rename <i>str1 str2 file</i></p>
<p>Rename a file, replacing the first occurrence of string <i>str1</i> with <i>str2</i></p>
<p>unlink <i>file</i></p>
<p>Remove the hard link to a file (equivalent to </p>
<p>rm</p>
<p>)</p>
<p>touch <i>file</i></p>
<p>Change access timestamp and modify timestamp of a file as now.</p>
<p>If the file does not exist, it is created</p>
<p>truncate -s <i>size file</i></p>
<p>Shrink or extend a file to the specified size.</p>
<p>If the file is larger than the specified size, it is truncated; if the file is shorter, the extra space</p>
<p>is filled with zeros</p>
<p>mktemp</p>
<p>Create a temporary file or directory, using </p>
<p>tmp.XXXXXXXXXX</p>
<p> as filename template </p>
<p>fdupes <i>dir</i></p>
<p>Examines a directory for duplicate files in it.  To consider files a duplicate, first compares file </p>
<p>sizes and MD5 signatures, then compares the file contents byte-by-byte </p>
<p>tmpwatch</p>
<p>Remove files which have not been accessed for some time</p>
<p>od <i>file</i></p>
<p>Dump a file into octal (or other formats)</p>
<p>hexdump <i>options file</i></p>
<p>Dump a file into hexadecimal (or other formats e.g. octal, decimal, ASCII)</p>
<p>xxd <i>options file</i></p>
<p>Convert a file from binary to hexadecimal, or vice versa</p>
<p><b>File-naming wildcards (globbing)</b></p>
<p>*</p>
<p>Matches zero or more characters</p>
<p>?</p>
<p>Matches one character</p>
<p>[abc]</p>
<p>Matches a, b, or c</p>
<p>[!abc]</p>
<p>Matches any character except a, b, or c</p>
<p>[a-z]</p>
<p>Matches any character between a and z</p>
<p><b>Brace expansion</b></p>
<p>cp foo.{txt,bak}</p>
<p>Copy file &quot;foo.txt&quot; to &quot;foo.bak&quot;</p>
<p>touch foo_{a,b,c}</p>
<p>touch foo_{a..c}</p>
<p>Create files &quot;foo_a&quot;, &quot;foo_b&quot;, &quot;foo_c&quot;</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>37/189</b></p>
<p><b>Directory management</b></p>
<p><i>Directory management</i></p>
<p>cd <i>directory</i></p>
<p>Change to the specified directory</p>
<p>cd -</p>
<p>Change to the previously used directory</p>
<p>pwd</p>
<p>Print the current working directory</p>
<p>ls</p>
<p>dir</p>
<p>vdir</p>
<p>List the contents of the current directory</p>
<p>ls -d */</p>
<p>List only directories contained on the current directory</p>
<p>ls -lap --sort=v</p>
<p>List files, sorted by version number</p>
<p>mkdir <i>dir</i></p>
<p>Create a directory</p>
<p>mkdir -m 755 <i>dir</i></p>
<p>Create a directory with mode 755</p>
<p>mkdir -p <i>/dir1/dir2/dir3</i></p>
<p>Create a directory, creating also the parent directories if they don't exist</p>
<p>rmdir <i>dir</i></p>
<p>Delete a directory (which must be empty)</p>
<p>tree</p>
<p>List directories and their contents in hierarchical format</p>
<p>dirs</p>
<p>Display the directory stack (i.e. the list of remembered directories)</p>
<p>pushd <i>dir</i></p>
<p>Add <i>dir</i> to the top of the directory stack and make it the current working directory</p>
<p>popd</p>
<p>Remove the top directory from the directory stack and change to the new top directory</p>
<p>dirname <i>file</i></p>
<p>Output the directory path in which <i>file</i> is located, stripping any non-directory suffix from </p>
<p>the filename</p>
<p>realpath <i>file</i></p>
<p>Output the resolved absolute path of <i>file</i></p>
<p><b>Bash directory shortcuts</b></p>
<p>.</p>
<p>Current directory</p>
<p>..</p>
<p>Parent directory</p>
<p>~</p>
<p>Home directory of current user</p>
<p>~<i>user</i></p>
<p>Home directory of <i>user</i></p>
<p>~-</p>
<p>Previously used directory</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>38/189</b></p>
<p><b>File operations</b></p>
<p><i>File operations</i></p>
<p>stat <i>file</i></p>
<p>Display file or filesystem status</p>
<p>stat -c %A <i>file</i></p>
<p>Display file permissions</p>
<p>stat -c %s <i>file</i></p>
<p>Display file size, in bytes</p>
<p>shred /dev/hda</p>
<p>Securely wipe the contents of a device </p>
<p>shred -u <i>file</i></p>
<p>Securely delete a file</p>
<p>lsof</p>
<p>List all open files</p>
<p>lsof -u <i>user</i></p>
<p>List all files currently open by <i>user</i></p>
<p>lsof -i</p>
<p>List open files and their sockets (equivalent to </p>
<p>netstat -ap</p>
<p>)</p>
<p>lsof -i :80</p>
<p>List connections of local processes on port 80</p>
<p>lsof -i@10.0.0.3</p>
<p>List connections of local processes to remote host 10.0.0.3</p>
<p>lsof -i@10.0.0.3:80</p>
<p>List connections of local processes to remote host 10.0.0.3 on port 80</p>
<p>lsof -c mysqld</p>
<p>List all files opened by </p>
<p>mysqld</p>
<p>, the MySQL daemon</p>
<p>lsof <i>file</i></p>
<p>List all processes using a specific <i>file</i></p>
<p>lsof +L1</p>
<p>List open files with a link count of 0 i.e. that have been unlinked.  These files are not </p>
<p>accessible but take up disk space.  A process holding such a file prevents the system from </p>
<p>deleting it (thus freeing disk space), until the process is killed or restarted</p>
<p>fuser</p>
<p>Show the name of processes using a specific file, directory, or socket</p>
<p>fuser -v <i>file</i></p>
<p>Show the name of the process using <i>file</i></p>
<p>fuser -v -n tcp 443</p>
<p>Show the name of the process running on port 443</p>
<p>lslocks</p>
<p>List information about all currently held file locks</p>
<p>aide</p>
<p>Advanced Intrusion Detection Environment.  HIDS tool that makes a snapshot of the </p>
<p>filesystem state and records it in a database, to check integrity of files at a later time</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>39/189</b></p>
<p><b>I/O streams</b></p>
<p><i>I/O streams</i></p>
<p>In Linux, everything is (displayed as) a file.  File descriptors are automatically associated to any process launched.</p>
<p><b>File descriptors</b></p>
<p><b>#</b></p>
<p><b>Name</b></p>
<p><b>Type</b></p>
<p><b>Default device</b></p>
<p><b>Device file</b></p>
<p>0</p>
<p>Standard input (stdin)</p>
<p>Input text stream</p>
<p>Keyboard</p>
<p>/dev/stdin</p>
<p>1</p>
<p>Standard output (stdout)</p>
<p>Output text stream</p>
<p>Terminal</p>
<p>/dev/stdout</p>
<p>2</p>
<p>Standard error (stderr)</p>
<p>Output text stream</p>
<p>Terminal</p>
<p>/dev/stderr</p>
<p>mail <i>user@email</i> &lt; <i>file</i></p>
<p>Redirect <i>file</i> to the stdin of command </p>
<p>mail</p>
<p> (in this case, send via e-mail the contents of </p>
<p><i>file</i> to the email address <i>user@email</i>).</p>
<p>Redirection is handled by the shell, not by the command invoked.  The space after the </p>
<p>redirect operator is optional</p>
<p>ls &gt; <i>file</i></p>
<p>ls 1&gt; <i>file</i></p>
<p>Redirect the stdout of command </p>
<p>ls</p>
<p> to <i>file</i> (in this case, write on <i>file</i> the contents of the </p>
<p>current directory).  This overwrites <i>file</i> if it already exists, unless the Bash noclobber </p>
<p>option is set (via </p>
<p>set -o noclobber</p>
<p>)</p>
<p>ls &gt;| <i>file</i></p>
<p>Redirect the stdout of command </p>
<p>ls</p>
<p> to <i>file</i>, even if noclobber is set</p>
<p>ls &gt;&gt; <i>file</i></p>
<p>ls 1&gt;&gt; <i>file</i></p>
<p>Append the stdout of command </p>
<p>ls</p>
<p> to <i>file</i></p>
<p>ls 2&gt; <i>file</i></p>
<p>Redirect the stderr of command </p>
<p>ls</p>
<p> to <i>file</i> (in this case, write any error encountered by </p>
<p>the command </p>
<p>ls</p>
<p> to <i>file</i>)</p>
<p>ls 2&gt;&gt; <i>file</i></p>
<p>Append the stderr of command </p>
<p>ls</p>
<p> to <i>file</i></p>
<p>ls 2&gt; /dev/null</p>
<p>Silence any error coming from the command </p>
<p>ls</p>
<p> </p>
<p>cat &lt;<i>file1</i> &gt;<i>file2</i></p>
<p>&lt;<i>file1</i> cat &gt;<i>file2</i></p>
<p>&lt;<i>file1</i> &gt;<i>file2</i> cat</p>
<p>Redirect <i>file1</i> to the stdin and <i>file2</i> to the stdout of the command </p>
<p>cat</p>
<p> (in this case, copy </p>
<p><i>file1</i> to <i>file2</i>).</p>
<p>cat &gt;<i>file2</i> &lt;<i>file1</i></p>
<p> also works but is not recommended, because it truncates <i>file2</i> if </p>
<p><i>file1</i> cannot be opened</p>
<p>cat /etc/passwd | wc -l</p>
<p>Pipe the stdout of command </p>
<p>cat</p>
<p> to the stdin of command </p>
<p>wc</p>
<p> (in this case, print the </p>
<p>number of accounts in the system).</p>
<p>Piped commands run concurrently</p>
<p>echo &quot;$(sort <i>file</i>)&quot; &gt; <i>file</i></p>
<p>echo &quot;`sort <i>file</i>`&quot; &gt; <i>file</i></p>
<p>sort <i>file</i> | sponge <i>file</i></p>
<p>Sort the contents of <i>file</i> and write the output to the file itself.</p>
<p>sort <i>file</i> &gt; <i>file</i></p>
<p> would not produce the desired result, because the stdout destination </p>
<p>is created (and therefore the content of the preexisting <i>file</i> is deleted) before the </p>
<p>sort</p>
<p> </p>
<p>command is run</p>
<p>ls 2&gt;&amp;1 </p>
<p>Redirect stderr of command </p>
<p>ls</p>
<p> to stdout </p>
<p>ls &gt; <i>file</i> 2&gt;&amp;1</p>
<p>Redirect both stdout and stderr of command </p>
<p>ls</p>
<p> to <i>file</i>.</p>
<p>ls &amp;&gt; <i>file</i></p>
<p> and </p>
<p>ls &gt;&amp; <i>file</i></p>
<p> also work on some systems but are not recommended, </p>
<p>because they are not POSIX standard</p>
<p>&gt; <i>file</i></p>
<p>Create an empty file.  If the file exists, its content will be deleted</p>
<p>ls | tee <i>file</i></p>
<p>tee</p>
<p> reads from stdin and writes both to stdout and <i>file</i> (in this case, writes the contents </p>
<p>of the current directory to screen and to <i>file</i> at the same time)</p>
<p>ls | tee -a <i>file</i></p>
<p>tee</p>
<p> reads from stdin and appends both to stdout and <i>file</i></p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>40/189</b></p>
<p><b>read and echo</b></p>
<p><i>read and echo</i></p>
<p>read MYVAR</p>
<p>Read a variable from standard input</p>
<p>read -n 8 MYVAR</p>
<p>Read only max 8 chars from standard input</p>
<p>read -t 60 MYVAR</p>
<p>Read a variable from standard input, timing out after one minute</p>
<p>read -s MYVAR</p>
<p>Read a variable from standard input without echoing to terminal (silent mode)</p>
<p>while read -r line</p>
<p>do</p>
<p>   echo &quot;Hello $line&quot;</p>
<p>done &lt; <i>file</i></p>
<p>Process a text file line by line, reading from <i>file</i>, and output the lines.</p>
<p>If <i>file</i> is </p>
<p>/dev/stdin</p>
<p>, reads from standard input instead</p>
<p>while read line</p>
<p>do</p>
<p>   for word in $line</p>
<p>   do</p>
<p>      echo &quot;Hello $word&quot;</p>
<p>   done</p>
<p>done &lt; <i>file</i></p>
<p>Process a text file containing multiple words in each line, and output the words</p>
<p>while IFS=$'\t' read -r -a array</p>
<p>do</p>
<p>   echo &quot;${array[0]}&quot;</p>
<p>   echo &quot;${array[1]}&quot;</p>
<p>   echo &quot;${array[2]}&quot;</p>
<p>done &lt; <i>file</i></p>
<p>Process a text file containing three words per line separated by a tab, and </p>
<p>output the words.  Example of input file:</p>
<p>aaaa    bbb     ccc</p>
<p>dd      eeeee   ff</p>
<p>ggg     hhh     iiii</p>
<p>echo $MYVAR</p>
<p>Print a variable on screen</p>
<p>echo -n &quot;<i>message</i>&quot;</p>
<p>printf &quot;<i>message</i>&quot;</p>
<p>Print <i>message</i> onscreen without a trailing line feed</p>
<p>echo -e '\a'</p>
<p>Produce an alert sound (BEL sequence)</p>
<p>pv -qL10 &lt;&lt;&lt; &quot;<i>message</i>&quot;</p>
<p>Print <i>message</i> onscreen, one character at a time</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>41/189</b></p>
<p><b>Processes</b></p>
<p><i>Processes</i></p>
<p>Any application, program, script, or service that runs on the system is a <b>process</b>.  Processes whose parent is a shell are </p>
<p>called <b>jobs</b>.</p>
<p><b>Signals</b> are used for inter-process communication.  Each process has a unique PID (Process ID) and a PPID (Parent Process </p>
<p>ID); when a process spawns a child, the process PID is assigned to the child's PPID.</p>
<p>The </p>
<p>/sbin/init</p>
<p> process, run at bootup, has PID 1.  It is the ancestor of all processes and becomes the parent of any </p>
<p>orphaned process.  It is also unkillable; should it die, the kernel will panic.</p>
<p>When a child process dies, its status becomes EXIT_ZOMBIE and a SIGCHLD is sent to the parent.  The parent should then </p>
<p>call the </p>
<p>wait()</p>
<p> system call to read the dead process' exit status and other information; until that moment, the child process</p>
<p>remains a zombie. </p>
<p>ps -ef  </p>
<p>(UNIX options)</p>
<p>ps aux  </p>
<p>(BSD options)</p>
<p>List all processes</p>
<p>pstree <i>PID</i></p>
<p>Display all processes in hierarchical format.  </p>
<p>The process tree is rooted at <i>PID</i>, or at </p>
<p>init</p>
<p> if <i>PID</i> is omitted</p>
<p>pidof <i>processname</i></p>
<p>Show PIDs of processes with name <i>processname</i></p>
<p>pidof -s <i>processname</i></p>
<p>Show PID of process with name <i>processname</i>, returning a single result</p>
<p>pgrep sshd</p>
<p>ps -ef | grep &quot;[s]shd&quot;</p>
<p>Show processes whose name is &quot;sshd&quot;</p>
<p>pgrep -u root sshd</p>
<p>Show processes whose name is &quot;sshd&quot; and are owned by root </p>
<p>pmap <i>PID</i></p>
<p>Display the memory map of process <i>PID</i></p>
<p>kill -9 1138</p>
<p>Send a signal 9 (SIGKILL) to process 1138, hence killing it</p>
<p>killall -9 sshd</p>
<p>Kill processes whose name is &quot;sshd&quot;</p>
<p>pkill -9 -u root sshd</p>
<p>Kill processes whose name is &quot;sshd&quot; and are owned by root</p>
<p>pkill -9 -u <i>user</i></p>
<p>Kill all processes owned by <i>user</i>, forcing him to log out</p>
<p>skill</p>
<p>Send a signal to a process or show process status.  Obsolete</p>
<p>xkill</p>
<p>Kill a process by its X GUI resource.  Pops up a cursor to select a window</p>
<p>jobs</p>
<p>List all jobs</p>
<p>Suspend a job, putting it in the stopped state (send a SIGTSTP)</p>
<p>bg %<i>n</i></p>
<p>Put job # <i>n</i> in the background (send a SIGCONT)</p>
<p>fg %<i>n</i></p>
<p>Resume job # <i>n</i> in the foreground and make it the current job (send a SIGCONT)</p>
<p>kill %<i>n</i></p>
<p>Kill job # <i>n</i></p>
<p>disown %<i>n</i></p>
<p>Remove job #<i>n</i> from the table of active jobs </p>
<p>disown -h %<i>n</i></p>
<p>Prevent job #<i>n</i> from receiving a SIGHUP if the shell receives that signal</p>
<p>To each process is associated a niceness value: the higher the niceness, the lower the priority.</p>
<p>The niceness value ranges from -20 to 19, and a newly created process has a default niceness of 0.</p>
<p>Unprivileged users can modify a process' niceness only within the range from 1 to 19.</p>
<p>nice -n -5 <i>command</i></p>
<p>Start <i>command</i> with a niceness of -5.  If niceness is omitted, a default value of 10 is used</p>
<p>renice -5 <i>command</i></p>
<p>Change the niceness of a running <i>command</i> to -5</p>
<p>snice</p>
<p>Change the niceness of a process.  Obsolete</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>CTRL</p>
<p>Z</p>
<h1 style="page-break-before:always; "></h1>
<p><b>42/189</b></p>
<p><b>Signals</b></p>
<p><i>Signals</i></p>
<p><b>Most frequently used signals</b></p>
<p><b>Signal number</b></p>
<p><b>Signal name</b></p>
<p><b>Effect</b></p>
<p>1</p>
<p>SIGHUP</p>
<p>Used by many daemons to reload their configuration</p>
<p>2</p>
<p>SIGINT</p>
<p>Interrupt, stop</p>
<p>9</p>
<p>SIGKILL</p>
<p>Kill unconditionally (this signal cannot be ignored)</p>
<p>15</p>
<p>SIGTERM</p>
<p>Terminate gracefully</p>
<p>18</p>
<p>SIGCONT</p>
<p>Continue execution</p>
<p>20</p>
<p>SIGTSTP</p>
<p>Stop execution</p>
<p>The manpage </p>
<p>man 7 signal</p>
<p> lists all signal numbers and names.</p>
<p>kill -l</p>
<p>List all available signal names</p>
<p>kill -l <i>n</i></p>
<p>Print the name of signal number <i>n</i></p>
<p>trap <i>action condition</i></p>
<p>Trap a signal</p>
<p>strace <i>command</i></p>
<p>Trace the execution of <i>command</i>, intercepting and printing system </p>
<p>calls called by a process and signals received by a process </p>
<p>ipcs</p>
<p>Show IPC facilities information (shared memory, message queues, </p>
<p>and semaphores)</p>
<p>:(){ :|:&amp; };:</p>
<p>Fork bomb: starts a process that continually replicates itself, slowing</p>
<p>down or crashing the system because of resource starvation.  </p>
<p>Dangerous!</p>
<p>( <i>command</i> )&amp; pid=$!; sleep <i>n</i>; kill -9 $pid</p>
<p>Run <i>command</i> and kill it after <i>n</i> seconds</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>43/189</b></p>
<p><b>Resource monitoring</b></p>
<p><i>Resource monitoring</i></p>
<p>top</p>
<p>Monitor processes in real-time</p>
<p>htop</p>
<p>Monitor processes in real-time (Ncurses UI)</p>
<p>iotop</p>
<p>Display I/O usage by processes in the system</p>
<p>atop</p>
<p>Advanced system monitor that displays the load on CPU, RAM, disk, and network </p>
<p>powertop</p>
<p>Power consumption and power management diagnosis tool</p>
<p>uptime</p>
<p>Show how long the system has been up, how many users are connected, and the system</p>
<p>load averages for the past 1, 5, and 15 minutes</p>
<p>time <i>command</i></p>
<p>Execute <i>command</i> and, at its completion, write to stderr timing statistics about the run: </p>
<p>elapsed real time between invocation and termination, user CPU time, system CPU time</p>
<p>sar</p>
<p>Show reports about system activity (including reboots).  </p>
<p>Reports are generated from data collected via the cron job </p>
<p>sysstat</p>
<p> and stored in </p>
<p>/var/log/sa/s<i>n</i></p>
<p>, where <i>n</i> is the day of the month </p>
<p>sar -f /var/log/sa/sa13 \</p>
<p>-s 06:00:00 -e 09:00:00</p>
<p>Show reports for system activity from 6 to 9 AM on the 13</p>
<p>th</p>
<p> of the month</p>
<p>sar -u <i>n m</i></p>
<p>Show real-time CPU activity, every <i>n</i> seconds for <i>m</i> times</p>
<p>sar -n DEV</p>
<p>Show real-time network activity (received and transmitted packets per second)</p>
<p>sysbench</p>
<p>Multi-threaded benchmark tool able to monitor different OS parameters: file I/O, </p>
<p>scheduler, memory allocation, thread implementation, databases</p>
<p>inxi</p>
<p>Debugging tool to rapidly and easily gather system information and configuration</p>
<p>stress-ng</p>
<p>Tool for CPU and RAM stress tests</p>
<p><b>Linux monitoring tools</b></p>
<p>collectd</p>
<p>System statistics collector</p>
<p>Nagios</p>
<p>System monitor and alert</p>
<p>MRTG</p>
<p>Network load monitor</p>
<p>Cacti</p>
<p>Network monitor</p>
<p>Munin</p>
<p>System and network monitor and alert</p>
<p>Zabbix</p>
<p>System and network monitor and alert</p>
<p>Centreon</p>
<p>System and network monitor and alert</p>
<p>netdata</p>
<p>Real-time performance and health monitor</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>44/189</b></p>
<p><b>vmstat</b></p>
<p><i>vmstat</i></p>
<p>vmstat</p>
<p>Print a report about virtual memory statistics: processes, memory, paging, block I/O, traps, disks, and</p>
<p>CPU activity</p>
<p>iostat</p>
<p>Print a report about CPU utilization, device utilization, and network filesystem.</p>
<p>The first report shows statistics since the system boot; subsequent reports will show statistics since </p>
<p>the previous report</p>
<p>mpstat</p>
<p>Print a report about processor activities</p>
<p>vmstat <i>n m</i></p>
<p>iostat <i>n m</i></p>
<p>mpstat <i>n m</i></p>
<p>Print the relevant report every <i>n</i> seconds for <i>m</i> times</p>
<p><b>Output of command </b></p>
<p><b>vmstat</b></p>
<p>procs -----------memory---------- ---swap-- -----io---- --system-- -----cpu-----</p>
<p> r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st</p>
<p> 0  0      0 296724 267120 3393400   0    0    17    56    0    3  2  2 95  1  0</p>
<p><b>procs</b></p>
<p><b>r</b></p>
<p>Number of runnable processes (running or waiting for run time)</p>
<p><b>b</b></p>
<p>Number of processes in uninterruptible sleep</p>
<p><b>memory</b></p>
<p><b>swpd</b></p>
<p>Virtual memory used (swap)</p>
<p>in Kb</p>
<p><b>free</b></p>
<p>Free memory (idle)</p>
<p><b>buff</b></p>
<p>Memory used as buffers</p>
<p><b>cache</b></p>
<p>Memory used as cache</p>
<p><b>swap</b></p>
<p><b>si</b></p>
<p>Memory swapped in from disk</p>
<p>in Kb/second</p>
<p><b>so</b></p>
<p>Memory swapped out to disk</p>
<p><b>io</b></p>
<p><b>bi</b></p>
<p>Blocks received in from a block device</p>
<p>in blocks/second</p>
<p><b>bo</b></p>
<p>Blocks sent out to a block device</p>
<p><b>system</b></p>
<p><b>in</b></p>
<p>Number of interrupts</p>
<p>per second</p>
<p><b>cs</b></p>
<p>Number of context switches</p>
<p><b>cpu</b></p>
<p><b>us</b></p>
<p>Time spent running user code (non-kernel)</p>
<p>in percentage of total CPU time</p>
<p><b>sy</b></p>
<p>Time spent running system code (kernel)</p>
<p><b>id</b></p>
<p>Time spent idle</p>
<p><b>wa</b></p>
<p>Time spent waiting for I/O</p>
<p><b>st</b></p>
<p>Time stolen from a virtual machine </p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>45/189</b></p>
<p><b>free</b></p>
<p><i>free</i></p>
<p>free</p>
<p>Show the amount of free and used memory in the system</p>
<p><b>Output of command </b></p>
<p><b>free</b></p>
<p>              total        used        free      shared  buff/cache   available</p>
<p>Mem:       16344088     2273312    11531400      776228     2539376    12935112</p>
<p>Swap:       1048572           0     1048572</p>
<p>             total       used       free     shared    buffers     cached</p>
<p>Mem:       1504544    1491098      13021          0      91112     764542</p>
<p>-/+ buffers/cache:     635212     869498</p>
<p>Swap:      2047686       7667    2040019</p>
<p><b>Mem</b></p>
<p><b>total</b></p>
<p>Total configured amount of memory</p>
<p><b>used</b></p>
<p>Used memory</p>
<p><b>free</b></p>
<p>Unused memory</p>
<p><b>shared</b></p>
<p>Memory used by tmpfs, 0 if not available</p>
<p><b>buff/cache</b></p>
<p>Memory used by kernel buffers, page cache, and slabs</p>
<p><b>available</b></p>
<p>Memory available for new applications (without using swap) </p>
<p>*</p>
<p>  </p>
<p><b>-/+ buffers/cache</b></p>
<p><b>used</b></p>
<p>Memory used by kernel buffers</p>
<p><b>free</b></p>
<p>Memory available for new applications (without using swap) </p>
<p>*</p>
<p><b>Swap</b></p>
<p><b>total</b></p>
<p>Total configured amount of swap space</p>
<p><b>used</b></p>
<p>Used swap space</p>
<p><b>free</b></p>
<p>Free swap space </p>
<p>*</p>
<p>*</p>
<p> These are the true values indicating the free system resources available.</p>
<p>All values are in Kb, unless options are used.</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>46/189</b></p>
<p><b>File permissions</b></p>
<p><i>File permissions</i></p>
<p><b>-</b></p>
<p><b>r w x</b></p>
<p><b>r w x</b></p>
<p><b>r w x</b></p>
<p><b>.</b></p>
<p><b>Permission</b></p>
<p><b>Octal value</b></p>
<p><b>Command</b></p>
<p><b>Effect on file</b></p>
<p><b>Effect on directory</b></p>
<p><b>Read</b></p>
<p>user: 400      </p>
<p>chmod u+r</p>
<p>Can open and read the file</p>
<p>Can list directory content</p>
<p>group: 40</p>
<p>chmod g+r</p>
<p>others: 4</p>
<p>chmod o+r</p>
<p><b>Write</b></p>
<p>user: 200      </p>
<p>chmod u+w</p>
<p>Can modify the file</p>
<p>Can create, delete, and rename files in </p>
<p>the directory</p>
<p>group: 20</p>
<p>chmod g+w</p>
<p>others: 2</p>
<p>chmod o+w</p>
<p><b>Execute</b></p>
<p>user: 100      </p>
<p>chmod u+x</p>
<p>Can execute the file (binary </p>
<p>or script)</p>
<p>Can enter the directory, and search files</p>
<p>within (by accessing a file's inode)</p>
<p>group: 10</p>
<p>chmod g+x</p>
<p>others: 1</p>
<p>chmod o+x</p>
<p><b>SetUID (SUID)</b></p>
<p>4000</p>
<p>chmod u+s</p>
<p>Executable is run with the </p>
<p>privileges of the file's owner</p>
<p>No effect</p>
<p><b>SetGID (SGID)</b></p>
<p>2000</p>
<p>chmod g+s</p>
<p>Executable is run with the </p>
<p>privileges of the file's group</p>
<p>All new files and subdirectories inherit </p>
<p>the directory's group ID</p>
<p><b>Sticky</b></p>
<p>1000</p>
<p>chmod +t</p>
<p>No effect</p>
<p>Files inside the directory can be deleted </p>
<p>or moved only by the file's owner</p>
<p>chmod 711 <i>file</i></p>
<p>chmod u=rwx,go=x <i>file</i></p>
<p>Set read, write, and execute permission to user; set execute permission to group and others</p>
<p>chmod u+wx <i>file</i></p>
<p>Add write and execute permission to user</p>
<p>chmod -x <i>file</i></p>
<p>Remove execute permission from everybody (user, group, and others)</p>
<p>chmod -R g+x <i>/path</i></p>
<p>Set the group execute bit recursively on <i>path</i> and every dir and file underneath</p>
<p>find <i>/path</i> -type d \</p>
<p>-exec chmod g+x {} \;</p>
<p>Set the group execute bit recursively on <i>path</i> and every dir, but not file, underneath </p>
<p>chown <i>user</i> <i>file</i></p>
<p>Change the owner of the file to <i>user</i></p>
<p>chown <i>user</i>:<i>group</i> <i>file</i></p>
<p>Change the owner of the file to <i>user</i>, and group ownership of the file to <i>group</i></p>
<p>chown :<i>group</i> <i>file</i></p>
<p>chgrp <i>group</i> <i>file</i></p>
<p>Change group ownership of the file to <i>group</i></p>
<p>umask 022</p>
<p>Set the permission mask to 022, hence masking write permission for group and others.</p>
<p>Linux default permissions are 0666 for files and 0777 for directories.  These base </p>
<p>permissions are ANDed with the inverted umask value to calculate the final permissions of a </p>
<p>new file or directory</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p><b>user (owner)</b></p>
<p>r</p>
<p> = read</p>
<p>w</p>
<p> = write</p>
<p>x</p>
<p> = execute</p>
<p>s</p>
<p> = setUID and execute</p>
<p>S</p>
<p> = setUID and not execute</p>
<p><b>user (owner)</b></p>
<p>r</p>
<p> = read</p>
<p>w</p>
<p> = write</p>
<p>x</p>
<p> = execute</p>
<p>s</p>
<p> = setUID and execute</p>
<p>S</p>
<p> = setUID and not execute</p>
<p><b>group</b></p>
<p>r</p>
<p> = read</p>
<p>w</p>
<p> = write</p>
<p>x</p>
<p> = execute</p>
<p>s</p>
<p> = setGID and execute</p>
<p>S</p>
<p> = setGID and not execute</p>
<p><b>group</b></p>
<p>r</p>
<p> = read</p>
<p>w</p>
<p> = write</p>
<p>x</p>
<p> = execute</p>
<p>s</p>
<p> = setGID and execute</p>
<p>S</p>
<p> = setGID and not execute</p>
<p><b>others</b></p>
<p>r</p>
<p> = read</p>
<p>w</p>
<p> = write</p>
<p>x</p>
<p> = execute</p>
<p>t</p>
<p> = sticky and execute</p>
<p>T</p>
<p> = sticky and not execute</p>
<p><b>others</b></p>
<p>r</p>
<p> = read</p>
<p>w</p>
<p> = write</p>
<p>x</p>
<p> = execute</p>
<p>t</p>
<p> = sticky and execute</p>
<p>T</p>
<p> = sticky and not execute</p>
<h1 style="page-break-before:always; "></h1>
<p><b>47/189</b></p>
<p><b>File attributes</b></p>
<p><i>File attributes</i></p>
<p><b>-</b></p>
<p><b>r w x</b></p>
<p><b>r w x</b></p>
<p><b>r w x</b></p>
<p><b>.</b></p>
<p><b>Attribute</b></p>
<p><b>Effect</b></p>
<p>a</p>
<p>File can only be opened in append mode for writing</p>
<p>A</p>
<p>When file is accessed, its atime record is not modified</p>
<p>c</p>
<p>File is automatically compressed on-the-fly on disk by the kernel</p>
<p>C</p>
<p>File is not subject to copy-on-write updates.  This applies only to filesystems which perform copy-on-write </p>
<p>d</p>
<p>File will not be backed up by the </p>
<p>dump</p>
<p> program</p>
<p>D</p>
<p>When directory is modified, changes are written synchronously on disk.  Equivalent to </p>
<p>dirsync</p>
<p> mount option</p>
<p>e</p>
<p>File is using extents for mapping the blocks on disk</p>
<p>E</p>
<p>Compression error on file.  This attribute is used by experimental compression patches</p>
<p>h</p>
<p>File stores its blocks in units of filesystem blocksize instead of in units of sectors, and is larger than 2 Tb</p>
<p>i</p>
<p>File is immutable i.e. cannot be modified, linked, or changed permissions </p>
<p>I</p>
<p>Directory is being indexed using hashed trees</p>
<p>j</p>
<p>All file data is written to the ext3 or ext4 journal before being written to the file itself</p>
<p>N</p>
<p>File has data stored inline within the inode itself</p>
<p>s</p>
<p>File will be securely wiped by zeroing when deleted</p>
<p>S</p>
<p>When file is modified, changes are written synchronously on disk.  Equivalent to the </p>
<p>sync</p>
<p> mount option</p>
<p>t</p>
<p>File will not have EOF partial block fragment merged with other files.  This applies only to filesystems with </p>
<p>support for tail-merging</p>
<p>T</p>
<p>Directory is the top of directory hierarchies for the purpose of the Orlov block allocator</p>
<p>u</p>
<p>After file is deleted, it can be undeleted </p>
<p>X</p>
<p>Raw contents of compressed file can be accessed directly.  This attribute is used by experimental </p>
<p>compression patches</p>
<p>Z</p>
<p>Compressed file is dirty.  This attribute is used by experimental compression patches</p>
<p>chattr +<i>attribute</i> <i>file</i></p>
<p>Add a file or directory attribute</p>
<p>chattr -<i>attribute</i> <i>file</i></p>
<p>Remove a file or directory attribute</p>
<p>chattr =<i>attribute</i> <i>file</i></p>
<p>Set a file or directory attribute, removing all other attributes</p>
<p>lsattr <i>file</i></p>
<p>List file or directory attributes</p>
<p><b>Timestamp</b></p>
<p><b>Value tracked</b></p>
<p><b>Displayed via</b></p>
<p>mtime</p>
<p>Time of last <b>modification</b> to file contents (data itself)</p>
<p>ls -l</p>
<p>ctime</p>
<p>Time of last <b>change</b> to file contents or file metadata (owner, group, or permissions)</p>
<p>ls -lc</p>
<p>atime</p>
<p>Time of last <b>access</b> to file for reading contents </p>
<p>ls -lu</p>
<p>The POSIX standard does not define a timestamp for file <b>creation</b>.  Some filesystems (e.g. ext4, JFS, Btrfs) store this value,</p>
<p>but currently there is no Linux kernel API to access it.</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>-</p>
<p> = regular file</p>
<p>d</p>
<p> = directory</p>
<p>l</p>
<p> = symbolic link</p>
<p>s</p>
<p> = Unix domain socket</p>
<p>p</p>
<p> = named pipe</p>
<p>c</p>
<p> = character device file</p>
<p>b</p>
<p> = block device file</p>
<p>-</p>
<p> = regular file</p>
<p>d</p>
<p> = directory</p>
<p>l</p>
<p> = symbolic link</p>
<p>s</p>
<p> = Unix domain socket</p>
<p>p</p>
<p> = named pipe</p>
<p>c</p>
<p> = character device file</p>
<p>b</p>
<p> = block device file</p>
<p>.</p>
<p> = file with SELinux context</p>
<p>+</p>
<p> = file with ACL</p>
<p>.</p>
<p> = file with SELinux context</p>
<p>+</p>
<p> = file with ACL</p>
<h1 style="page-break-before:always; "></h1>
<p><b>48/189</b></p>
<p><b>ACLs</b></p>
<p><i>ACLs</i></p>
<p>Access Control Lists (ACLs) provide a fine-grained set of permissions that can be applied to files and directories.</p>
<p>An <b>access ACL</b> is set on an individual file or directory; a <b>default ACL</b> is set on a directory, and applies to all files and </p>
<p>subdirs created inside it that don't have an access ACL.  </p>
<p>The final permissions are the intersection of the ACL with the chmod/umask value. </p>
<p>A partition must have been mounted with the </p>
<p>acl</p>
<p> option in order to support ACLs on files.  </p>
<p>setfacl -m u:<i>user</i>:<i>permissions</i> <i>file</i></p>
<p>Set an access ACL on a file for an user</p>
<p>setfacl -m g:<i>group</i>:<i>permissions</i> <i>file</i></p>
<p>Set an access ACL on a file for a group</p>
<p>setfacl -m m:<i>permissions</i> <i>file</i></p>
<p>Set the effective rights mask on a file</p>
<p>setfacl -m o:<i>permissions</i> <i>file</i></p>
<p>Set the permissions on a file for other users</p>
<p>setfacl -x u:<i>user</i> <i>file</i></p>
<p>Remove an access ACL from a file for an user</p>
<p>setfacl -x g:<i>group file</i></p>
<p>Remove an access ACL from a file for a group</p>
<p>The <i>permissions</i> are standard Unix permissions specified as any combination of </p>
<p>r w x</p>
<p>.</p>
<p>setfacl -m d:u:<i>user</i>:<i>permissions</i> <i>dir</i></p>
<p>setfacl -d -m u:<i>user</i>:<i>permissions</i> <i>dir</i></p>
<p>Same as above, but set a default ACL instead of an access ACL. </p>
<p>This applies to all commands above</p>
<p>getfacl <i>file</i></p>
<p>Display the access (and default, if any) ACL for a file </p>
<p>getfacl <i>file1</i> | setfacl --set-file=- <i>file2</i></p>
<p>Copy the ACL of <i>file1</i> and apply it to <i>file2</i></p>
<p>getfacl --access <i>dir</i> | setfacl -d -M- <i>dir</i></p>
<p>Copy the access ACL of a directory and set it as default ACL</p>
<p>chacl <i>options</i></p>
<p>Change an ACL. </p>
<p>This command exists to provide compatibility with IRIX</p>
<p>man acl</p>
<p>Show the manpage about ACLs</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>49/189</b></p>
<p><b>Links</b></p>
<p><i>Links</i></p>
<p>An <b>inode</b> is a structure containing all file metadata: file type, permissions, owner, group, size, access/change/modification/ </p>
<p>deletion times, number of links, attributes, ACLs, and address where the actual file content (data) is stored.  However, an </p>
<p>inode does not contain the name of the file; this information is stored in the directory where the file is located (i.e. </p>
<p>referenced).</p>
<p>A directory contains a list of mappings between filenames and inodes.</p>
<p>In Linux, there are two kinds of links: <b>hard links</b> and <b>symbolic links</b> (aka <b>soft links</b>).</p>
<p>The <b>link count</b> of a file is the total number of hard links to that file (i.e. to that file's inode).  By default, files have a link </p>
<p>count of 1, and directories have a link count of 2 (the directory itself, and the </p>
<p>.</p>
<p> link inside the directory).  The link count of a</p>
<p>directory is increased by one for each subdirectory (because of the </p>
<p>..</p>
<p> parent link inside the subdirectory).  Once a file has </p>
<p>no hard links pointing to it, the file is deleted, provided that no process holds the file open for reading.</p>
<p><b>Hard link</b></p>
<p><b>Symbolic link</b></p>
<p><b>Definition</b></p>
<p>A link to an already existing inode</p>
<p>A path to a filename; a shortcut</p>
<p><b>Command to create it</b></p>
<p>ln <i>file hardlink</i></p>
<p>ln -s <i>file symlink</i></p>
<p><b>Link is still valid if the original file</b></p>
<p><b>is moved or deleted</b></p>
<p>Yes (because the link still references the</p>
<p>inode to which the original file pointed)</p>
<p>No (because the path now references a </p>
<p>non-existent file)</p>
<p><b>Can link to a file in another </b></p>
<p><b>filesystem</b></p>
<p>No (because inode numbers make sense</p>
<p>only within a determinate filesystem)</p>
<p>Yes</p>
<p><b>Can link to a directory</b></p>
<p>No</p>
<p>Yes</p>
<p><b>Link permissions</b></p>
<p>Reflect the original file's permissions, </p>
<p>even when these are changed</p>
<p>rwxrwxrwx</p>
<p><b>Link attributes</b></p>
<p>-</p>
<p> (regular file)</p>
<p>l</p>
<p> (symbolic link)</p>
<p><b>Inode number</b></p>
<p>The same as the original file</p>
<p>A different inode number (since it's a </p>
<p>different file)</p>
<p>ls -i</p>
<p>Show a listing of the directory with the inode number for each file</p>
<p>ls -l</p>
<p>Show a listing of the directory with the link count for each file</p>
<p>df -i</p>
<p>Report filesystem inode usage</p>
<p>find / -inum <i>n</i></p>
<p>Find all files linked to the same inode <i>n</i></p>
<p>find / -samefile <i>file</i></p>
<p>Find all files linked to the same inode as <i>file</i></p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>50/189</b></p>
<p><b>Find system files</b></p>
<p><i>Find system files</i></p>
<p>find <i>/path</i> -name &quot;foo*&quot;</p>
<p>find <i>/path</i> -name &quot;foo*&quot; -print</p>
<p>Find all files and dirs, in the directory tree rooted at <i>/path</i>, </p>
<p>whose name starts with &quot;foo&quot;</p>
<p>find / -name &quot;foo*&quot; -exec chmod 700 {} \;</p>
<p>Find all files and dirs whose name start with &quot;foo&quot; and apply </p>
<p>permission 700 to all of them</p>
<p>find / -name &quot;foo*&quot; -ok chmod 700 {} \;</p>
<p>Find all files and dirs whose name start with &quot;foo&quot; and apply </p>
<p>permission 700 to all of them, asking for confirmation</p>
<p>find / -size +128M</p>
<p>Find all files larger than 128 Mb</p>
<p>find / -type f -ctime +10 </p>
<p>Find all files last changed more than 10 days ago</p>
<p>find / -type f -perm -4000 </p>
<p>Find all files with SUID set (a possible security risk, because a </p>
<p>shell with SUID root is a backdoor)</p>
<p>find / -type f -newermt &quot;May 4 2:55&quot; -delete</p>
<p>Find and delete all files newer than the specified timestamp.</p>
<p>Using </p>
<p>-delete</p>
<p> is preferable to using </p>
<p>-exec rm {} \;</p>
<p>find . -type f -print -exec cat {} \;  </p>
<p>Print all files, in the current directory and under, prepending </p>
<p>them with a filename header</p>
<p>find . \! -name &quot;*.gz&quot; -type f -exec gzip {} \;</p>
<p>Find all files, in the current directory and under, which do not </p>
<p>have the </p>
<p>gz</p>
<p> extension, and compress them</p>
<p>find / -xdev -type f -size +100M \</p>
<p>-exec ls -lah {} \;</p>
<p>Find all files larger than 100 Mb in the current filesystem only </p>
<p>and display detailed information about them</p>
<p>locate <i>file</i></p>
<p>slocate <i>file</i></p>
<p>Locate <i>file</i> by searching the file index </p>
<p>/etc/updatedb.conf</p>
<p>, </p>
<p>not by actually walking the filesystem.  The search is fast but </p>
<p>will only held results relative to the last rebuild of the file index</p>
<p>updatedb</p>
<p>Rebuild the file index</p>
<p>which <i>command</i></p>
<p>Locate a binary executable command within the PATH </p>
<p>which -a <i>command</i></p>
<p>Locate all matches of a command, not only the first one </p>
<p>whereis <i>command</i></p>
<p>Locate the binary, source, and manpage files for a command</p>
<p>whereis -b <i>command</i></p>
<p>Locate the binary files for a command</p>
<p>whereis -s <i>command</i></p>
<p>Locate the source files for a command</p>
<p>whereis -m <i>command</i></p>
<p>Locate the manpage files for a command</p>
<p>type <i>command</i></p>
<p>Determine if a command is a program or a built-in (i.e. an </p>
<p>internal feature of the shell)</p>
<p>file <i>file</i></p>
<p>Analyze the content of a file or directory, and display the kind </p>
<p>of file (e.g. executable, text file, program text, swap file)</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>51/189</b></p>
<p><b>Shell variables</b></p>
<p><i>Shell variables</i></p>
<p>The scope of <b>variables</b> is the current shell only, while <b>environment variables</b> are visible within the current shell as well as</p>
<p>within all subshells and Bash child processes spawned by the shell.</p>
<p>Environment variables are set in </p>
<p>/etc/environment</p>
<p> in the form </p>
<p><i>variable</i>=<i>value</i></p>
<p>.</p>
<p>Conventionally, variable names are lowercase while environment variable names are uppercase.</p>
<p>set</p>
<p>Display all variables</p>
<p>env</p>
<p>Display all environment variables</p>
<p>readonly -p</p>
<p>Display all variables that are read-only</p>
<p><i>VAR</i>=<i>value</i></p>
<p>((<i>VAR</i>=<i>value</i>))</p>
<p>let &quot;<i>VAR</i>=<i>value</i>&quot;</p>
<p>Set the value of a variable.</p>
<p>There must be no spaces around the </p>
<p>=</p>
<p> sign.  It is possible to add space around </p>
<p>((</p>
<p> and </p>
<p>))</p>
<p>readonly <i>VAR</i>=<i>value</i></p>
<p>Set a variable making its value unchangeable</p>
<p>set ${<i>VAR</i>:=<i>value</i>}</p>
<p><i>VAR</i>=${<i>VAR</i>:-<i>value</i>}</p>
<p>Set a variable only if it is not already set (i.e. does not exist) or is null</p>
<p>unset <i>VAR</i></p>
<p>Unset (i.e. delete) a variable</p>
<p>export <i>VAR</i></p>
<p>Export a variable, making it an environment variable</p>
<p><i>command</i> $<i>VAR</i></p>
<p><i>command</i> ${<i>VAR</i>}HELLO</p>
<p><i>command</i> &quot;${<i>VAR}</i>&quot;</p>
<p>Pass a variable as argument to <i>command</i>.</p>
<p>If other characters follow the variable name, it is necessary to specify the boundaries of </p>
<p>the variable name via </p>
<p>{}</p>
<p> to make it unambiguous.</p>
<p>It is recommended to double quote the variable when referencing it, to prevent </p>
<p>interpretation of special characters (except </p>
<p>\ $ `</p>
<p> ) and word splitting (in case the </p>
<p>variable value contains whitespaces), both of which will have unintended results</p>
<p><i>VAR</i>=$((5 + 37))</p>
<p><i>VAR</i>=$[5 + 37]</p>
<p><i>VAR</i>=$((<i>VAR2</i> + 42))</p>
<p><i>VAR</i>=`expr $<i>VAR2</i> + 42`</p>
<p>Evaluate a numeric expression and assign the result to another variable</p>
<p>((<i>VAR</i>++))</p>
<p>((++<i>VAR</i>))</p>
<p>((<i>VAR</i>+=1))</p>
<p>((<i>VAR</i>=<i>VAR</i>+1))</p>
<p>Increase a variable by 1</p>
<p><i>VAR</i>=`<i>command</i>`</p>
<p><i>VAR</i>=$(<i>command</i>)</p>
<p>Command substitution.  Assign to a variable the standard output resulting from <i>command</i></p>
<p>(which is executed in a subshell)</p>
<p>for i in /<i>path</i>/*</p>
<p>do</p>
<p>   echo &quot;Filename: $i&quot;</p>
<p>done</p>
<p>Loop and operate through all the output tokens (in this case, files in the <i>path</i>).</p>
<p>The equivalent construct </p>
<p>for i in $(ls /<i>path</i>/)</p>
<p> is unnecessary and harmful, because </p>
<p>filenames containing whitespaces or glob characters will cause unintended results</p>
<p>echo ${<i>VAR</i>:-<i>message</i>}</p>
<p>If variable exists and is not null, print its value, otherwise print <i>message</i></p>
<p>echo ${<i>VAR</i>:+<i>message</i>}</p>
<p>If variable exists and is not null, print <i>message</i>, otherwise print nothing</p>
<p>echo ${<i>VAR</i>,,}</p>
<p>Print a string variable in lowercase</p>
<p><i>TOKENS</i>=($<i>STRING</i>)</p>
<p>String tokenizer.  Splits a string stored in the variable <i>STRING</i> into tokens, according to </p>
<p>the content of the shell variable </p>
<p>$IFS</p>
<p>, and stores them in the array <i>TOKENS</i></p>
<p>echo ${<i>TOKENS</i>[<i>n</i>]}</p>
<p>Print the token number <i>n</i></p>
<p>echo ${<i>TOKENS</i>[*]}</p>
<p>Print all tokens</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>52/189</b></p>
<p><b>Shell operations</b></p>
<p><i>Shell operations</i></p>
<p><b>Bash built-in variables</b></p>
<p>$0</p>
<p>Script name</p>
<p>$<i>n</i></p>
<p><i>n</i>th argument passed to the script or function</p>
<p>$@</p>
<p>All arguments passed to the script or function; each argument is a separate word</p>
<p>$*</p>
<p>All arguments passed to the script or function, as a single word</p>
<p>$#</p>
<p>Number of arguments passed to the script or function</p>
<p>$?</p>
<p>Exit status of the last recently executed command</p>
<p>${PIPESTATUS[<i>n</i>]}</p>
<p>Exit status of the <i>n</i>th command in the executed pipeline</p>
<p>$$</p>
<p>PID of the script in which this variable is called</p>
<p>$!</p>
<p>PID of the last recently executed background command</p>
<p>$SHLVL</p>
<p>Deepness level of current shell, starting with 1</p>
<p>$IFS</p>
<p>Internal Field Separator; defines what are the token separators for strings (e.g. for </p>
<p>word splitting after expansion).  By default it has the value &quot;space, tab, newline&quot;</p>
<p>$RANDOM</p>
<p>Pseudorandom integer value between 0 and 32767</p>
<p><b>Bash shell event</b></p>
<p><b>Files run</b></p>
<p>When a login shell is launched</p>
<p>/etc/profile</p>
<p>/etc/profile.d/*.sh</p>
<p>~/.bash_profile</p>
<p>~/.bash_login</p>
<p>~/.profile </p>
<p>The shell executes the system-wide </p>
<p>profile files, then the first of the 3 </p>
<p>user files that exists and is readable</p>
<p>When a login shell exits</p>
<p>~/.bash_logout</p>
<p>When a non-login shell is launched</p>
<p>/etc/bash.bashrc</p>
<p>/etc/bashrc</p>
<p>~/.bashrc</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>Recent distributions sometimes do not even have .bash_profile  and/or .bash_login ,</p>
<p> and some just do little more than include .bashrc.</p>
<h1 style="page-break-before:always; "></h1>
<p><b>53/189</b></p>
<p><b>Shell options</b></p>
<p><i>Shell options</i></p>
<p>set -<i>option</i></p>
<p>set -o <i>longoption</i></p>
<p>Enable a Bash option</p>
<p>set +<i>option</i></p>
<p>set +o <i>longoption</i></p>
<p>Disable a Bash option</p>
<p>set -o</p>
<p>Show the status of all Bash options</p>
<p>set -v</p>
<p>set -o verbose</p>
<p>Print shell input lines as they are read</p>
<p>set -x</p>
<p>set -o xtrace</p>
<p>Print command traces before execution of each command (debug mode)</p>
<p>set -e</p>
<p>set -o errexit</p>
<p>Exit the script immediately if a command fails.  Recommended option</p>
<p>set -u</p>
<p>set -o nounset</p>
<p>Treat expansion of unset variables as an error.  This avoids unintended results</p>
<p>There are three ways to run a script with a specific Bash option enabled:</p>
<p>- Run the script with </p>
<p>bash -<i>option</i> <i>script.sh</i></p>
<p>- Specify the shebang line in the script as </p>
<p>#!/bin/bash -<i>option</i></p>
<p>- Add the command </p>
<p>set -<i>option</i></p>
<p> at the beginning of the script</p>
<p>shopt</p>
<p>Display the list of all shell options with their current value (on or off)</p>
<p>shopt -s <i>shelloption</i></p>
<p>Set (enable) a specific shell option</p>
<p>shopt -u <i>shelloption</i></p>
<p>Unset (disable) a specific shell option</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>54/189</b></p>
<p><b>Shell scripting</b></p>
<p><i>Shell scripting</i></p>
<p>Bash shell scripts must start with the shebang line</p>
<p> #!/bin/bash </p>
<p>indicating the location of the script interpreter.</p>
<p><b>Script execution</b></p>
<p>source <i>script.sh</i></p>
<p>. <i>script.sh</i></p>
<p>Script execution takes place in the same shell.  Variables defined and </p>
<p>exported in the script are seen by the shell when the script exits</p>
<p>bash <i>script.sh</i></p>
<p>./<i>script.sh</i>  </p>
<p>(file must be executable)</p>
<p>Script execution spawns a new shell</p>
<p><i>command</i> &amp;</p>
<p>Execute <i>command</i> in the background</p>
<p><i>command1</i>; <i>command2</i></p>
<p>Execute <i>command 1</i> and then <i>command 2</i></p>
<p><i>command1</i> &amp;&amp; <i>command2</i></p>
<p>Execute <i>command 2</i> only if <i>command 1</i> executed successfully (exit status = 0)</p>
<p><i>command1</i> || <i>command2</i></p>
<p>Execute <i>command 2</i> only if <i>command 1</i> did not execute successfully (exit status &gt; 0)</p>
<p>(<i>command1</i> &amp;&amp; <i>command2</i>)</p>
<p>Group commands together for evaluation priority</p>
<p>(<i>command</i>)</p>
<p>Run <i>command</i> in a subshell.  This is used to isolate <i>command</i>'s effects, as variable </p>
<p>assignments and other changes to the shell environment operated by <i>command</i> will </p>
<p>not remain after <i>command</i> completes</p>
<p>exit</p>
<p>Terminate a script</p>
<p>exit <i>n</i></p>
<p>Terminate a script with the specified exit status number <i>n</i>.  By convention, a 0 exit </p>
<p>status is used if the script executed successfully, a non-zero value otherwise</p>
<p><i>command</i> || exit 1</p>
<p>(To be used inside a script.)  Exit the script if <i>command</i> fails </p>
<p>/bin/true</p>
<p>Do nothing and return immediately a status code of 0 (indicating success)</p>
<p>/bin/false</p>
<p>Do nothing and return immediately a status code of 1 (indicating failure)</p>
<p>if <i>command</i></p>
<p>then echo &quot;Success&quot;</p>
<p>else echo &quot;Failure&quot;</p>
<p>fi</p>
<p>Run a command, then evaluate whether it exited successfully or failed</p>
<p>function myfunc { <i>commands</i> }</p>
<p>myfunc() { <i>commands</i> }</p>
<p>Define a function.  A function must be defined before it can be used in a Bash script.</p>
<p>Argument number <i>n</i> is accessed in the body of the function via </p>
<p>$<i>n</i></p>
<p>.</p>
<p>An advantage of functions over aliases is that functions can be passed arguments</p>
<p>myfunc <i>arg1</i> <i>arg2</i> </p>
<p>...</p>
<p>Call a function</p>
<p>readonly -f myfunc</p>
<p>Mark an already defined function as read-only, preventing it to be redefined</p>
<p>typeset -f</p>
<p>Show functions defined in the current Bash session</p>
<p>readonly -p -f</p>
<p>Show functions which are read-only</p>
<p>expect</p>
<p>Dialogue with interactive programs according to a script, analyzing what can be </p>
<p>expected from the interactive program and replying accordingly</p>
<p>zenity</p>
<p>Display GTK+ graphical dialogs for user messages and input</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>55/189</b></p>
<p><b>getopts</b></p>
<p><i>getopts</i></p>
<p>getopts</p>
<p>Parse positional parameters in a shell script</p>
<p><b>getopts</b></p>
<p><b> syntax</b></p>
<p>while getopts abc:d: <i>OPT</i></p>
<p>do</p>
<p>   case $<i>OPT</i> in</p>
<p>Definition of accepted options</p>
<p>      a)</p>
<p>         <i>command_a</i></p>
<p>         exit 0</p>
<p>         ;;</p>
<p>Matches option </p>
<p>-a</p>
<p>.</p>
<p>Executes a command</p>
<p>      b)</p>
<p>         <i>command_b</i></p>
<p>         exit 0</p>
<p>         ;;</p>
<p>      c)</p>
<p>         <i>command_c</i> $OPTARG</p>
<p>         exit 0</p>
<p>         ;;</p>
<p>Matches option </p>
<p>-c <i>argument</i></p>
<p>.</p>
<p>Executes a command with argument</p>
<p>      d)  </p>
<p>         <i>command_d</i> $OPTARG</p>
<p>         exit 0</p>
<p>         ;;</p>
<p>      *)</p>
<p>         <i>default_command</i></p>
<p>         exit 1</p>
<p>         ;;</p>
<p>Command to execute if none of above options applies</p>
<p>   esac</p>
<p>done</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>56/189</b></p>
<p><b>Command execution</b></p>
<p><i>Command execution</i></p>
<p>watch <i>command</i></p>
<p>Execute <i>command</i> every 2 seconds</p>
<p>watch -d -n 1 <i>command</i></p>
<p>Execute <i>command</i> every second, highlighting the differences in the output</p>
<p>timeout 30s <i>command</i></p>
<p>Execute <i>command</i> and kill it after 30 seconds</p>
<p><i>command</i> | ts</p>
<p>Prepend a timestamp to each line of the output of <i>command</i></p>
<p>sleep 5</p>
<p>Pause for 5 seconds</p>
<p>sleep $[($RANDOM % 60) + 1]s</p>
<p>Sleep for a random time between 1 and 60 seconds</p>
<p>sleep infinity</p>
<p>Pause forever</p>
<p>usleep 5000</p>
<p>Pause for 5000 microseconds</p>
<p>yes</p>
<p>Output endlessly the string &quot;y&quot;</p>
<p>yes <i>string</i></p>
<p>Output endlessly <i>string</i></p>
<p>yes | fsck /dev/sda</p>
<p>Automatically answer yes every time </p>
<p>fsck</p>
<p> asks for confirmation before fixing errors</p>
<p>script <i>file</i></p>
<p>Generate a typescript of a terminal session.</p>
<p>Forks a subshell and starts recording on <i>file</i> everything that is printed on terminal; </p>
<p>the typescript ends when the user exits the subshell</p>
<p>xargs <i>command</i></p>
<p>Call <i>command</i> multiple times, one for each argument found on stdin</p>
<p>ls foo* | xargs cat</p>
<p>Print via </p>
<p>cat</p>
<p> the content of every file whose name starts by &quot;foo&quot;</p>
<p>parallel<i> command</i></p>
<p>Run <i>command</i> in parallel.  </p>
<p>This is used to operate on multiple inputs, similarly to </p>
<p>xargs</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>57/189</b></p>
<p><b>Tests</b></p>
<p><i>Tests</i></p>
<p>test &quot;$MYVAR&quot; <i>operator</i> &quot;<i>value</i>&quot; &amp;&amp; <i>command</i></p>
<p>[ &quot;$MYVAR&quot; <i>operator</i> &quot;<i>value</i>&quot; ] &amp;&amp; <i>command</i></p>
<p>if [ &quot;$MYVAR&quot; <i>operator</i> &quot;<i>value</i>&quot; ]; then <i>command</i>; fi</p>
<p>Perform a test; if it results true, <i>command</i> is executed</p>
<p><b>Test operators</b></p>
<p><b>Integer operators</b></p>
<p><b>File operators</b></p>
<p>-eq <i>value</i></p>
<p>Equal to</p>
<p>-e</p>
<p> or </p>
<p>-a<i> file</i></p>
<p>Exists</p>
<p>-ne <i>value</i></p>
<p>Not equal to</p>
<p>-f<i> file</i></p>
<p>Is a regular file</p>
<p>-lt <i>value</i></p>
<p>Less than</p>
<p>-d<i> file</i></p>
<p>Is a directory</p>
<p>-le <i>value</i></p>
<p>Less than or equal to</p>
<p>-b<i> file</i></p>
<p>Is a block special file</p>
<p>-gt <i>value</i></p>
<p>Greater than</p>
<p>-c<i> file</i></p>
<p>Is a character special file</p>
<p>-ge <i>value</i></p>
<p>Greater than or equal to</p>
<p>-r<i> file</i></p>
<p>Is readable</p>
<p><b>Numeric operators</b></p>
<p>-w<i> file</i></p>
<p>Is writable</p>
<p>= <i>value</i></p>
<p>Equal to</p>
<p>-x<i> file</i></p>
<p>Is executable</p>
<p>!= <i>value</i></p>
<p>Not equal to</p>
<p>-k<i> file</i></p>
<p>Is sticky</p>
<p>&lt; <i>value</i></p>
<p>Less than</p>
<p>-u<i> file</i></p>
<p>Is SUID</p>
<p>&lt;= <i>value</i></p>
<p>Less than or equal to</p>
<p>-g<i> file</i></p>
<p>Is SGID</p>
<p>&gt; <i>value</i></p>
<p>Greater than</p>
<p>-O<i> file</i></p>
<p>Is owned by the Effective UID</p>
<p>&gt;= <i>value</i></p>
<p>Greater than or equal to</p>
<p>-G<i> file</i></p>
<p>Is owned by the Effective GID</p>
<p><b>Expression operators</b></p>
<p>-p<i> file</i></p>
<p>Is a named pipe (aka FIFO)</p>
<p><i>expr1</i> -a <i>expr2</i></p>
<p>Logical AND</p>
<p>-S<i> file</i></p>
<p>Is a socket</p>
<p><i>expr1 </i>-o <i>expr2</i></p>
<p>Logical OR</p>
<p>-h</p>
<p> or </p>
<p>-L<i> file</i></p>
<p>Is a symbolic link</p>
<p>! <i>expr</i></p>
<p>Logical NOT</p>
<p>-s<i> file</i></p>
<p>Is non-zero length</p>
<p>\( <i>expr</i> \)</p>
<p>Priority</p>
<p>-N<i> file</i></p>
<p>Was modified since last read</p>
<p><b>String operators</b></p>
<p><i>file1</i> -nt <i>file2</i></p>
<p>Is newer than</p>
<p>-z</p>
<p>Is zero length</p>
<p><i>file1</i> -ot <i>file2</i></p>
<p>Is older than</p>
<p>-n</p>
<p> or nothing</p>
<p>Is non-zero length</p>
<p><i>file1</i> -ef <i>file2</i></p>
<p>Refer to same device and inode as</p>
<p>=</p>
<p> </p>
<p>or </p>
<p>== <i>string</i></p>
<p>Is equal to</p>
<p>!= <i>string</i></p>
<p>Is not equal to</p>
<p>&lt; <i>string</i></p>
<p>Is alphabetically before</p>
<p>&gt; <i>string</i></p>
<p>Is alphabetically after</p>
<p>substr <i>string</i> <i>pos len</i></p>
<p>Substring</p>
<p>index <i>string</i> <i>chars</i></p>
<p>Index of any chars in string</p>
<p>length <i>string</i></p>
<p>String length</p>
<p><i>string</i> : <i>regex</i></p>
<p><i> </i></p>
<p>or</p>
<p>match <i>string</i> <i>regex</i></p>
<p>String matches regex</p>
<p>expr &quot;$MYVAR&quot; = &quot;39 + 3&quot;</p>
<p>Evaluate an expression (in this case, assigns the value 42 to the variable)</p>
<p>expr <i>string</i> : <i>regex</i></p>
<p>Return the length of the substring matching the regex</p>
<p>expr <i>string</i> : \(<i>regex</i>\)</p>
<p>Return the substring matching the regex</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>58/189</b></p>
<p><b>Operators</b></p>
<p><i>Operators</i></p>
<p><b>Operators</b></p>
<p><b>Mathematical operators</b></p>
<p><b>Logical operators</b></p>
<p>+</p>
<p>Addition</p>
<p>!</p>
<p>Logical negation</p>
<p>-</p>
<p>Subtraction</p>
<p>&amp;&amp;</p>
<p>Logical AND</p>
<p>*</p>
<p>Multiplication</p>
<p>||</p>
<p>Logical OR</p>
<p>/</p>
<p>Division</p>
<p><b>Bitwise operators</b></p>
<p>%</p>
<p>Remainder</p>
<p>~</p>
<p>Bitwise negation</p>
<p>**</p>
<p>Exponentiation</p>
<p>&amp;</p>
<p>Bitwise AND</p>
<p>++</p>
<p>Pre/post increment</p>
<p>|</p>
<p>Bitwise OR</p>
<p>--</p>
<p>Pre/post decrement</p>
<p>^</p>
<p>Bitwise XOR</p>
<p><b>Assignment operators</b></p>
<p>&lt;&lt;</p>
<p>Left bitwise shift</p>
<p>=</p>
<p>Assignment</p>
<p>&gt;&gt;</p>
<p>Right bitwise shift</p>
<p><i>op</i>=</p>
<p>Operation and assignment</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>59/189</b></p>
<p><b>Flow control</b></p>
<p><i>Flow control</i></p>
<p><b>Tests</b></p>
<p>if <i>[test 1]</i></p>
<p>then</p>
<p>   <i>[command block 1]</i></p>
<p>elif <i>[test 2]</i></p>
<p>then</p>
<p>   <i>[command block 2]</i></p>
<p>else</p>
<p>   <i>[command block 3]</i></p>
<p>fi</p>
<p>case $<i>STRING</i> in</p>
<p>   <i>pattern1</i>) </p>
<p><i>      [command block 1]</i></p>
<p>      ;;</p>
<p>   <i>pattern2</i>)</p>
<p><i>      [command block 2]</i></p>
<p>      ;;</p>
<p>   *)</p>
<p><i>      [command block default]</i></p>
<p>      ;;</p>
<p>esac</p>
<p><b>Loops</b></p>
<p>while <i>[test]</i></p>
<p>do</p>
<p>   <i>[command block]</i></p>
<p>done</p>
<p>until <i>[test]</i></p>
<p>do</p>
<p>   <i>[command block]</i></p>
<p>done</p>
<p>for <i>item</i> in <i>[list]</i></p>
<p>do</p>
<p>   <i>[command block]</i></p>
<p>done</p>
<p>The <i>command block</i> executes</p>
<p>as long as <i>test</i> is true</p>
<p>The <i>command block</i> executes</p>
<p>as long as <i>test</i> is false</p>
<p>The <i>command block</i> executes</p>
<p>for each <i>item</i> in <i>list</i></p>
<p>i=0</p>
<p>while [ $i -le 7 ]</p>
<p>do</p>
<p>   echo $i</p>
<p>   let i++</p>
<p>done</p>
<p>i=0</p>
<p>until [ $i -gt 7 ]</p>
<p>do</p>
<p>   echo $i</p>
<p>   let i++</p>
<p>done</p>
<p>for i in 0 1 2 3 4 5 6 7</p>
<p>do</p>
<p>   echo $i</p>
<p>done</p>
<p>for i in {0..7}</p>
<p>do</p>
<p>   echo $i</p>
<p>done</p>
<p>start=0</p>
<p>end=7</p>
<p>for i in $(seq $start $end)</p>
<p>do</p>
<p>   echo $i</p>
<p>done</p>
<p>start=0</p>
<p>end=7</p>
<p>for ((i = start; i &lt;= end; i++))</p>
<p>do</p>
<p>   echo $i</p>
<p>done</p>
<p>break</p>
<p>Exit a loop</p>
<p>continue</p>
<p>Jump to the next iteration</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>60/189</b></p>
<p><b>Text processors</b></p>
<p><i>Text processors</i></p>
<p>vi</p>
<p>Vi, text editor</p>
<p>vim</p>
<p>Vi Improved, an advanced text editor</p>
<p>gvim</p>
<p>Vim with GUI</p>
<p>vimdiff <i>file1 file2</i></p>
<p>Compare two text files in Vim</p>
<p>pico</p>
<p>Pico, simple text editor</p>
<p>nano</p>
<p>Nano, simple text editor (a GNU clone of Pico)</p>
<p>rnano</p>
<p>Restricted version of Nano: does not allow the user access the filesystem (except for files </p>
<p>specified as argument) or a command shell</p>
<p>emacs</p>
<p>GNU Emacs, a GUI text editor</p>
<p>gedit</p>
<p>GUI text editor</p>
<p>ed</p>
<p>Line-oriented text editor</p>
<p>hexedit</p>
<p>Hexadecimal and ASCII editor</p>
<p>more</p>
<p>Text pager (obsolete)</p>
<p>less</p>
<p>Text pager</p>
<p>most</p>
<p>Text pager with advanced features (screen split, binary viewer, etc.)</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>61/189</b></p>
<p><b>less</b></p>
<p><i>less</i></p>
<p>g</p>
<p>Go to the first line in the file</p>
<p><i>n</i>g</p>
<p>Go to line number <i>n</i></p>
<p>G</p>
<p>Go to the last line in the file</p>
<p>F</p>
<p>Go to the end of the file, and move forward automatically as the file grows</p>
<p>Stop moving forward</p>
<p>-N</p>
<p>Show line numbers</p>
<p>-n</p>
<p>Don't show line numbers</p>
<p>=</p>
<p>Show information about the file</p>
<p>Show current and total line number, byte, and percentage of the file read</p>
<p>/<i>pattern</i></p>
<p>Search <i>pattern</i> forward</p>
<p>?<i>pattern</i></p>
<p>Search <i>pattern</i> backwards</p>
<p>&amp;<i>pattern</i></p>
<p>Display only lines matching <i>pattern</i></p>
<p>n</p>
<p>Search next occurrences forward</p>
<p>N</p>
<p>Search next occurrences backwards</p>
<p>:n</p>
<p>When reading multiple files, go to the next file</p>
<p>:p</p>
<p>When reading multiple files, go to the previous file</p>
<p>R</p>
<p>Repaint the screen</p>
<p>V</p>
<p>Show version number</p>
<p>h</p>
<p>Help</p>
<p>q</p>
<p>Quit</p>
<p>less +<i>command</i> <i>file</i></p>
<p>Open <i>file</i> for reading, applying <i>command</i> (see list above)</p>
<p>less +F --follow-name <i>file</i></p>
<p>Move forward, attempting periodically to reopen <i>file</i> by name; useful to keep reading </p>
<p>a logfile that is being rotated.  Note that, by default, </p>
<p>less</p>
<p> continues to read the </p>
<p>original input file even if it has been renamed</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>CTRL</p>
<p>G</p>
<p>CTRL</p>
<p>C</p>
<h1 style="page-break-before:always; "></h1>
<p><b>62/189</b></p>
<p><b>Vi commands</b></p>
<p><i>Vi commands</i></p>
<p>Go to Command mode</p>
<p>i</p>
<p>Insert text before cursor</p>
<p>and go to Insert mode</p>
<p>I</p>
<p>Insert text after line</p>
<p>a</p>
<p>Append text after cursor</p>
<p>A</p>
<p>Append text after line</p>
<p>v</p>
<p>Go to Visual mode, character-wise</p>
<p>then use the arrow keys to select a block of text</p>
<p>V</p>
<p>Go to Visual mode, line-wise</p>
<p>d</p>
<p>Delete selected block</p>
<p>gu</p>
<p>Switch block to lowercase</p>
<p>y</p>
<p>Copy (yank) selected block into buffer</p>
<p>gU</p>
<p>Switch block to uppercase</p>
<p>w</p>
<p>Move to next word</p>
<p>$</p>
<p>Move to end of line</p>
<p>b</p>
<p>Move to beginning of word</p>
<p>1G</p>
<p>Move to line 1 i.e. beginning of file </p>
<p>e</p>
<p>Move to end of word</p>
<p>G</p>
<p>Move to end of file</p>
<p>0</p>
<p>Move to beginning of line</p>
<p>z </p>
<p>Make current line the top line of the screen</p>
<p>Show current line and column number</p>
<p>ma</p>
<p>Mark position &quot;a&quot;.  Marks a-z are local to current file, while marks A-Z are global to a specific file</p>
<p>'a</p>
<p>Go to mark &quot;a&quot;.  If using a global mark, it also opens the specific file</p>
<p>y'a</p>
<p>Copy (yank) from mark &quot;a&quot; to current line, into the buffer </p>
<p>d'a</p>
<p>Delete from mark &quot;a&quot; to current line</p>
<p>p</p>
<p>Paste buffer after current line</p>
<p>yy</p>
<p>Copy current line</p>
<p>P</p>
<p>Paste buffer before current line</p>
<p>yyp</p>
<p>Duplicate current line</p>
<p>x</p>
<p>Delete current character</p>
<p>D</p>
<p>Delete from current character to end of line</p>
<p>X</p>
<p>Delete before current character</p>
<p>dd</p>
<p>Delete current line</p>
<p>7dd</p>
<p>Delete 7 lines.  Almost any command can be prepended by a number to repeat it that number of times</p>
<p>u</p>
<p>Undo last command.  Vi can undo the last command only, Vim is able to undo several commands</p>
<p>.</p>
<p>Repeat last text-changing command</p>
<p>/<i>string</i></p>
<p>Search for <i>string</i> forward</p>
<p>n</p>
<p>Search for next match of <i>string</i></p>
<p>?<i>string</i></p>
<p>Search for <i>string</i> backwards</p>
<p>N</p>
<p>Search for previous match of <i>string</i></p>
<p>:s/<i>s1</i>/<i>s2</i>/</p>
<p>Replace the first occurrence of <i>s1</i> with <i>s2</i> in the current line</p>
<p>:s/<i>s1</i>/<i>s2</i>/g</p>
<p>Replace globally every occurrence of <i>s1</i> with <i>s2</i> in the current line</p>
<p>:%s/<i>s1</i>/<i>s2</i>/g</p>
<p>Replace globally every occurrence of <i>s1</i> with <i>s2</i> in the whole file</p>
<p>:%s/<i>s1</i>/<i>s2</i>/gc</p>
<p>Replace globally every occurrence of <i>s1</i> with <i>s2</i> in the whole file, asking for confirmation</p>
<p>:5,40s/^/#/</p>
<p>Add a hash character at the beginning of each line, from line 5 to 40</p>
<p>!!<i>program</i></p>
<p>Replace line with output from <i>program</i></p>
<p>:r <i>file</i></p>
<p>Read <i>file</i> and insert it after current line </p>
<p>:X</p>
<p>Encrypt current document.  Vi will automatically prompt for the password to encrypt and decrypt</p>
<p>:w <i>file</i></p>
<p>Write to <i>file</i></p>
<p>:wq</p>
<p>:x</p>
<p>ZZ</p>
<p>Save changes and quit</p>
<p>:q</p>
<p>Quit (fails if there are unsaved changes)</p>
<p>:q!</p>
<p>Abandon all changes and quit</p>
<p>vi -R <i>file</i> </p>
<p>Open <i>file</i> in read-only mode</p>
<p>cat <i>file</i> | vi -</p>
<p>Open <i>file</i> in read-only mode (this is done by having Vi read from stdin)</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>ESC</p>
<p>CTRL</p>
<p>G</p>
<p>RETURN</p>
<h1 style="page-break-before:always; "></h1>
<p><b>63/189</b></p>
<p><b>Vi options</b></p>
<p><i>Vi options</i></p>
<p><b>Option</b></p>
<p><b>Effect</b></p>
<p>ai </p>
<p>Turn on auto indentation</p>
<p>all</p>
<p>Display all options</p>
<p>ap</p>
<p>Print a line after the commands </p>
<p>d c J m :s t u</p>
<p>aw</p>
<p>Automatic write on commands </p>
<p>:n ! e# ^^ :rew ^} :tag</p>
<p>bf</p>
<p>Discard control characters from input</p>
<p>dir=<i>tmpdir</i></p>
<p>Set <i>tmpdir</i> as directory for temporary files</p>
<p>eb</p>
<p>Precede error messages with a bell</p>
<p>ht=8</p>
<p>Set terminal tab as 8 spaces</p>
<p>ic</p>
<p>Ignore case when searching</p>
<p>lisp</p>
<p>Modify brackets for Lisp compatibility</p>
<p>list</p>
<p>Show tabs and EOL characters</p>
<p>set listchars=tab:&gt;-</p>
<p>Show tab as </p>
<p>&gt;</p>
<p> for the first char and as </p>
<p>-</p>
<p> for the following chars</p>
<p>magic</p>
<p>Allow pattern matching with special characters</p>
<p>mesg</p>
<p>Enable UNIX terminal messaging</p>
<p>nu</p>
<p>Show line numbers</p>
<p>opt</p>
<p>Speed up output by eliminating automatic Return</p>
<p>para=LIlPLPPPQPbpP</p>
<p>Set macro to start paragraphs for </p>
<p>{ }</p>
<p> operators </p>
<p>prompt</p>
<p>Prompt </p>
<p>:</p>
<p> for command input</p>
<p>re</p>
<p>Simulate smart terminal on dumb terminal</p>
<p>remap</p>
<p>Accept macros within macros</p>
<p>report</p>
<p>Show the largest size of changes on status line</p>
<p>ro</p>
<p>Make file readonly</p>
<p>scroll=12</p>
<p>Set screen size as 12 lines</p>
<p>shell=/bin/bash</p>
<p>Set shell escape to </p>
<p>/bin/bash</p>
<p>showmode</p>
<p>Show current mode on status line</p>
<p>slow</p>
<p>Postpone display updates during inserts</p>
<p>sm</p>
<p>Show matching parentheses when typing</p>
<p>sw=8</p>
<p>Set shift width to 8 characters</p>
<p>tags=/usr/lib/tags</p>
<p>Set path for files checked for tags</p>
<p>term</p>
<p>Print terminal type</p>
<p>terse</p>
<p>Print terse messages</p>
<p>timeout</p>
<p>Eliminate 1-second time limit for macros</p>
<p>tl=3</p>
<p>Set significance of tags beyond 3 characters (0 = all) </p>
<p>ts=8</p>
<p>Set tab stops to 8 for text input</p>
<p>wa</p>
<p>Inhibit normal checks before write commands</p>
<p>warn</p>
<p>Display the warning message &quot;No write since last change&quot;</p>
<p>window=24</p>
<p>Set text window as 24 lines</p>
<p>wm=0</p>
<p>Set automatic wraparound 0 spaces from right margin</p>
<p>:set <i>option     </i></p>
<p>turn on an <i>option</i></p>
<p>:set no<i>option   </i></p>
<p>turn off an <i>option</i></p>
<p>:set <i>option </i>?   </p>
<p>show the current value of <i>option</i></p>
<p>Options can also be permanently set by including them in </p>
<p>~/.exrc</p>
<p> (Vi) or </p>
<p>~/.vimrc</p>
<p> (Vim)</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>64/189</b></p>
<p><b>SQL</b></p>
<p><i>SQL</i></p>
<p>SHOW DATABASES;</p>
<p>Show all existing databases</p>
<p>USE CompanyDatabase;</p>
<p>Select a database to use</p>
<p>SELECT DATABASE();</p>
<p>Show which database is currently selected</p>
<p>DROP DATABASE CompanyDatabase;</p>
<p>Delete a database</p>
<p>SHOW TABLES;</p>
<p>Show all tables from the selected database</p>
<p>CREATE TABLE customers (</p>
<p>cusid INT NOT NULL AUTO_INCREMENT PRIMARY KEY,</p>
<p>firstname VARCHAR(32), lastname VARCHAR(32), dob DATE, </p>
<p>city VARCHAR(24), zipcode VARCHAR(5));</p>
<p>CREATE TABLE payments (</p>
<p>payid INT NOT NULL AUTO_INCREMENT PRIMARY KEY,</p>
<p>date DATE, fee INT, bill VARCHAR(128), cusid INT,</p>
<p>CONSTRAINT FK1 FOREIGN KEY (cusid) REFERENCES customers(cusid)); </p>
<p>Create tables</p>
<p>INSERT INTO customers (firstname,lastname,dob) </p>
<p>VALUES ('Arthur','Dent',1959-08-01), ('Trillian','',1971-03-19);</p>
<p>Insert new records in a table</p>
<p>DELETE FROM customers WHERE firstname LIKE 'Zaphod';</p>
<p>Delete some records in a table</p>
<p>UPDATE customers SET city = 'London' WHERE zipcode = 'L1 42HG';</p>
<p>Modify records in a table</p>
<p>CREATE INDEX lastname_index ON customers(lastname);</p>
<p>ALTER TABLE customers ADD INDEX lastname_index (lastname);</p>
<p>Create an index for faster searches</p>
<p>DESCRIBE customers;</p>
<p>Describe the columns of a table</p>
<p>SHOW CREATE TABLE customers;</p>
<p>Show the code used to create a table</p>
<p>SHOW INDEXES FROM customers;</p>
<p>Show primary key and indexes of a table</p>
<p>DROP TABLE customers;</p>
<p>Delete a table</p>
<p>ALTER TABLE customers MODIFY city VARCHAR(32);</p>
<p>Modify the type of a column</p>
<p>CREATE VIEW cust_view AS</p>
<p>SELECT * FROM customers WHERE city != 'London';</p>
<p>Create a view.  Views are used similarly to </p>
<p>tables </p>
<p>COMMIT;</p>
<p>Commit changes to the database</p>
<p>ROLLBACK;</p>
<p>Rollback the current transaction, canceling </p>
<p>any changes done during it</p>
<p>START TRANSACTION;</p>
<p>BEGIN;</p>
<p>Disable autocommit for this transaction, </p>
<p>until a COMMIT or ROLLBACK is issued </p>
<p>If no database has been selected for use, tables must be referenced by </p>
<p><i>databasename</i>.<i>tablename</i></p>
<p>.</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>65/189</b></p>
<p><b>SQL SELECT</b></p>
<p><i>SQL SELECT</i></p>
<p>SELECT * FROM customers;</p>
<p>Select all columns from the customers </p>
<p>table</p>
<p>SELECT firstname, lastname FROM customers LIMIT 5;</p>
<p>Select first and last name of </p>
<p>customers, showing 5 records only</p>
<p>SELECT firstname, lastname FROM customers LIMIT 1000,5;</p>
<p>SELECT firstname, lastname FROM customers OFFSET 1000 LIMIT 5;</p>
<p>Select first and last name of </p>
<p>customers, skipping the first 1000 </p>
<p>records and showing 5 records only</p>
<p>SELECT firstname, lastname FROM customers WHERE zipcode = 'L1 42HG';</p>
<p>Select first and last name of customers</p>
<p>whose zip code is &quot;L1 42HG&quot;</p>
<p>SELECT firstname, lastname FROM customers WHERE zipcode IS NOT NULL;</p>
<p>Select first and last name of customers</p>
<p>with an existing zip code</p>
<p>SELECT * FROM customers ORDER BY lastname, firstname;</p>
<p>Select customers in alphabetical order </p>
<p>by last name, then first name </p>
<p>SELECT * FROM customers ORDER by zipcode DESC;</p>
<p>Select customers, sorting them by zip </p>
<p>code in reverse order</p>
<p>SELECT firstname, lastname, </p>
<p>TIMESTAMPDIFF(YEAR,dob,CURRENT_DATE) AS age FROM customers;</p>
<p>Select first name, last name, and </p>
<p>calculated age of customers</p>
<p>SELECT DISTINCT city FROM customers;</p>
<p>Show all cities, retrieving each unique </p>
<p>output record only once</p>
<p>SELECT city, COUNT(*) FROM customers GROUP BY city; </p>
<p>Show all cities and the number of </p>
<p>customers in each city.  NULL values </p>
<p>are not counted</p>
<p>SELECT cusid, SUM(fee) FROM payments GROUP BY cusid;</p>
<p>Show all fee payments grouped by </p>
<p>customer ID, summed up</p>
<p>SELECT cusid, AVG(fee) FROM payments GROUP BY cusid</p>
<p>HAVING AVG(fee)&lt;50;</p>
<p>Show the average of fee payments </p>
<p>grouped by customer ID, where this </p>
<p>average is less than 50</p>
<p>SELECT MAX(fee) FROM payments;</p>
<p>Show the highest fee in the table</p>
<p>SELECT COUNT(*) FROM customers; </p>
<p>Show how many rows are in the table</p>
<p>SELECT cusid FROM payments t1 WHERE fee = </p>
<p>(SELECT MAX(t2.fee) FROM payments t2 WHERE t1.cusid=t2.cusid);</p>
<p>Show the customer ID that pays the  </p>
<p>highest fee (via a subquery)</p>
<p>SELECT @maxfee:=MAX(fee) FROM payments;</p>
<p>SELECT cusid FROM payments t1 WHERE fee = @maxfee;</p>
<p>Show the customer ID that pays the  </p>
<p>highest fee (via a user set variable) </p>
<p>SELECT * FROM customers WHERE lastname IN (SELECT lastname</p>
<p>FROM customers GROUP BY lastname HAVING COUNT(lastname) &gt; 1);</p>
<p>Show the customers which have same </p>
<p>last name as other customers</p>
<p>SELECT cusid FROM payments WHERE fee &gt; </p>
<p>ALL (SELECT fee FROM payments WHERE cusid = 4242001;</p>
<p>Show the customer IDs that pay fees </p>
<p>higher than the highest fee paid by </p>
<p>customer ID 4242001</p>
<p>SELECT * FROM customers WHERE firstname LIKE 'Trill%';</p>
<p>Select customers whose first name </p>
<p>matches the expression:</p>
<p>%  </p>
<p>any number of chars, even zero</p>
<p>_  </p>
<p>a single char</p>
<p>SELECT * FROM customers WHERE firstname REGEXP '^Art.*r$';</p>
<p>Select customers whose first name </p>
<p>matches the regex</p>
<p>SELECT firstname, lastname FROM customers WHERE zipcode = 'L1 42HG'</p>
<p>UNION</p>
<p>SELECT firstname, lastname FROM customers WHERE cusid &gt; 4242001;</p>
<p>Select customers that satisfy any of </p>
<p>the two requirements</p>
<p>SELECT firstname, lastname FROM customers WHERE zipcode = 'L1 42HG'</p>
<p>INTERSECT</p>
<p>SELECT firstname, lastname FROM customers WHERE cusid &gt; 4242001;</p>
<p>Select customers that satisfy both of </p>
<p>the two requirements</p>
<p>SELECT firstname, lastname FROM customers WHERE zipcode = 'L1 42HG'</p>
<p>EXCEPT</p>
<p>SELECT firstname, lastname FROM customers WHERE cusid &gt; 4242001;</p>
<p>Select customers that satisfy the first </p>
<p>requirement but not the second</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>66/189</b></p>
<p><b>SQL JOIN</b></p>
<p><i>SQL JOIN</i></p>
<p><b>SQL</b></p>
<p><b>MySQL</b></p>
<p><b>Operation</b></p>
<p>SELECT customers.name, payments.bill </p>
<p>FROM customers, payments </p>
<p>WHERE customers.cusid = payments.cusid;</p>
<p>SELECT customers.name, payments.bill </p>
<p>FROM customers NATURAL JOIN payments;</p>
<p>SELECT customers.name, payments.bill </p>
<p>FROM customers JOIN payments</p>
<p>USING (cusid);</p>
<p>SELECT customers.name, payments.bill </p>
<p>FROM customers JOIN payments </p>
<p>ON customers.cusid = payments.cusid;</p>
<p>SELECT customers.name, payments.bill </p>
<p>FROM customers </p>
<p>[ JOIN | INNER JOIN | CROSS JOIN ] </p>
<p>payments </p>
<p>ON customers.cusid = payments.cusid;</p>
<p>SELECT customers.name, payments.bill </p>
<p>FROM customers </p>
<p>[ JOIN | INNER JOIN | CROSS JOIN ] </p>
<p>payments </p>
<p>USING (cusid);</p>
<p>Perform a <b>join</b> (aka <b>inner </b></p>
<p><b>join</b>) of two tables to select </p>
<p>data that are in a relationship</p>
<p>SELECT customers.name, payments.bill</p>
<p>FROM customers CROSS JOIN payments;</p>
<p>SELECT customers.name, payments.bill </p>
<p>FROM customers JOIN payments;</p>
<p>Perform a <b>cross join</b> (aka </p>
<p><b>Cartesian product</b>) of two </p>
<p>tables</p>
<p>SELECT customers.name, payments.bill </p>
<p>FROM customers LEFT JOIN payments </p>
<p>ON customers.cusid = payments.cusid;</p>
<p>Perform a <b>left join</b> (aka </p>
<p><b>left outer join</b>) of two </p>
<p>tables, returning records </p>
<p>matching the join condition </p>
<p>and also records in the left </p>
<p>table with unmatched values </p>
<p>in the right table</p>
<p>SELECT customers.name, payments.bill </p>
<p>FROM customers RIGHT JOIN payments </p>
<p>ON customers.cusid = payments.cusid;</p>
<p>Perform a <b>right join</b> (aka </p>
<p><b>right outer join</b>) of two </p>
<p>tables, returning records </p>
<p>matching the join condition </p>
<p>and also records in the right </p>
<p>table with unmatched values </p>
<p>in the left table</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>67/189</b></p>
<p><b>MySQL</b></p>
<p><i>MySQL</i></p>
<p>MySQL is the most used open source RDBMS (Relational Database Management System).  It runs on TCP port 3306.</p>
<p>On RHEL 7 and later it is replaced by its fork MariaDB, but the names of the client and of most tools remain unchanged.</p>
<p>mysqld_safe</p>
<p>Start the MySQL server (</p>
<p>mysqld</p>
<p>) with safety features </p>
<p>such as restarting the server if errors occur and </p>
<p>logging runtime information to the error logfile.</p>
<p>This is the recommended command</p>
<p>mysql_install_db  </p>
<p>(deprecated)</p>
<p>mysqld --initialize</p>
<p>Initialize the MySQL data directory, create system </p>
<p>tables, and set up an administrative account.  </p>
<p>To be run just after installing the MySQL server</p>
<p>mysql_secure_installation</p>
<p>Set password for root, remove anonymous users, </p>
<p>disable remote root login, and remove test database.</p>
<p>To be run just after installing the MySQL server</p>
<p>mysql -u root -p</p>
<p>Login to MySQL as root and prompt for the password</p>
<p>mysql -u root -p<i>password</i></p>
<p>Login to MySQL as root with the specified password</p>
<p>mysql -u root -p -h <i>host</i> -P <i>port</i></p>
<p>Login to the specified remote MySQL host and port</p>
<p>mysql -u root -p -eNB'SHOW DATABASES'</p>
<p>Run a SQL command via MySQL.  Flags are:</p>
<p>e  </p>
<p>Run in batch mode  </p>
<p>N  </p>
<p>Do not print table header</p>
<p>B  </p>
<p>Do not print table decoration characters </p>
<p>+-|</p>
<p>mysqldump -u root -p --all-databases &gt; <i>dump.sql</i></p>
<p>Backup all databases to a dump file</p>
<p>mysqldump -u root -p <i>db</i> &gt; <i>dump.sql</i></p>
<p>Backup a database to a dump file</p>
<p>mysqldump -u root -p --databases <i>db1 db2</i> &gt; <i>dump.sql</i></p>
<p>Backup multiple databases to a dump file</p>
<p>mysqldump -u root -p <i>db</i> <i>table1 table2</i> &gt; <i>dump.sql</i></p>
<p>Backup some tables of a database to a dump file</p>
<p>mysql -u root -p &lt; <i>dump.sql</i></p>
<p>Restore all databases from a dump file (which contains</p>
<p>a complete dump of a MySQL server) </p>
<p>mysql -u root -p <i>db</i> &lt; <i>dump.sql</i></p>
<p>Restore a specific database from a dump file (which </p>
<p>contains one database)</p>
<p>mysql_upgrade -u root -p </p>
<p>Check all tables in all databases for incompatibilities </p>
<p>with the current version of MySQL </p>
<p>mysqlcheck</p>
<p>Perform table maintenance.  Each table is locked while</p>
<p>is being processed.  Options are:</p>
<p>--check     </p>
<p>Check table for errors (default)</p>
<p>--analyze   </p>
<p>Analyze table</p>
<p>--optimize  </p>
<p>Optimize table</p>
<p>--repair    </p>
<p>Repair table; can fix almost all problems</p>
<p>            </p>
<p>except unique keys that are not unique</p>
<p>mysqlcheck --check <i>db table</i></p>
<p>Check the specified table of the specified database</p>
<p>mysqlcheck --check --databases <i>db1 db2</i></p>
<p>Check the specified databases</p>
<p>mysqlcheck --check --all-databases</p>
<p>Check all databases</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>68/189</b></p>
<p><b>MySQL tools</b></p>
<p><i>MySQL tools</i></p>
<p>mysqlslap</p>
<p>Tool for MySQL stress tests</p>
<p>mysqltuner.pl</p>
<p>Review the current MySQL installation configuration for performances and stability</p>
<p>mysqlreport  </p>
<p>(obsolete)</p>
<p>Generate a user-friendly report of MySQL status values</p>
<p>mytop</p>
<p>Monitor MySQL processes and queries</p>
<p>innotop</p>
<p>Monitor MySQL InnoDB transactions</p>
<p>dbs=&quot;$(mysql -uroot -p<i>password</i> -Bse'SHOW DATABASES;')&quot;</p>
<p>for db in $dbs </p>
<p>do </p>
<p>   <i>[operation on $db]</i></p>
<p>done </p>
<p>Perform an operation on each database name</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>69/189</b></p>
<p><b>MySQL syntax</b></p>
<p><i>MySQL syntax</i></p>
<p>SELECT Host, User FROM mysql.user;</p>
<p>List all MySQL users</p>
<p>CREATE USER '<i>user</i>'@'localhost' IDENTIFIED BY 'p4ssw0rd';</p>
<p>Create a MySQL local user and set his </p>
<p>password</p>
<p>DROP USER '<i>user</i>'@'localhost';</p>
<p>Delete a MySQL user</p>
<p>SET PASSWORD FOR '<i>user</i>'@'localhost' = PASSWORD('p4ssw0rd');</p>
<p>SET PASSWORD FOR '<i>user</i>'@'localhost' = '*7E684A3DF6273CD1B6DE53';</p>
<p>Set a password for a MySQL user.</p>
<p>The password can be specified either in </p>
<p>plaintext or by its hash value</p>
<p>SHOW GRANTS FOR '<i>user</i>'@'localhost';</p>
<p>Show permissions for a user</p>
<p>GRANT ALL PRIVILEGES ON <i>database</i>.* TO '<i>user</i>'@'localhost';</p>
<p>Grant permissions to a user</p>
<p>REVOKE ALL PRIVILEGES ON <i>database</i>.* FROM '<i>user</i>'@'localhost';</p>
<p>Revoke permissions from a user; must </p>
<p>match the already granted permission on </p>
<p>the same database or table</p>
<p>GRANT SELECT ON *.* TO 'john'@'localhost' IDENTIFIED BY 'p4ssw0rd';</p>
<p>GRANT SELECT ON *.* TO 'john'@'localhost' IDENTIFIED BY PASSWORD </p>
<p>'*7E684A3DF6273CD1B6DE53';</p>
<p>Create a MySQL user and set his grants at</p>
<p>the same time</p>
<p>FLUSH PRIVILEGES;</p>
<p>Reload and commit the grant tables; must</p>
<p>be run after any GRANT command</p>
<p>SELECT * INTO OUTFILE '<i>file.csv</i>'</p>
<p>FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '&quot;'</p>
<p>LINES TERMINATED BY '\n' FROM <i>database</i>.<i>table</i>;</p>
<p>Export a table to a CSV file</p>
<p>USE <i>database</i>; SOURCE <i>dump.sql</i>;</p>
<p>Restore a database from a dump file</p>
<p>USE <i>database</i>; LOAD DATA LOCAL INFILE '<i>file</i>' INTO TABLE <i>table</i>;</p>
<p>Populate a table with data from a file (one</p>
<p>record per line, values separated by tabs)</p>
<p>DO SLEEP(<i>n</i>);</p>
<p>SELECT SLEEP(<i>n</i>);</p>
<p>Sleep for <i>n</i> seconds</p>
<p>SET PROFILING=1;</p>
<p>Enable profiling</p>
<p>SHOW PROFILE;</p>
<p>Show the profile of the last executed </p>
<p>query, with detailed steps and their timing</p>
<p><i>statement</i>;</p>
<p><i>statement</i>\g</p>
<p>Send an SQL statement to the server</p>
<p><i>statement</i>\G</p>
<p>Display result in vertical format, showing </p>
<p>each record in multiple rows</p>
<p>SELECT /*!99999 <i>comment</i>*/ * FROM <i>database</i>.<i>table</i>;</p>
<p>Insert a comment</p>
<p>SELECT /*!<i>v</i> <i>statement</i>*/ * FROM <i>database</i>.<i>table</i>;</p>
<p>The commented <i>statement</i> is executed </p>
<p>only if MySQL is version <i>v</i> or higher</p>
<p>\c</p>
<p>Cancel current input</p>
<p>\! <i>command</i></p>
<p>Run a shell command</p>
<p>TEE <i>logfile</i></p>
<p>Log all I/O of the current MySQL session </p>
<p>to the specified logfile</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>70/189</b></p>
<p><b>MySQL status</b></p>
<p><i>MySQL status</i></p>
<p>SHOW VARIABLES;</p>
<p>SHOW SESSION VARIABLES;</p>
<p>SHOW LOCAL VARIABLES;</p>
<p>Print session variables (affecting current connection only)</p>
<p>SHOW GLOBAL VARIABLES;</p>
<p>Print global variables (affecting global operations on the server)</p>
<p>SHOW VARIABLES LIKE '%query%';</p>
<p>Print session variables that match the given pattern</p>
<p>SHOW VARIABLES LIKE 'hostname';</p>
<p>SELECT @@hostname;</p>
<p>Print a session variable with the given name</p>
<p>SET sort_buffer_size=10000;</p>
<p>SET SESSION sort_buffer_size=10000;</p>
<p>SET LOCAL sort_buffer_size=10000;</p>
<p>SET @@sort_buffer_size=10000;</p>
<p>SET @@session.sort_buffer_size=10000;</p>
<p>SET @@local.sort_buffer_size=10000;</p>
<p>Set a session variable</p>
<p>SET GLOBAL sort_buffer_size=10000;</p>
<p>SET @@global.sort_buffer_size=10000;</p>
<p>Set a global variable</p>
<p>SHOW STATUS;</p>
<p>SHOW SESSION STATUS;</p>
<p>SHOW LOCAL STATUS;</p>
<p>Print session status (concerning current connection only)</p>
<p>SHOW GLOBAL STATUS;</p>
<p>Print global status (concerning global operations on the server)</p>
<p>SHOW STATUS LIKE '%wsrep%';</p>
<p>Print session status values that match the given pattern</p>
<p>SHOW WARNINGS;</p>
<p>Print warnings, errors and notes resulting from the most recent </p>
<p>statement in the current session that generated messages</p>
<p>SHOW ERRORS;</p>
<p>Print errors resulting from the most recent statement in the </p>
<p>current session that generated messages</p>
<p>SHOW TABLE STATUS;</p>
<p>Print information about all tables of the current database e.g. </p>
<p>engine (InnoDB or MyISAM), rows, indexes, data length</p>
<p>SHOW ENGINE INNODB STATUS;</p>
<p>Print statistics concerning the InnoDB engine</p>
<p>SELECT * FROM information_schema.processlist;</p>
<p>SHOW FULL PROCESSLIST;</p>
<p>Print the list of threads running in your local session; if run as </p>
<p>root, print the list of threads running on the system</p>
<p>SELECT * FROM information_schema.processlist </p>
<p>WHERE user='<i>you</i>'; </p>
<p>Print the list of threads running in your local session and all your </p>
<p>other logged-in sessions</p>
<p>SHOW CREATE TABLE <i>table</i>;</p>
<p>SHOW CREATE VIEW <i>view</i>;</p>
<p>Print the CREATE statement that created <i>table</i> or <i>view</i></p>
<p>SELECT VERSION();</p>
<p>Print the version of the MySQL server</p>
<p>SELECT CURDATE();</p>
<p>SELECT CURRENT_DATE;</p>
<p>Print the current date</p>
<p>SELECT CURTIME();</p>
<p>SELECT CURRENT_TIME;</p>
<p>Print the current time</p>
<p>SELECT NOW();</p>
<p>Print the current date and time</p>
<p>SELECT USER();</p>
<p>Print the current user@hostname that is logged in</p>
<p>\s</p>
<p>Print status information about server and current connection</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>71/189</b></p>
<p><b>MySQL recipes</b></p>
<p><i>MySQL recipes</i></p>
<p>SELECT table_schema AS &quot;Name&quot;, </p>
<p>SUM(data_length+index_length)/1024/1024 AS &quot;Size in Mb&quot;</p>
<p>FROM information_schema.tables GROUP BY table_schema;</p>
<p>Display the sizes of all databases in the </p>
<p>system (counting data + indexes)</p>
<p>SELECT table_schema AS &quot;Name&quot;, </p>
<p>SUM(data_length+index_length)/1024/1024 AS &quot;Size in Mb&quot;</p>
<p>FROM information_schema.tables WHERE table_schema='<i>database</i>';</p>
<p>Display the size of <i>database</i> </p>
<p>SELECT table_name AS &quot;Name&quot;,  </p>
<p>ROUND(((data_length)/1024/1024),2) AS &quot;Data size in Mb&quot;,</p>
<p>ROUND(((index_length)/1024/1024),2) AS &quot;Index size in Mb&quot;</p>
<p>FROM information_schema.TABLES WHERE table_schema='<i>database</i>'  </p>
<p>ORDER BY table_name;</p>
<p>Display data and index size of all tables of </p>
<p><i>database</i></p>
<p>SELECT table_name, table_rows </p>
<p>FROM information_schema.tables WHERE table_schema='<i>database</i>';</p>
<p>Print an estimate of the number of rows of </p>
<p>each table of <i>database</i> </p>
<p>SELECT SUM(data_length+index_length)/1024/1024 AS &quot;InnoDB Mb&quot;</p>
<p>FROM information_schema.tables WHERE engine='InnoDB';</p>
<p>Display the amount of InnoDB data in all </p>
<p>databases</p>
<p>SELECT table_name, engine </p>
<p>FROM information_schema.tables WHERE table_schema = '<i>database</i>';</p>
<p>Print name and engine of all tables in </p>
<p><i>database</i></p>
<p>SELECT CONCAT('KILL ',id,';') </p>
<p>FROM information_schema.processlist WHERE user='<i>user</i>'</p>
<p>INTO OUTFILE '/tmp/killuser'; SOURCE /tmp/killuser;</p>
<p>Kill all connections belonging to <i>user</i></p>
<p>SELECT COUNT(1) SlaveThreadCount </p>
<p>FROM information_schema.processlist WHERE user='system user';</p>
<p>Distinguish between master and slave server;</p>
<p>returns 0 on a master, &gt;0 on a slave</p>
<p>SELECT ROUND(SUM(CHAR_LENGTH(<i>field</i>)&lt;40)*100/COUNT(*),2) </p>
<p>FROM <i>table</i>;</p>
<p>Display the percentage of rows on which the </p>
<p>string <i>field </i>is shorter than 40 chars</p>
<p>SELECT CHAR_LENGTH(<i>field</i>) AS Length, COUNT(*) AS Occurrences</p>
<p>FROM <i>table</i> GROUP BY CHAR_LENGTH(<i>field</i>);</p>
<p>Display all different lengths of string <i>field</i> and</p>
<p>the number of times they occur</p>
<p>SELECT MAX(CHAR_LENGTH(<i>field</i>)) FROM <i>table</i>;</p>
<p>Display the longest string stored in <i>field</i></p>
<p>SHOW FULL TABLES IN <i>database</i> WHERE table_type LIKE 'VIEW';</p>
<p>Display the list of views in <i>database</i></p>
<p>SELECT &quot;Table 1&quot; AS `set`, t1.* FROM <i>table1</i> t1 WHERE </p>
<p>ROW(t1.<i>col1</i>, t1.<i>col2</i>, t1.<i>col3</i>) NOT IN (SELECT * FROM <i>table2</i>)</p>
<p>UNION ALL</p>
<p>SELECT &quot;Table 2&quot; AS `set`, t2.* FROM <i>table2</i> t2 WHERE</p>
<p>ROW(t2.<i>col1</i>, t2.<i>col2</i>, t2.<i>col3</i>) NOT IN (SELECT * FROM <i>table1</i>)</p>
<p>Display the differences between the contents </p>
<p>of two tables <i>table1</i> and <i>table2</i> (assuming the</p>
<p>tables are composed of 3 columns each)</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>72/189</b></p>
<p><b>MySQL operations</b></p>
<p><i>MySQL operations</i></p>
<p><b>How to resync a master-slave replication</b></p>
<p>1.</p>
<p>On the master, on terminal 1:</p>
<p>mysql -uroot -p</p>
<p>RESET MASTER;</p>
<p>FLUSH TABLES WITH READ LOCK;</p>
<p>SHOW MASTER STATUS;</p>
<p>Note the values of MASTER_LOG_FILE and MASTER_LOG_POS; these values will need</p>
<p>to be copied on the slave</p>
<p>2.</p>
<p>On the master, on terminal 2:</p>
<p>mysqldump -uroot -p --all-databases &gt; <i>/path/to/dump.sql</i></p>
<p>It is not necessary to wait until the dump completes</p>
<p>3.</p>
<p>On the master, on terminal 1:</p>
<p>UNLOCK TABLES;</p>
<p>4.</p>
<p>Transfer the dump file from</p>
<p>the master to the slave</p>
<p>5.</p>
<p>On the slave:</p>
<p>mysql -uroot -p</p>
<p>STOP SLAVE;</p>
<p>SOURCE <i>/path/to/dump.sql</i>;</p>
<p>RESET SLAVE;</p>
<p>CHANGE MASTER TO MASTER_LOG_FILE='mysql-bin.<i>nnnnnn</i>', MASTER_LOG_POS=<i>mm</i>;</p>
<p>START SLAVE;</p>
<p>SHOW SLAVE STATUS;</p>
<p><b>How to recover the MySQL root password</b></p>
<p>1.</p>
<p>Stop the MySQL server</p>
<p>2.</p>
<p>Restart the MySQL server </p>
<p>skipping the grant tables</p>
<p>mysqld_safe --skip-grant-tables --skip-networking &amp; </p>
<p>3. </p>
<p>Connect to the MySQL server </p>
<p>passwordlessly</p>
<p>mysql -uroot</p>
<p>4.</p>
<p>Reload the grant tables</p>
<p>FLUSH PRIVILEGES;</p>
<p>5.</p>
<p>Change the root password</p>
<p>SET PASSWORD FOR 'root'@'localhost' = PASSWORD('<i>newpassword</i>');</p>
<p>6.</p>
<p>Stop the MySQL server and</p>
<p>restart it normally</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>73/189</b></p>
<p><b>PostgreSQL</b></p>
<p><i>PostgreSQL</i></p>
<p>PostgreSQL (aka Postgres) is an open source object-relational database.  By default it listens for connections on TCP port </p>
<p>5432.</p>
<p>\list</p>
<p>\l</p>
<p>List all databases</p>
<p>\list+</p>
<p>\l+</p>
<p>List all databases, displaying database size and description</p>
<p>\connect <i>database</i></p>
<p>\c <i>database</i></p>
<p>Connect to <i>database</i></p>
<p>\q</p>
<p>Quit</p>
<p><b>How to set up PostgreSQL with a <i>database</i> owned by <i>user</b></i></p>
<p>1.</p>
<p>Set up PostgreSQL</p>
<p>postgresql-setup initdb</p>
<p>2.</p>
<p>Change the password of the </p>
<p>postgres shell user</p>
<p>passwd postgres</p>
<p>3</p>
<p>Create the <i>user </i>shell user</p>
<p>useradd <i>user</i></p>
<p>4.</p>
<p>Switch to the postgres shell user </p>
<p>and connect to PostgreSQL</p>
<p>su - postgres</p>
<p>psql -U postgres</p>
<p>5.</p>
<p>In PostgreSQL, create the <i>user</i> </p>
<p>CREATE ROLE <i>user</i> WITH LOGIN;</p>
<p>\password <i>user</i></p>
<p>\q</p>
<p>6.</p>
<p>Create a <i>database</i> owned by <i>user</i></p>
<p>createdb -E utf8 -l C -T template0 <i>database</i> -O <i>user</i></p>
<p>7.</p>
<p>Switch to the postgres shell user </p>
<p>and connect to PostgreSQL</p>
<p>su - postgres</p>
<p>psql -U postgres</p>
<p>8.</p>
<p>In PostgreSQL, grant the necessary </p>
<p>privileges on <i>database</i> to <i>user</i></p>
<p>GRANT ALL PRIVILEGES ON DATABASE <i>database</i> TO <i>user</i>;</p>
<p>\q</p>
<p>9.</p>
<p>Verify that <i>user</i> can login to </p>
<p>PostgreSQL</p>
<p>su - <i>user</i></p>
<p>psql -U <i>user</i> -W</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>74/189</b></p>
<p><b>X</b></p>
<p><i>X</i></p>
<p>The <b>X Window System</b> (aka <b>X11</b> or <b>X</b>) is a windowing system for Linux and UNIX-like OSes, providing a basic framework </p>
<p>for GUI applications via a client-server model.  A <b>display manager</b> provides a login screen to enter an X session and </p>
<p>introduces the user to the <b>desktop environment</b> (e.g. GNOME, KDE, CDE, Enlightenment).</p>
<p><b>Display Manager</b></p>
<p><b>Configuration files</b></p>
<p><b>Display Manager greeting screen</b></p>
<p>xdm</p>
<p>X</p>
<p>Display</p>
<p>Manager</p>
<p>/etc/x11/xdm/Xaccess</p>
<p>Control inbound requests from </p>
<p>remote hosts</p>
<p>Defined in </p>
<p>/etc/x11/xdm/Xresources</p>
<p>by the line:</p>
<p>xlogin*greeting: \ </p>
<p> </p>
<p>Debian GNU/Linux (CLIENTHOST)</p>
<p>/etc/x11/xdm/Xresources</p>
<p>Configuration settings for X </p>
<p>applications and the login screen</p>
<p>/etc/x11/xdm/Xservers</p>
<p>Association of X displays with </p>
<p>local X server software, or with X</p>
<p>terminals via XDMCP</p>
<p>/etc/x11/xdm/Xsession</p>
<p>Script launched by xdm after </p>
<p>login</p>
<p>/etc/x11/xdm/Xsetup_0</p>
<p>Script launched before the </p>
<p>graphical login screen</p>
<p>/etc/x11/xdm/xdm-config</p>
<p>Association of all xdm </p>
<p>configuration files</p>
<p>gdm</p>
<p>GNOME</p>
<p>Display</p>
<p>Manager</p>
<p>/etc/gdm/gdm.conf </p>
<p>or</p>
<p> /etc/gdm/custom.conf</p>
<p>Configured via </p>
<p>gdmsetup</p>
<p>kdm</p>
<p>KDE</p>
<p>Display</p>
<p>Manager</p>
<p>/etc/kde/kdm/kdmrc</p>
<p>Configured via </p>
<p>kdm_config</p>
<p>/etc/init.d/xdm start</p>
<p>/etc/init.d/gdm start</p>
<p>/etc/init.d/kdm start</p>
<p>Start the appropriate Display Manager</p>
<p>xorgconfig       </p>
<p>(Debian)</p>
<p>Xorg -configure  </p>
<p>(Red Hat)</p>
<p>Configure X (text mode)   </p>
<p>xorgcfg                </p>
<p>(Debian)</p>
<p>system-config-display  </p>
<p>(Red Hat)</p>
<p>Configure X (graphical mode)  </p>
<p>X -version</p>
<p>Show which version of X is running</p>
<p>xdpyinfo</p>
<p>Display information about the X server</p>
<p>xwininfo</p>
<p>Display information about windows</p>
<p>xhost + 10.3.3.3</p>
<p>xhost - 10.3.3.3</p>
<p>Add or remove 10.3.3.3 to the list of hosts allowed to make X connections to </p>
<p>the local machine</p>
<p>switchdesk gde</p>
<p>Switch to the GDE Display Manager at runtime</p>
<p>gnome-shell --version</p>
<p>Show which version of GNOME is running</p>
<p>/etc/X11/xorg.conf</p>
<p>Configuration file for X</p>
<p>~/.Xresources</p>
<p>Configuration settings for X applications, in the form</p>
<p><i>program</i>*<i>resource</i>: <i>value</i></p>
<p>$DISPLAY</p>
<p>Environment variable defining the display name of the X server, in the form </p>
<p><i>hostname</i>:<i>displaynumber</i>.<i>screennumber</i></p>
<p>The following line in </p>
<p>/etc/inittab</p>
<p> instructs </p>
<p>init</p>
<p> to launch XDM at runlevel 5:</p>
<p>x:5:respawn:/usr/X11R6/bin/xdm -nodaemon</p>
<p>The following lines in </p>
<p>/etc/sysconfig/desktop</p>
<p> define GNOME as the default Display Environment and Display Manager:</p>
<p>desktop=&quot;gde&quot;</p>
<p>displaymanager=&quot;gdm&quot;</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>75/189</b></p>
<p><b>X tools</b></p>
<p><i>X tools</i></p>
<p>xdotool</p>
<p>X automation tool</p>
<p>xdotool getwindowfocus</p>
<p>Get the ID of the currently focused window (if run in command line, it is </p>
<p>the terminal where this command is typed)</p>
<p>xdotool selectwindow</p>
<p>Pop up an X cursor and get the ID of the window selected by it</p>
<p>xdotool key --window 12345678 Return</p>
<p>Simulate a                 keystroke inside window ID 12345678</p>
<p>xprop</p>
<p>X property displayer.  Pops up a cursor to select a window</p>
<p>xprop | grep WM_CLASS</p>
<p>Get process name and GUI application name of the selected window</p>
<p>xrandr</p>
<p>xrandr -q</p>
<p>Show screen(s) size and resolution</p>
<p>xrandr --output eDP1 --right-of VGA1</p>
<p>Extend the screen on an additional VGA physical screen situated to the left</p>
<p>xsel</p>
<p>Manipulate the X selection (primary, secondary, and clipboard)</p>
<p>xsel -b &lt; <i>file</i></p>
<p>Copy the contents of a file to the X clipboard</p>
<p>xsel -b -a &lt; <i>file</i></p>
<p>Append the contents of a file to the X clipboard</p>
<p>xsel -b -o</p>
<p>Output onscreen the contents of the X clipboard</p>
<p>cat <i>file</i> | xclip -i</p>
<p>Copy the contents of a file to the X clipboard</p>
<p>mkfontdir</p>
<p>Catalog the newly installed fonts in the new directory</p>
<p>xset fp+ /usr/local/fonts</p>
<p>Dynamically add new installed fonts in </p>
<p>/usr/local/fonts</p>
<p> to the X server</p>
<p>xfs</p>
<p>Start the X font server</p>
<p>fc-cache</p>
<p>Install fonts and build font information cache</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>RETURN</p>
<h1 style="page-break-before:always; "></h1>
<p><b>76/189</b></p>
<p><b>X keysim codes</b></p>
<p><i>X keysim codes</i></p>
<p><b>Main</b></p>
<p><b>Latin 1</b></p>
<p><b>Latin 2</b></p>
<p>BackSpace      ff08</p>
<p>Tab            ff09</p>
<p>Linefeed       ff0a</p>
<p>Clear          ff0b</p>
<p>Return         ff0d</p>
<p>Pause          ff13</p>
<p>Scroll_Lock    ff14</p>
<p>Sys_Req        ff15</p>
<p>Escape         ff1b</p>
<p>Delete         ffff</p>
<p>space          0020  </p>
<p>exclam         0021  </p>
<p>quotedbl       0022  </p>
<p>numbersign     0023  </p>
<p>dollar         0024  </p>
<p>percent        0025  </p>
<p>ampersand      0026  </p>
<p>apostrophe     0027  </p>
<p>quoteright     0027  </p>
<p>parenleft      0028  </p>
<p>parenright     0029  </p>
<p>asterisk       002a  </p>
<p>plus           002b  </p>
<p>comma          002c  </p>
<p>minus          002d  </p>
<p>period         002e  </p>
<p>slash          002f  </p>
<p>0 - 9          0030 - 0039  </p>
<p>colon          003a  </p>
<p>semicolon      003b  </p>
<p>less           003c  </p>
<p>equal          003d  </p>
<p>greater        003e  </p>
<p>question       003f  </p>
<p>at             0040  </p>
<p>A - Z          0041 - 005a  </p>
<p>bracketleft    005b  </p>
<p>backslash      005c  </p>
<p>bracketright   005d  </p>
<p>asciicircum    005e  </p>
<p>underscore     005f  </p>
<p>grave          0060  </p>
<p>quoteleft      0060  </p>
<p>a - z          0061 - 007a  </p>
<p>braceleft      007b  </p>
<p>bar            007c  </p>
<p>braceright     007d  </p>
<p>asciitilde     007e  </p>
<p>nobreakspace   00a0  </p>
<p>exclamdown     00a1  </p>
<p>cent           00a2  </p>
<p>sterling       00a3  </p>
<p>currency       00a4  </p>
<p>yen            00a5  </p>
<p>brokenbar      00a6  </p>
<p>section        00a7  </p>
<p>diaeresis      00a8  </p>
<p>copyright      00a9  </p>
<p>ordfeminine    00aa  </p>
<p>guillemotleft  00ab  </p>
<p>notsign        00ac  </p>
<p>hyphen         00ad  </p>
<p>registered     00ae  </p>
<p>macron         00af  </p>
<p>degree         00b0  </p>
<p>plusminus      00b1  </p>
<p>twosuperior    00b2  </p>
<p>threesuperior  00b3  </p>
<p>acute          00b4  </p>
<p>mu             00b5  </p>
<p>paragraph      00b6  </p>
<p>periodcentered 00b7  </p>
<p>cedilla        00b8  </p>
<p>onesuperior    00b9  </p>
<p>masculine      00ba  </p>
<p>guillemotright 00bb  </p>
<p>onequarter     00bc  </p>
<p>onehalf        00bd  </p>
<p>threequarters  00be</p>
<p>questiondown   00bf</p>
<p>Agrave         00c0  </p>
<p>Aacute         00c1  </p>
<p>Acircumflex    00c2  </p>
<p>Atilde         00c3  </p>
<p>Adiaeresis     00c4  </p>
<p>Aring          00c5  </p>
<p>AE             00c6  </p>
<p>Ccedilla       00c7  </p>
<p>Egrave         00c8  </p>
<p>Eacute         00c9  </p>
<p>Ecircumflex    00ca  </p>
<p>Ediaeresis     00cb  </p>
<p>Igrave         00cc  </p>
<p>Iacute         00cd  </p>
<p>Icircumflex    00ce  </p>
<p>Idiaeresis     00cf  </p>
<p>ETH            00d0  </p>
<p>Eth            00d0  </p>
<p>Ntilde         00d1  </p>
<p>Ograve         00d2  </p>
<p>Oacute         00d3  </p>
<p>Ocircumflex    00d4  </p>
<p>Otilde         00d5  </p>
<p>Odiaeresis     00d6  </p>
<p>multiply       00d7  </p>
<p>Oslash         00d8  </p>
<p>Ooblique       00d8  </p>
<p>Ugrave         00d9  </p>
<p>Uacute         00da  </p>
<p>Ucircumflex    00db  </p>
<p>Udiaeresis     00dc  </p>
<p>Yacute         00dd  </p>
<p>THORN          00de  </p>
<p>Thorn          00de  </p>
<p>ssharp         00df  </p>
<p>agrave         00e0  </p>
<p>aacute         00e1  </p>
<p>acircumflex    00e2  </p>
<p>atilde         00e3  </p>
<p>adiaeresis     00e4  </p>
<p>aring          00e5  </p>
<p>ae             00e6  </p>
<p>ccedilla       00e7  </p>
<p>egrave         00e8  </p>
<p>eacute         00e9  </p>
<p>ecircumflex    00ea  </p>
<p>ediaeresis     00eb  </p>
<p>igrave         00ec  </p>
<p>iacute         00ed  </p>
<p>icircumflex    00ee  </p>
<p>idiaeresis     00ef  </p>
<p>eth            00f0  </p>
<p>ntilde         00f1  </p>
<p>ograve         00f2  </p>
<p>oacute         00f3  </p>
<p>ocircumflex    00f4  </p>
<p>otilde         00f5  </p>
<p>odiaeresis     00f6  </p>
<p>division       00f7  </p>
<p>oslash         00f8  </p>
<p>ooblique       00f8  </p>
<p>ugrave         00f9  </p>
<p>uacute         00fa  </p>
<p>ucircumflex    00fb  </p>
<p>udiaeresis     00fc  </p>
<p>yacute         00fd  </p>
<p>thorn          00fe  </p>
<p>ydiaeresis     00ff </p>
<p>Aogonek        01a1  </p>
<p>breve          01a2  </p>
<p>Lstroke        01a3  </p>
<p>Lcaron         01a5  </p>
<p>Sacute         01a6  </p>
<p>Scaron         01a9  </p>
<p>Scedilla       01aa  </p>
<p>Tcaron         01ab  </p>
<p>Zacute         01ac  </p>
<p>Zcaron         01ae  </p>
<p>Zabovedot      01af  </p>
<p>aogonek        01b1  </p>
<p>ogonek         01b2  </p>
<p>lstroke        01b3  </p>
<p>lcaron         01b5  </p>
<p>sacute         01b6  </p>
<p>caron          01b7  </p>
<p>scaron         01b9  </p>
<p>scedilla       01ba  </p>
<p>tcaron         01bb  </p>
<p>zacute         01bc  </p>
<p>doubleacute    01bd  </p>
<p>zcaron         01be  </p>
<p>zabovedot      01bf  </p>
<p>Racute         01c0  </p>
<p>Abreve         01c3  </p>
<p>Lacute         01c5  </p>
<p>Cacute         01c6  </p>
<p>Ccaron         01c8  </p>
<p>Eogonek        01ca  </p>
<p>Ecaron         01cc  </p>
<p>Dcaron         01cf  </p>
<p>Dstroke        01d0  </p>
<p>Nacute         01d1  </p>
<p>Ncaron         01d2  </p>
<p>Odoubleacute   01d5  </p>
<p>Rcaron         01d8  </p>
<p>Uring          01d9  </p>
<p>Udoubleacute   01db  </p>
<p>Tcedilla       01de  </p>
<p>racute         01e0  </p>
<p>abreve         01e3  </p>
<p>lacute         01e5  </p>
<p>cacute         01e6  </p>
<p>ccaron         01e8  </p>
<p>eogonek        01ea  </p>
<p>ecaron         01ec  </p>
<p>dcaron         01ef  </p>
<p>dstroke        01f0  </p>
<p>nacute         01f1  </p>
<p>ncaron         01f2  </p>
<p>odoubleacute   01f5  </p>
<p>rcaron         01f8  </p>
<p>uring          01f9  </p>
<p>udoubleacute   01fb  </p>
<p>tcedilla       01fe  </p>
<p>abovedot       01ff  </p>
<p><b>Cursor control</b></p>
<p>Home           ff50</p>
<p>Left           ff51</p>
<p>Up             ff52</p>
<p>Right          ff53</p>
<p>Down           ff54</p>
<p>Prior          ff55</p>
<p>Page_Up        ff55</p>
<p>Next           ff56</p>
<p>Page_Down      ff56</p>
<p>End            ff57</p>
<p>Begin          ff58</p>
<p><b>Misc functions</b></p>
<p>Select         ff60</p>
<p>Print          ff61</p>
<p>Execute        ff62</p>
<p>Insert         ff63</p>
<p>Undo           ff65</p>
<p>Redo           ff66</p>
<p>Menu           ff67</p>
<p>Find           ff68</p>
<p>Cancel         ff69</p>
<p>Help           ff6a</p>
<p>Break          ff6b</p>
<p>Mode_switch    ff7e</p>
<p>script_switch  ff7e</p>
<p>Num_Lock       ff7f</p>
<p><b>Modifiers</b></p>
<p>Shift_L        ffe1  </p>
<p>Shift_R        ffe2  </p>
<p>Control_L      ffe3  </p>
<p>Control_R      ffe4  </p>
<p>Caps_Lock      ffe5  </p>
<p>Shift_Lock     ffe6  </p>
<p>Meta_L         ffe7  </p>
<p>Meta_R         ffe8  </p>
<p>Alt_L          ffe9  </p>
<p>Alt_R          ffea  </p>
<p>Super_L        ffeb  </p>
<p>Super_R        ffec  </p>
<p>Hyper_L        ffed  </p>
<p>Hyper_R        ffee </p>
<p>This table is derived from </p>
<p>keysymdef.h</p>
<p> which defines keysym codes (i.e. characters or functions associated with each key in</p>
<p>the X Window System) as </p>
<p>XK_<i>key</i></p>
<p> and its hex value.  The <i>key</i> can be passed as argument to the </p>
<p>xdotool key</p>
<p> command.</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>77/189</b></p>
<p><b>/etc/passwd</b></p>
<p><i>/etc/passwd</i></p>
<p><b>/etc/passwd</b></p>
<p><b>     User accounts</b></p>
<p>root:x:0:0:/root:/bin/bash</p>
<p>bin:x:1:1:/bin:/bin/bash</p>
<p>jdoe:x:500:100:John Doe,,555-1234,,:/home/jdoe:/bin/bash</p>
<p><b>1           2    3        4         5                                                     6                           7</b></p>
<p><b>1</b></p>
<p>Login name</p>
<p><b>2</b></p>
<p>Hashed password (obsolete), or </p>
<p>x</p>
<p> if password is in </p>
<p>/etc/shadow</p>
<p><b>3</b></p>
<p>UID – User ID</p>
<p><b>4</b></p>
<p>GID – Default Group ID</p>
<p><b>5</b></p>
<p>GECOS field – Information about the user: Full name, Room number, Work phone, Home phone, Other</p>
<p><b>6</b></p>
<p>Home directory of the user</p>
<p><b>7</b></p>
<p>Login shell (if set to </p>
<p>/sbin/nologin</p>
<p> or </p>
<p>/bin/false</p>
<p>, user will be unable to log in)</p>
<p><b>/etc/shadow</b></p>
<p><b>     User passwords</b></p>
<p>root:$6$qk8JmJHf$X9GfOZ/i9LZP4Kldu6.D3cx2pXA:15537:0:99999:7:::</p>
<p>bin:*:15637:0:99999:7:::</p>
<p>jdoe:!$6$YOiH1otQ$KxeeUKHExK8e3jCUdw9Rxy3Wu53:15580:0:99999:7::15766:</p>
<p><b>1           2    a   b                      c                                                                        3             4    5             6  7  8             9</b></p>
<p><b>1</b></p>
<p>Login name</p>
<p><b>2</b></p>
<p>Hashed password (</p>
<p>*</p>
<p> if account is disabled, </p>
<p>!</p>
<p> or </p>
<p>!!</p>
<p> if no password is set, prefixed by </p>
<p>!</p>
<p> if the account is locked).</p>
<p>Composed of the following subfields separated by </p>
<p>$</p>
<p>:</p>
<p><b>a   </b>Hashing algorithm: </p>
<p>1</p>
<p> = MD5, </p>
<p>2a</p>
<p> = Blowfish, </p>
<p>5</p>
<p> = SHA256, </p>
<p>6</p>
<p> = SHA512 (recommended)</p>
<p><b>b   </b>Random salt, up to 16 chars long.  This is to thwart password cracking attempts based on rainbow tables</p>
<p><b>c   </b>String obtained by hashing the user's plaintext password concatenated to the stored salt  </p>
<p><b>3</b></p>
<p>Date of last password change (in number of days since 1 January 1970)</p>
<p><b>4</b></p>
<p>Days before password may be changed; if 0, user can change the password at any time</p>
<p><b>5</b></p>
<p>Days after which password must be changed</p>
<p><b>6</b></p>
<p>Days before password expiration that user is warned</p>
<p><b>7</b></p>
<p>Days after password expiration that account is disabled</p>
<p><b>8</b></p>
<p>Date of account disabling (in number of days since 1 January 1970)</p>
<p><b>9</b></p>
<p>Reserved field</p>
<p><b>/etc/group</b></p>
<p><b>     Group accounts</b></p>
<p>root:x:0:root</p>
<p>jdoe:x:501</p>
<p>staff:x:530:jdoe,asmith</p>
<p><b>1              2   3         4 </b></p>
<p><b>1</b></p>
<p>Group name</p>
<p><b>2</b></p>
<p>Encrypted password, or </p>
<p>x</p>
<p> if password is in </p>
<p>/etc/gshadow</p>
<p><b>3</b></p>
<p>GID – Group ID</p>
<p><b>4</b></p>
<p>Group members (if this is not their Default Group)</p>
<p><b>/etc/gshadow</b></p>
<p><b>     Group passwords</b></p>
<p>root::root:root</p>
<p>jdoe:!::</p>
<p>staff:0cfz7IpLhW19i::root,jdoe</p>
<p><b>1              2                                 3  4 </b></p>
<p><b>1</b></p>
<p>Group name</p>
<p><b>2</b></p>
<p>Encrypted password, or </p>
<p>!</p>
<p> if no password is set (default)</p>
<p><b>3</b></p>
<p>Group administrators</p>
<p><b>4</b></p>
<p>Group members</p>
<p>/etc/shadow</p>
<p> and </p>
<p>/etc/gshadow</p>
<p> are mode 000 and therefore readable only by the root user.</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>78/189</b></p>
<p><b>User management</b></p>
<p><i>User<b> </b>management</i></p>
<p>useradd -m <i>user</i></p>
<p>Create a user account, creating and populating his homedir from </p>
<p>/etc/skel</p>
<p>useradd -mc &quot;<i>Name Surname</i>&quot; <i>user</i></p>
<p>Create a user account, specifying his full name</p>
<p>useradd -ms /bin/ksh <i>user</i></p>
<p>Create a user account, specifying his login shell</p>
<p>useradd -D</p>
<p>Show default values for user account creation, as specified in </p>
<p>/etc/login.defs</p>
<p> and</p>
<p>/etc/default/useradd</p>
<p> </p>
<p>usermod -c &quot;<i>Name Surname</i>&quot; <i>user</i> </p>
<p>Modify the GECOS field of a user account</p>
<p>usermod -L <i>user</i></p>
<p>Lock a user account</p>
<p>usermod -U <i>user</i></p>
<p>Unlock a user account</p>
<p>Most options for </p>
<p>usermod</p>
<p> and </p>
<p>useradd</p>
<p> are the same.</p>
<p>userdel -r <i>user</i></p>
<p>Delete a user and his homedir</p>
<p>chfn <i>user</i></p>
<p>Change the GECOS field of a user</p>
<p>chsh <i>user</i></p>
<p>Change the login shell of a user</p>
<p>passwd <i>user</i></p>
<p>Change the password of a user</p>
<p>passwd -l <i>user</i></p>
<p>Lock a user account</p>
<p>passwd -S <i>user</i></p>
<p>Show information about a user account: username, account status (L=locked, </p>
<p>P=password, NP=no password), date of last password change, min age, max age, </p>
<p>warning period, inactivity period in days</p>
<p>chage -E 2022-02-14 <i>user</i></p>
<p>Change the password expiration date; account will be locked at that date </p>
<p>chage -d 13111 <i>user</i></p>
<p>Change the date (in number of days since 1 January 1970) of last password change</p>
<p>chage -d 0 <i>user</i></p>
<p>Force the user to change password at his next login</p>
<p>chage -M 30 <i>user</i></p>
<p>Change the max number of days during which a password is valid</p>
<p>chage -m 7 <i>user</i></p>
<p>Change the min number of days between password changes</p>
<p>chage -W 15 <i>user</i></p>
<p>Change the number of days before password expiration that the user will be warned</p>
<p>chage -I 3 <i>user</i></p>
<p>Change the number of days after password expiration before the account is locked</p>
<p>chage -l <i>user</i></p>
<p>List password aging information for a user</p>
<p>chpasswd</p>
<p>Tool for batch update of passwords.  Reads from stdin a list of <i>username</i>:<i>password</i></p>
<p>vipw</p>
<p>vigr</p>
<p>Edit manually </p>
<p>/etc/passwd</p>
<p>, </p>
<p>/etc/shadow</p>
<p>, </p>
<p>/etc/group</p>
<p>, or </p>
<p>/etc/gshadow</p>
<p>adduser</p>
<p>deluser</p>
<p>User-friendly front-end commands for user management</p>
<p>system-config-users  </p>
<p>(Red Hat)</p>
<p>GUI for user and group management</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>79/189</b></p>
<p><b>Group management</b></p>
<p><i>Group management</i></p>
<p>groupadd <i>group</i></p>
<p>Create a group</p>
<p>groupmod -n <i>newname oldname</i></p>
<p>Change a group name</p>
<p>groupdel <i>group</i></p>
<p>Delete a group</p>
<p>gpasswd <i>group</i></p>
<p>Set or change the password of a group</p>
<p>gpasswd -a <i>user</i> <i>group</i></p>
<p>Add a user to a group</p>
<p>gpasswd -d <i>user</i> <i>group</i></p>
<p>Delete a user from a group</p>
<p>gpasswd -A <i>user</i> <i>group</i></p>
<p>Add a user to the list of administrators of the group</p>
<p>addgroup</p>
<p>delgroup</p>
<p>User-friendly front-end commands for group management</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>80/189</b></p>
<p><b>UID and GID</b></p>
<p><i>UID and GID</i></p>
<p>On a system, every user is identified by a numeric <b>UID (User ID)</b>, and every group by a numeric <b>GID (Group ID)</b>.</p>
<p>UID 0 is assigned to the superuser.</p>
<p>UIDs from 0 to 99 should</p>
<p>*</p>
<p> be reserved for static allocation by the system and not be created by applications.</p>
<p>UIDs from 100 to 499 should</p>
<p>*</p>
<p> be reserved for dynamic allocation by the superuser and post-install scripts.  </p>
<p>UIDs for user accounts start from 500 (Red Hat) or 1000 (SUSE, Debian).</p>
<p>*</p>
<p> as recommended by the Linux Standard Base core specifications</p>
<p>A process has an effective, saved, and real UID and GID.</p>
<p><b>Effective UID </b></p>
<p>Used for most access checks, and as the owner for files created by the process.  An unprivileged process</p>
<p>can change its effective UID only to either its saved UID or its real UID.</p>
<p><b>Saved UID </b></p>
<p>Used when a process running with elevated privileges needs to temporarily lower its privileges.  The </p>
<p>process changes its effective UID (usually root) to an unprivileged one, and its privileged effective UID is</p>
<p>copied to the saved UID.  Later, the process can resume its elevated privileges by resetting its effective </p>
<p>UID back to the saved UID.</p>
<p><b>Real UID</b></p>
<p>Used to identify the real owner of the process and affect the permissions for sending signals.  An </p>
<p>unprivileged process can signal another process only if the sender’s real or effective UID matches the </p>
<p>receiver's real or saved UID.  Child processes inherit the credentials from the parent, so they can signal </p>
<p>each other.</p>
<p>/etc/login.defs</p>
<p>Definition of default values (UID and GID ranges, mail directory, account validity, password </p>
<p>encryption method, etc.) for user account creation </p>
<p>whoami</p>
<p>Print your username (as effective UID)</p>
<p>id</p>
<p>Print your real and effective UID and GID, and the groups you are a member of</p>
<p>id -u</p>
<p>Print your effective UID</p>
<p>id <i>user</i></p>
<p>Print UID, GID, and groups information about <i>user</i></p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>81/189</b></p>
<p><b>sudo and su</b></p>
<p><i>sudo and su</i></p>
<p>Sudo is a mechanism that allows running a command as another user.  Sudo access rights are defined in the sudoers files </p>
<p>/etc/sudoers</p>
<p> and </p>
<p>/etc/sudoers.d/*</p>
<p>; these files must be edited only via </p>
<p>visudo</p>
<p>. </p>
<p>Commands run by sudo users are logged via syslog on </p>
<p>/var/log/auth.log</p>
<p> (Debian) or </p>
<p>/var/log/secure</p>
<p> (Red Hat).</p>
<p>sudo -u <i>user command</i></p>
<p>Run <i>command</i> as <i>user</i></p>
<p>sudo <i>command</i></p>
<p>sudo -u root <i>command</i></p>
<p>Run <i>command</i> as root</p>
<p>sudo su -</p>
<p>sudo -i</p>
<p>Login on an interactive shell as root</p>
<p>sudo -u <i>user </i>-s</p>
<p>Login as <i>user</i> with a shell, even if the user's shell is </p>
<p>/sbin/nologin</p>
<p> or similar</p>
<p>sudo -l</p>
<p>List the allowed commands for the current user</p>
<p>sudo !!</p>
<p>Run again the last command, but this time as root</p>
<p>sudoedit /etc/passwd</p>
<p>sudo -e /etc/passwd</p>
<p>Edit safely a file (in this case, </p>
<p>/etc/passwd</p>
<p>) according to security policies.  It is </p>
<p>recommended to allow users use this command instead of sudoing text editors as root </p>
<p>on protected files, because the editor might be able to spawn a shell, causing security </p>
<p>issues</p>
<p>visudo</p>
<p>Edit safely the sudoers file</p>
<p>visudo -c</p>
<p>Check the sudoers file for syntax errors, unused aliases, etc.</p>
<p>su <i>user</i></p>
<p>Run a shell as <i>user</i></p>
<p>su</p>
<p>su root</p>
<p>Run a shell as root</p>
<p>su -c &quot;fdisk -l&quot;</p>
<p>Pass a single command to the shell</p>
<p>su -</p>
<p>su -l</p>
<p>Ensure that the spawned shell is a login shell, hence running login scripts and setting </p>
<p>the correct environment variables.  Recommended option</p>
<p>gksudo -u root <i>command</i></p>
<p>gksu -u root -l</p>
<p>GUI front-ends to </p>
<p>su</p>
<p> and </p>
<p>sudo</p>
<p> used to run an X Window command or application as </p>
<p>root.  Pops up a requester prompting the user for root's password</p>
<p>runuser -u <i>user</i> <i>command</i></p>
<p>Run <i>command</i> as <i>user</i>.  Can be launched only by root</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>82/189</b></p>
<p><b>Terminals</b></p>
<p><i>Terminals</i></p>
<p>chvt <i>n</i></p>
<p>Make </p>
<p>/dev/tty<i>n</i></p>
<p> the foreground terminal</p>
<p>vlock</p>
<p>away</p>
<p>Lock the virtual console (terminal)</p>
<p>tty</p>
<p>Print your terminal device (e.g. </p>
<p>/dev/tty1</p>
<p>, </p>
<p>/dev/pts/1</p>
<p>)</p>
<p>stty</p>
<p>Change or display terminal line settings</p>
<p>stty -ixon</p>
<p>Disable XON/XOFF flow control</p>
<p>clear</p>
<p>Clear the terminal screen</p>
<p>tmux</p>
<p>Terminal multiplexer</p>
<p>nohup <i>script.sh</i></p>
<p>Prevent a process from terminating (receiving a SIGHUP) when its parent Bash dies.</p>
<p>When a Bash shell is terminated cleanly via </p>
<p>exit</p>
<p>, its jobs will become child of the </p>
<p>Bash's parent and will continue running.  When a Bash shell is killed instead, it </p>
<p>issues a SIGHUP to its children which will terminate</p>
<p>screen</p>
<p>Screen manager that multiplexes a single virtual VT100/ANSI terminal between </p>
<p>multiple processes or shells.</p>
<p>When the connection to a terminal is lost (e.g. because the terminal is closed </p>
<p>manually, the user logs out, or the remote SSH session goes into timeout), a </p>
<p>SIGHUP is sent to the shell and from there to all running child processes which are </p>
<p>therefore terminated.  The </p>
<p>screen</p>
<p> command starts an interactive shell screen </p>
<p>session, to which the user will be able to reattach later</p>
<p>screen -S <i>sessionname</i></p>
<p>Start a screen session with the specified session name</p>
<p>screen <i>command</i></p>
<p>Start the specified command in a screen session; session will end when the </p>
<p>command exits</p>
<p>screen -list</p>
<p>Show the list of detached screen sessions</p>
<p>screen -r <i>pid.tty.host</i></p>
<p>screen -r <i>owner</i>/<i>pid.tty.host</i></p>
<p>Resume a detached screen session</p>
<p>screen -R</p>
<p>Resume the last detached screen session</p>
<p>screen -d -R <i>sessionname</i></p>
<p>Detach a remote screen session and reattach your current terminal to it</p>
<p>Send a command to the window manager:</p>
<p>0</p>
<p> ... </p>
<p>9  </p>
<p>Switch between screen sessions</p>
<p>c      </p>
<p>Create a new screen session</p>
<p>?      </p>
<p>Show help</p>
<p><b>How to detach an already running job that was not started in a </b></p>
<p><b>screen</b></p>
<p><b> session</b></p>
<p>(these commands detach the job from its parent shell, so that the job will not be killed when the terminal is closed) </p>
<p>1.</p>
<p>Suspend the job</p>
<p>2.</p>
<p>bg</p>
<p>Send the job to background</p>
<p>3.</p>
<p>jobs</p>
<p>Show the number (let's assume is <i>n</i>) of the backgrounded job</p>
<p>4.</p>
<p>disown -h %<i>n</i></p>
<p>Mark job <i>n</i> so it will not receive a SIGHUP from its parent shell</p>
<p>or</p>
<p>1.</p>
<p>screen</p>
<p>Start a screen session</p>
<p>2.</p>
<p>reptyr <i>pid</i></p>
<p>Attach the job with process ID <i>pid</i> to the new terminal (screen session)</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>CTRL</p>
<p>A</p>
<p>CTRL</p>
<p>Z</p>
<p>CTRL</p>
<p>ALT</p>
<p>F<i>n</i></p>
<p>CTRL</p>
<p>L</p>
<h1 style="page-break-before:always; "></h1>
<p><b>83/189</b></p>
<p><b>Messaging</b></p>
<p><i>Messaging</i></p>
<p>write <i>user</i></p>
<p>Write interactively a message to the terminal of <i>user</i> (which must be logged in)</p>
<p>echo &quot;<i>Message</i>&quot; | write <i>user</i></p>
<p>Write a message to the terminal of <i>user</i> (which must be logged in)</p>
<p>wall</p>
<p>Write interactively a message to the terminal of all logged in users</p>
<p>echo &quot;<i>Message</i>&quot; | wall</p>
<p>Write a message to the terminal of all logged in users</p>
<p>talk <i>user</i></p>
<p>Open an interactive chat session with <i>user</i> (which must be logged in)</p>
<p>mesg y</p>
<p>chmod g+w $(tty)</p>
<p>Allow the other users to message you via </p>
<p>write</p>
<p>, </p>
<p>wall</p>
<p>, and </p>
<p>talk</p>
<p>mesg n</p>
<p>chmod g-w $(tty)</p>
<p>Disallow the other users to message you via </p>
<p>write</p>
<p>, </p>
<p>wall</p>
<p>, and </p>
<p>talk</p>
<p>mesg</p>
<p>Display your current message permission status</p>
<p>mesg</p>
<p> works by enabling/disabling the group write permission of your terminal device, which is owned by system group </p>
<p>tty</p>
<p>.</p>
<p>The root user is always able to message users.</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>84/189</b></p>
<p><b>cron</b></p>
<p><i>cron</i></p>
<p>cron</p>
<p> is a job scheduler, allowing the repeated execution of commands specified in crontab files.</p>
<p>The </p>
<p>crond</p>
<p> daemon checks the crontab files every minute and runs the command as the specified user at the specified times.</p>
<p>It is not necessary to restart </p>
<p>crond</p>
<p> after the modification of a crontab file, as the changes will be reloaded automatically.</p>
<p>If </p>
<p>/etc/cron.allow</p>
<p> exists, only users listed therein can access the service.</p>
<p>If </p>
<p>/etc/cron.deny</p>
<p> exists, all users except those listed therein can access the service.</p>
<p>If none of these files exist, all users can access the service.</p>
<p>/etc/crontab</p>
<p>/etc/cron.d/*</p>
<p>System-wide crontab files</p>
<p>/etc/cron.hourly/</p>
<p>/etc/cron.daily/</p>
<p>/etc/cron.weekly/</p>
<p>/etc/cron.monthly/</p>
<p>Scripts placed in these directories will be automatically executed on the </p>
<p>specified periods</p>
<p>/var/spool/cron/<i>user</i></p>
<p>Crontab of <i>user</i>.  This file has the same format as the system-wide crontab </p>
<p>files, except that the &quot;user&quot; field is not present</p>
<p>crontab -e</p>
<p>Edit your user crontab file</p>
<p>crontab -l</p>
<p>List the contents of your crontab file</p>
<p>crontab -e -u <i>user</i></p>
<p>Edit the crontab file of another <i>user</i> (command available only to the superuser)</p>
<p><b>/etc/crontab</b></p>
<p># m  h  dom mon dow  user  command</p>
<p> 25  6   *   *   1   root  /opt/script1.sh</p>
<p>every Monday at 6:25 AM</p>
<p>*/5 16   *   *   *   root  /opt/script2.sh</p>
<p>from 4:00 to 4:55 PM every 5 minutes every day </p>
<p>0,30 7  25  12   *   jdoe  /home/jdoe/foo.sh</p>
<p>at 7:00 and 7:30 AM on 25</p>
<p>th</p>
<p> December</p>
<p>  3 17   *   *  1-5  root  /root/bar.sh  </p>
<p>at 5:03 PM every day, from Monday to Friday</p>
<p><b>m</b></p>
<p>minutes</p>
<p><b>h</b></p>
<p>hours</p>
<p><b>dom</b></p>
<p>day of month (1-31)</p>
<p><b>mon</b></p>
<p>month (1-12 or jan-dec)</p>
<p><b>dow</b></p>
<p>day of week (0-7 or sun-sat; 0=7=Sunday)</p>
<p><b>user</b></p>
<p>User as whom the command will be executed</p>
<p><b>command</b></p>
<p>Command that will be executed at the specified times</p>
<p>The </p>
<p>crond</p>
<p> daemon also runs anacron jobs, which allow the execution of periodic jobs on a machine that is not always </p>
<p>powered on, such as a laptop.  Only the superuser can schedule anacron jobs, which have a granularity of one day (vs one </p>
<p>minute for cron jobs).</p>
<p>/var/spool/anacron/<i>jobid</i></p>
<p>Date of the last execution of the anacron job identified by <i>jobid</i></p>
<p><b>/etc/anacrontab</b></p>
<p># period  delay  job-identifier  command</p>
<p>  7       10     cron.weekly     /opt/script3.sh</p>
<p>If the job has not been run in the last 7 days, </p>
<p>wait 10 minutes and then execute the command</p>
<p><b>period </b></p>
<p>period, in days, during which the command was not executed</p>
<p><b>delay</b></p>
<p>delay to wait, in minutes, before execution of the command</p>
<p><b>job-identifier</b></p>
<p>job identifier in anacron messages; should be unique for each anacron job</p>
<p><b>command</b></p>
<p>command that will be executed</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>85/189</b></p>
<p><b>at</b></p>
<p><i>at</i></p>
<p>at</p>
<p> is used for scheduled execution of commands that must run only once.  Execution of these commands is the duty of the </p>
<p>atd</p>
<p> daemon.</p>
<p>If </p>
<p>/etc/at.allow</p>
<p> exists, only users listed therein can access the service.</p>
<p>If </p>
<p>/etc/at.deny</p>
<p> exists, all users except those listed therein can access the service.</p>
<p>If none of these files exist, no user except the superuser can access the service.</p>
<p>at 5:00pm tomorrow script.sh</p>
<p>at -f listofcommands.txt 5:00pm tomorrow</p>
<p>echo &quot;rm file&quot; | at now+2 minutes</p>
<p>Execute a command once at the specified time (absolute or relative)</p>
<p>at -l</p>
<p>atq</p>
<p>List the scheduled jobs</p>
<p>at -d 3</p>
<p>atrm 3</p>
<p>Remove job number 3 from the list</p>
<p>batch</p>
<p>Schedule execution of a command for when the system is not too </p>
<p>charged.  Reads a command from stdin and runs it when the system's</p>
<p>load average falls below 0.8</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>86/189</b></p>
<p><b>Utilities</b></p>
<p><i>Utilities</i></p>
<p>bc</p>
<p>Calculator</p>
<p>dc</p>
<p>Calculator featuring unlimited precision arithmetic</p>
<p>factor</p>
<p>Finds the prime factors of a number</p>
<p>units</p>
<p>Converter of quantities between different units</p>
<p>cal</p>
<p>Calendar</p>
<p>banner</p>
<p>Print a text in large letters made of the character #</p>
<p>figlet</p>
<p>Print a text in large letters, in a specific font</p>
<p>toilet</p>
<p>Print a text in large colorful letters, in a specific font</p>
<p>lolcat</p>
<p>Print a text in rainbow coloring</p>
<p>fortune</p>
<p>Print a random aphorism, like those found in fortune cookies</p>
<p>sensors</p>
<p>Print sensor chips information (e.g. temperature)</p>
<p>beep</p>
<p>Produce a beep from the machine's speakers</p>
<p>speaker-test</p>
<p>Speaker test tone generator for the ALSA (Advanced Linux Sound Architecture) framework</p>
<p>on_ac_power</p>
<p>Return 0 (true) if machine is connected to AC power, 1 (false) if on battery.  Useful for laptops</p>
<p>ipcalc</p>
<p>IP addresses calculator</p>
<p>pwgen</p>
<p>Random password generator</p>
<p>pwqgen</p>
<p>Random password generator with controllable quality</p>
<p>uuidgen</p>
<p>Generator of UUIDs (random or time-based)</p>
<p>haveged</p>
<p>Generator of random numbers via the HAVEGE (Hardware Volatile Entropy Gathering and Expansion)</p>
<p>algorithm.  Can be run as a daemon to automatically replenish </p>
<p>/dev/random</p>
<p> whenever the supply of</p>
<p>random bits in the random device gets too low</p>
<p>aspell</p>
<p>Spell checker</p>
<p>cloc</p>
<p>Count lines of source code</p>
<p>gnome-terminal</p>
<p>GNOME shell terminal</p>
<p>conky</p>
<p>Highly configurable system monitor widget with integration for audio player, email, and news</p>
<p>gkrellm</p>
<p>System monitor widget</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>87/189</b></p>
<p><b>Localization</b></p>
<p><i>Localization</i></p>
<p><b>Locale environment variables</b></p>
<p>LANG</p>
<p>LANGUAGE</p>
<p>Language, stored in </p>
<p>/etc/default/locale</p>
<p>.</p>
<p>When scripting, it is recommended to set </p>
<p>LANG=C</p>
<p> because this specifies the minimal locale </p>
<p>environment for C translation, and guarantees a standard collation and formats for the execution </p>
<p>of scripts</p>
<p>LC_CTYPE</p>
<p>Character classification and case conversion</p>
<p>LC_NUMERIC</p>
<p>Non-monetary numeric formats</p>
<p>LC_TIME</p>
<p>Date and time formats</p>
<p>LC_COLLATE</p>
<p>Alphabetical order</p>
<p>LC_MONETARY</p>
<p>Monetary formats</p>
<p>LC_MESSAGES</p>
<p>Language and encoding of system messages and user input</p>
<p>LC_PAPER</p>
<p>Paper size</p>
<p>LC_NAME</p>
<p>Personal name formats</p>
<p>LC_ADDRESS</p>
<p>Geographic address formats </p>
<p>LC_TELEPHONE</p>
<p>Telephone number formats</p>
<p>LC_MEASUREMENT</p>
<p>Measurement units (metric or others)</p>
<p>LC_IDENTIFICATION</p>
<p>Metadata about locale</p>
<p>LC_ALL</p>
<p>Special variable overriding all others</p>
<p>The values of these locale environment variables are in the format </p>
<p><i>language</i>_<i>territory</i>.<i>encoding</i></p>
<p> e.g. </p>
<p>en_US.UTF-8</p>
<p>.</p>
<p>The list of supported locales is stored in </p>
<p>/usr/share/i18n/SUPPORTED</p>
<p>.</p>
<p>locale</p>
<p>Show locale environment variables</p>
<p>locale-gen it_IT.UTF-8</p>
<p>Generate a locale (in this case IT) by compiling a list of </p>
<p>locale definition files</p>
<p>apt-get install manpages-it language-pack-it  </p>
<p>(Debian)</p>
<p>Install a different locale (in this case IT); this affects </p>
<p>system messages and manpages</p>
<p>iconv -f IS6937 -t IS8859 <i>filein</i> &gt; <i>fileout</i></p>
<p>Convert a text file from a codeset to another</p>
<p>ISO/IEC-8859 is a standard for 8-bit encoding of printable characters.</p>
<p>The first 256 characters in ISO/IEC-8859-1 (Latin-1) are identical to those in Unicode.</p>
<p>UTF-8 encoding can represent every character in the Unicode set, and was designed for backward compatibility with ASCII.</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>88/189</b></p>
<p><b>System time</b></p>
<p><i>System time</i></p>
<p>date</p>
<p>Show current date and time</p>
<p>date -d &quot;9999 days ago&quot;</p>
<p>date -d &quot;1970/01/01 + 4242&quot;</p>
<p>Calculate a date and show it</p>
<p>date +&quot;%F %H:%M:%S&quot;</p>
<p>Show current date in the format specified</p>
<p>date +&quot;%s&quot;</p>
<p>Show current date in Unix time format (seconds elapsed since 00:00:00 1/1/1970)</p>
<p>date -s &quot;20130305 23:30:00&quot;</p>
<p>Set the date</p>
<p>date 030523302013</p>
<p>Set the date, in the format <i>MMDDhhmmYYYY</i></p>
<p>timedatectl</p>
<p>Show current date and time</p>
<p>timedatectl set-time 2013-03-05</p>
<p>timedatectl set-time 23:30</p>
<p>Set the date</p>
<p>timedatectl list-timezones</p>
<p>List all possible timezones</p>
<p>zdump GMT</p>
<p>Show current date and time in the GMT timezone</p>
<p>tzselect</p>
<p>tzconfig</p>
<p>dpkg-reconfigure tzdata            </p>
<p>(Debian)</p>
<p>timedatectl set-timezone <i>timezone</i>  </p>
<p>(Red Hat)</p>
<p>Set the timezone</p>
<p>/etc/timezone   </p>
<p>(Debian)</p>
<p>Timezone</p>
<p>/etc/localtime  </p>
<p>(Red Hat)</p>
<p>Timezone, a symlink to the appropriate timezone file in </p>
<p>/usr/share/zoneinfo/</p>
<p>ntpd</p>
<p>NTP daemon, keeps the clock in sync with Internet time servers</p>
<p>ntpd -q</p>
<p>Synchronize the time once and quit</p>
<p>ntpd -g</p>
<p>Force NTP to start even if clock is off by more than the panic threshold (1000 secs) </p>
<p>ntpd -nqg</p>
<p>Start NTP as a non-daemon, force synchronization of the clock, and quit.</p>
<p>The NTP daemon must not be running when this command is launched</p>
<p>ntpq -p <i>timeserver</i></p>
<p>Print the list of peers for the time server</p>
<p>ntpdate <i>timeserver</i></p>
<p>Synchronizes the clock with the specified time server</p>
<p>ntpdate -b <i>timeserver</i></p>
<p>Brutally set the clock, without waiting for it to adjust slowly</p>
<p>ntpdate -q <i>timeserver</i></p>
<p>Query the time server without setting the clock</p>
<p>The </p>
<p>ntpdate</p>
<p> command is deprecated; to synchronize the clock, use </p>
<p>ntpd</p>
<p> instead.</p>
<p>chronyd</p>
<p>Daemon for chrony, a versatile NTP client/server</p>
<p>chronyc</p>
<p>Command line interface for the chrony daemon</p>
<p>hwclock --show</p>
<p>hwclock -r</p>
<p>Show the hardware clock</p>
<p>hwclock --hctosys</p>
<p>hwclock -s</p>
<p>Set the system time from the hardware clock</p>
<p>hwclock --systohc</p>
<p>hwclock -w</p>
<p>Set the hardware clock from system time</p>
<p>hwclock --utc</p>
<p>Indicate that the hardware clock is kept in Coordinated Universal Time</p>
<p>hwclock --localtime</p>
<p>Indicate that the hardware clock is kept in local time</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>89/189</b></p>
<p><b>syslog</b></p>
<p><i>syslog</i></p>
<p>syslogd</p>
<p>rsyslogd  </p>
<p>(Ubuntu 14)</p>
<p>Daemon logging events from user processes</p>
<p>klogd</p>
<p>Daemon logging events from kernel processes</p>
<p><b>/etc/syslog.conf</b></p>
<p># facility.level                  action</p>
<p>*.info;mail.none;authpriv.none   /var/log/messages</p>
<p>authpriv.*                       /var/log/secure</p>
<p>mail.*                           /var/log/maillog</p>
<p>*.alert                          root</p>
<p>*.emerg                          *</p>
<p>local5.*                         @10.7.7.7</p>
<p>local7.*                         /var/log/boot.log</p>
<p><b>Facility</b></p>
<p>Creator of the message</p>
<p><b>Level</b></p>
<p>Severity of the message</p>
<p><b>Action</b></p>
<p>Destination of the message</p>
<p>auth </p>
<p>or</p>
<p> security</p>
<p>†</p>
<p>authpriv</p>
<p>cron</p>
<p>daemon</p>
<p>kern</p>
<p>lpr</p>
<p>mail</p>
<p>mark  </p>
<p>(for syslog internal use)</p>
<p>news</p>
<p>syslog</p>
<p>user</p>
<p>uucp</p>
<p>local0</p>
<p> ... </p>
<p>local7  </p>
<p>(custom)</p>
<p>emerg </p>
<p>or</p>
<p> panic</p>
<p>†</p>
<p>  </p>
<p>(highest)</p>
<p>alert</p>
<p>crit</p>
<p>err </p>
<p>or</p>
<p> error</p>
<p>†</p>
<p>warning </p>
<p>or</p>
<p> warn</p>
<p>†</p>
<p>notice</p>
<p>info</p>
<p>debug  </p>
<p>(lowest)</p>
<p>none  </p>
<p>(facility disabled)</p>
<p><i>file</i></p>
<p>message is written into a log <i>file</i></p>
<p>@<i>host</i></p>
<p>message is sent to a logger </p>
<p>server <i>host</i> (via UDP port 514)</p>
<p><i>user1</i>,<i>user2</i>,<i>user3</i> </p>
<p>message is sent to the specified </p>
<p>users' consoles</p>
<p>*</p>
<p>message is sent to all logged-in </p>
<p>users' consoles</p>
<p>† = deprecated</p>
<p>Facilities and levels are listed in the manpage </p>
<p>man 3 syslog</p>
<p>.</p>
<p>logger -p auth.info &quot;<i>Message</i>&quot;</p>
<p>Send a message to syslog with facility &quot;auth&quot; and priority &quot;info&quot;</p>
<p>logrotate</p>
<p>Rotate logs.  It gzips, renames, and eventually deletes old logfiles according to the</p>
<p>configuration files </p>
<p>/etc/logrotate.conf</p>
<p> and </p>
<p>/etc/logrotate.d/*</p>
<p>.  It is usually </p>
<p>scheduled as a daily cron job</p>
<p>/var/log/messages</p>
<p>Global system logfile</p>
<p>/var/log/dmesg</p>
<p>Kernel ring buffer information</p>
<p>/var/log/kern.log</p>
<p>Kernel log</p>
<p>/var/log/boot.log</p>
<p>Information logged during boot</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>90/189</b></p>
<p><b>E-mail</b></p>
<p><i>E-mail</i></p>
<p>            e.g. Pine, Mutt             e.g. Sendmail, Exim, Postfix, qmail                                                      e.g. Procmail, SpamAssassin</p>
<p>~/.forward</p>
<p>Mail address(es) to which forward the user's mail, or mail commands</p>
<p>/etc/aliases</p>
<p>/etc/mail/aliases</p>
<p>Aliases database for users on the local machine.  Each line has syntax </p>
<p><i>alias</i>: <i>user</i></p>
<p>/var/spool/mail/<i>user</i></p>
<p>Inbox for </p>
<p><i>user</i></p>
<p> on the local machine</p>
<p>/var/log/mail.log  </p>
<p>(Debian)</p>
<p>/var/log/maillog   </p>
<p>(Red Hat)</p>
<p>Mail logs</p>
<p>mail</p>
<p>mailx</p>
<p>Mailclient with advanced commands for non-interactive (batch) use</p>
<p>pine</p>
<p>Mailclient (obsolete)</p>
<p>alpine</p>
<p>Mailclient, a replacement for </p>
<p>pine</p>
<p> </p>
<p>mailx -s &quot;<i>Subject</i>&quot; -S smtp=&quot;<i>mailserver</i>:25&quot; \</p>
<p><i>user@domain.com</i> &lt; <i>messagefile</i></p>
<p>Send a mail message to <i>user@domain.com</i> via an external </p>
<p>SMTP server <i>mailserver</i></p>
<p>uuencode <i>binaryfile</i> | mail <i>user@domain.com</i></p>
<p>Send a binary file to <i>user@domain.com</i> (obsolete, not </p>
<p>recommended because many mailclients will display the </p>
<p>received attachment inline)</p>
<p>mutt -a <i>binaryfile</i> -- <i>user@domain.com</i> &lt; /dev/null</p>
<p>Send a binary file to <i>user@domain.com</i> using the Mutt MUA</p>
<p><b>Mailbox formats</b></p>
<p><b>mbox</b></p>
<p>Each mail folder is a single file, storing multiple email messages.</p>
<p>Advantages: universally supported; fast search inside a mail folder.</p>
<p>Disadvantages: issues with file locking; possible mailbox corruption.</p>
<p>$HOME/Mail/<i>folder</i></p>
<p><b>Maildir</b></p>
<p>Each mail folder is a directory, and contains the subdirectories </p>
<p>/cur</p>
<p>, </p>
<p>/new</p>
<p>, and </p>
<p>/tmp</p>
<p>.</p>
<p>Each email message is stored in its own file with a unique filename ID.</p>
<p>The process that delivers an email message writes it to a file in the </p>
<p>tmp/</p>
<p> directory, </p>
<p>and then moves it to </p>
<p>new/</p>
<p>.  The moving is commonly done by hard linking the file to </p>
<p>new/</p>
<p> and then unlinking the file from </p>
<p>tmp/</p>
<p>, which guarantees that a MUA will not see </p>
<p>a partially written message as it never looks in </p>
<p>tmp/</p>
<p>.</p>
<p>When the MUA finds mail messages in </p>
<p>new/</p>
<p> it moves them to </p>
<p>cur/</p>
<p>.</p>
<p>Advantages: fast location/retrieval/deletion of a specific mail message; no file locking </p>
<p>needed; can be used with NFS.</p>
<p>Disadvantages: some filesystems may not efficiently handle a large number of small </p>
<p>files; searching text inside all mail messages is slower.</p>
<p>$HOME/Mail/<i>folder</i>/</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>MUA </p>
<p>(Mail User Agent)</p>
<p> mailclient of sender</p>
<p>MTA </p>
<p>(Mail Transfer Agent)</p>
<p>SMTP server of sender</p>
<p>MTA </p>
<p>(Mail Transfer Agent)</p>
<p>remote host</p>
<p>MDA </p>
<p>(Mail Delivery Agent)</p>
<p>mailserver of recipient</p>
<p>MUA </p>
<p>(Mail User Agent)</p>
<p>mailclient of recipient</p>
<h1 style="page-break-before:always; "></h1>
<p><b>91/189</b></p>
<p><b>SMTP</b></p>
<p><i>SMTP</i></p>
<p><b>SMTP commands</b></p>
<p>220 smtp.example.com ESMTP Postfix    </p>
<p>(server)</p>
<p>HELO xyz.linux.org                    </p>
<p>(client)</p>
<p>250 Hello xyz.linux.org, glad to meet you</p>
<p>MAIL FROM: alice@linux.org</p>
<p>250 Ok</p>
<p>RCPT TO bob@foobar.com</p>
<p>250 Ok</p>
<p>RCPT TO carol@quux.net</p>
<p>250 Ok</p>
<p>DATA</p>
<p>354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;</p>
<p>From: Alice &lt;alice@linux.org&gt;</p>
<p>To: Bob &lt;bob@foobar.com&gt;</p>
<p>Cc: Carol &lt;carol@quux.net&gt;</p>
<p>Date: Wed, 13 August 2014 18:02:43 -0500</p>
<p>Subject: Test message</p>
<p>This is a test message.</p>
<p>.</p>
<p>250 OK id=1OjReS-0005kT-Jj</p>
<p>QUIT</p>
<p>221 Bye</p>
<p>HELO xyz.linux.org</p>
<p>Initiate the conversation and </p>
<p>identify client host to server</p>
<p>EHLO xyz.linux.org</p>
<p>Like HELO, but tell server to </p>
<p>use Extended SMTP</p>
<p>MAIL FROM: alice@linux.org</p>
<p>Specify mail sender</p>
<p>RCPT TO: bob@foobar.com</p>
<p>Specify mail recipient</p>
<p>DATA</p>
<p>Specify data to send.  Ended </p>
<p>with a dot on a single line</p>
<p>QUIT</p>
<p>RSET</p>
<p>Disconnect</p>
<p>HELP</p>
<p>List all available commands</p>
<p>NOOP</p>
<p>Empty command</p>
<p>VRFY alice@linux.org</p>
<p>Verify the existence of an e-</p>
<p>mail address (this command </p>
<p>should not be implemented, </p>
<p>for security reasons)</p>
<p>EXPN mailinglist</p>
<p>Check mailing list membership</p>
<p><b>SMTP response codes</b></p>
<p><b>first digit</b></p>
<p><b>1</b></p>
<p>Command accepted, but not processed until client sends confirmation</p>
<p><b>2</b></p>
<p>Command successfully completed</p>
<p><b>3</b></p>
<p>Command accepted, but not processed until client sends more information</p>
<p><b>4</b></p>
<p>Command failed due to temporary errors</p>
<p><b>5</b></p>
<p>Command failed due to permanent errors</p>
<p><b>second digit</b></p>
<p><b>0</b></p>
<p>Syntax error or command not implemented</p>
<p><b>1</b></p>
<p>Informative response in reply to a request for information</p>
<p><b>2</b></p>
<p>Connection response in reply to a data transmission</p>
<p><b>5</b></p>
<p>Status response in reply to a mail transfer operation</p>
<p><b>third digit</b></p>
<p>Specifies further the response</p>
<p><b>211</b></p>
<p><b>214</b></p>
<p><b>220</b></p>
<p><b>221</b></p>
<p><b>250</b></p>
<p><b>251</b></p>
<p><b>354</b></p>
<p><b>421</b></p>
<p><b>450</b></p>
<p><b>451</b></p>
<p><b>452</b></p>
<p><b>500</b></p>
<p><b>501</b></p>
<p><b>502</b></p>
<p><b>503</b></p>
<p><b>504</b></p>
<p><b>550</b></p>
<p><b>551</b></p>
<p><b>552</b></p>
<p><b>553</b></p>
<p><b>554</b></p>
<p>System status or help reply</p>
<p>Help message </p>
<p>The server is ready</p>
<p>The server is ending the conversation</p>
<p>The requested action was completed</p>
<p>The specified user is not local, but the server will forward the mail message</p>
<p>Reply to the DATA command.  After getting this, start sending the message body</p>
<p>The mail server will be shut down, try again later </p>
<p>The mailbox that you are trying to reach is busy, try again later </p>
<p>The requested action was not done.  Some error occurred in the mail server </p>
<p>The requested action was not done.  The mail server ran out of system storage </p>
<p>The last command contained a syntax error or the command line was too long </p>
<p>The parameters or arguments in the last command contained a syntax error</p>
<p>The last command is not implemented in the mail server </p>
<p>The last command was sent out of sequence </p>
<p>One of the parameters of the last command is not implemented by the server</p>
<p>The mailbox that you are trying to reach can't be found or you don't have access rights</p>
<p>The specified user is not local; part of message text will contain a forwarding address </p>
<p>The mailbox that you are trying to reach has run out of space, try again later </p>
<p>The mail address that you specified was not syntactically correct</p>
<p>The mail transaction has failed for unknown causes </p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>92/189</b></p>
<p><b>Sendmail</b></p>
<p><i>Sendmail</i></p>
<p>Sendmail is an MTA distributed as a monolithic binary file.</p>
<p>Previous versions used to run SUID </p>
<p>root</p>
<p>, which caused many security problems; recent versions run SGID </p>
<p>smmsp</p>
<p>, the group</p>
<p>that has write access on the mail queue.</p>
<p>Sendmail uses </p>
<p>smrsh</p>
<p>, a restricted shell, to run some external programs.</p>
<p>Configuration files (must not be edited by hand):</p>
<p>/etc/mail/</p>
<p>submit.cf</p>
<p>Sendmail local mail transfer configuration file</p>
<p>sendmail.cf</p>
<p>Sendmail MTA configuration file</p>
<p>m4 /etc/mail/submit.mc &gt; /etc/mail/submit.cf</p>
<p>Generate a </p>
<p>.cf</p>
<p> configuration file from an editable </p>
<p>.mc</p>
<p> text file</p>
<p>Database files (must not be edited by hand):</p>
<p>/etc/mail/</p>
<p>access.db</p>
<p>Access control file to allow or deny access to systems or users</p>
<p>local-host-names.db</p>
<p>List of domains that must be considered as local accounts</p>
<p>virtusertable.db</p>
<p>Map for local accounts, used to distribute incoming email</p>
<p>mailertable.db</p>
<p>Routing table, used to dispatch emails from remote systems</p>
<p>domaintable.db</p>
<p>Domain table, used for transitions from an old domain to a new one</p>
<p>genericstable.db</p>
<p>Map for local accounts, used to specify a different sender for outgoing mail</p>
<p>genericsdomain.db</p>
<p>Local FQDN</p>
<p>makemap hash /etc/mail/access.db &lt; /etc/mail/access</p>
<p>Generate a </p>
<p>.db</p>
<p> database file from an editable text file</p>
<p>Temporary mailqueue files (where <i>nnn</i> is the Message ID):</p>
<p>/var/spool/mqueue/</p>
<p>df<i>nnn</i></p>
<p>Mail body</p>
<p>qf<i>nnn</i></p>
<p>Message envelope with headers and routing information</p>
<p>Qf<i>nnn</i></p>
<p>Message envelope if abandoned</p>
<p>hf<i>nnn</i></p>
<p>Message envelope if held / quarantined by a milter (i.e. mail filter)</p>
<p>tf<i>nnn</i></p>
<p>Temporary file</p>
<p>lf<i>nnn</i></p>
<p>Lock file</p>
<p>nf<i>nnn</i></p>
<p>Backup file</p>
<p>xf<i>nnn</i></p>
<p>Transcript of delivery attempts</p>
<p>newaliases</p>
<p>sendmail -bi</p>
<p>Update the aliases database.  Must be run after any change to </p>
<p>/etc/aliases</p>
<p>mailq</p>
<p>sendmail -bp</p>
<p>Examine the mail queue</p>
<p>sendmail -bt</p>
<p>Run Sendmail in test mode</p>
<p>sendmail -q</p>
<p>Force a queue run</p>
<p>hoststat</p>
<p>Print statistics about remote hosts usage</p>
<p>purgestat</p>
<p>Clear statistics about remote host usage</p>
<p>mailstats</p>
<p>Print statistics about the mailserver</p>
<p>praliases</p>
<p>Display email aliases</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>93/189</b></p>
<p><b>Exim</b></p>
<p><i>Exim</i></p>
<p>Exim is a free MTA, distributed under open source GPL license.</p>
<p>/etc/exim.conf</p>
<p>/usr/local/etc/exim/configure  </p>
<p>(FreeBSD)</p>
<p>Exim4 configuration file</p>
<p>exim4 -bp</p>
<p>Examine the mail queue</p>
<p>exim4 -M <i>messageID</i></p>
<p>Attempt delivery of message</p>
<p>exim4 -Mrm <i>messageID</i></p>
<p>Remove a message from the mail queue</p>
<p>exim4 -Mvh <i>messageID</i></p>
<p>See the headers of a message in the mail queue</p>
<p>exim4 -Mvb <i>messageID</i></p>
<p>See the body of a message in the mail queue</p>
<p>exim4 -Mvc <i>messageID</i></p>
<p>See a message in the mail queue</p>
<p>exim4 -qf <i>domain</i></p>
<p>Force a queue run of all queued messages for a <i>domain</i></p>
<p>exim4 -Rff <i>domain</i></p>
<p>Attempt delivery of all queued messages for a<i> domain</i></p>
<p>exim4 -bV</p>
<p>Show version and other info</p>
<p>exinext</p>
<p>Give the times of the next queue run</p>
<p>exigrep</p>
<p>Search through Exim logfiles</p>
<p>exicyclog</p>
<p>Rotate Exim logfiles</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>94/189</b></p>
<p><b>Postfix</b></p>
<p><i>Postfix</i></p>
<p>Postfix is a fast, secure, easy to configure, open source MTA intended as a replacement for Sendmail.  It is implemented as </p>
<p>a set of small helper daemons, most of which run in a chroot jail with low privileges.  The main ones are:</p>
<p>master</p>
<p>Postfix master daemon, always running; starts the other daemons when necessary</p>
<p>nqmgr</p>
<p>Queue manager for incoming and outgoing mail, always running</p>
<p>smtpd</p>
<p>SMTP daemon for incoming mail</p>
<p>smtp</p>
<p>SMTP daemon for outgoing mail</p>
<p>bounce</p>
<p>Manager of bounce messages</p>
<p>cleanup</p>
<p>Daemon that verifies the syntax of outgoing messages before they are handed to the queue manager</p>
<p>local</p>
<p>Daemon that handles local mail delivery</p>
<p>virtual</p>
<p>Daemon that handles mail delivery to virtual users</p>
<p>/var/spool/postfix/</p>
<p>incoming</p>
<p>Incoming queue.</p>
<p>All new mail entering the Postfix queue is written here by the cleanup daemon.</p>
<p>Under normal conditions this queue is nearly empty</p>
<p>active</p>
<p>Active queue.</p>
<p>Contains messages ready to be sent.  The queue manager places messages here </p>
<p>from the incoming queue as soon as they are available</p>
<p>deferred</p>
<p>Deferred queue.</p>
<p>A message is placed here when all its deliverable recipients are delivered, and </p>
<p>delivery failed for some recipients for a transient reason.  The queue manager </p>
<p>scans this queue periodically and puts some messages back into the active queue </p>
<p>to retry sending</p>
<p>bounce</p>
<p>Message delivery status report about why mail is bounced (non-delivered mail)</p>
<p>defer</p>
<p>Message delivery status report about why mail is delayed (non-delivered mail)</p>
<p>trace</p>
<p>Message delivery status report (delivered mail)</p>
<p>postfix reload</p>
<p>Reload configuration</p>
<p>postconf -e 'mydomain = example.org'</p>
<p>Edit a setting in the Postfix configuration</p>
<p>postconf -l</p>
<p>List supported mailbox lock methods</p>
<p>postconf -m</p>
<p>List supported database types</p>
<p>postconf -v</p>
<p>Increase logfile verbosity</p>
<p>postmap <i>dbtype:textfile</i></p>
<p>Manage Postfix lookup tables, creating a hashed map file of database </p>
<p>type <i>dbtype</i> from <i>textfile</i></p>
<p>postmap hash:/etc/postfix/transport</p>
<p>Regenerate the transport database</p>
<p>postalias</p>
<p>Convert </p>
<p>/etc/aliases</p>
<p> into the aliases database file </p>
<p>/etc/aliases.db</p>
<p>postsuper</p>
<p>Operate on the mail queue</p>
<p>postqueue</p>
<p>Unprivileged mail queue manager</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>95/189</b></p>
<p><b>Postfix configuration</b></p>
<p><i>Postfix configuration</i></p>
<p><b>/etc/postfix/main.cf</b></p>
<p><b>     Postfix main configuration file</b></p>
<p>mydomain = example.org</p>
<p>This system's domain</p>
<p>myorigin = $mydomain</p>
<p>Domain from which all sent mail will appear to originate</p>
<p>myhostname = foobar.$mydomain</p>
<p>This system's hostname</p>
<p>inet_interfaces = all</p>
<p>Network interface addresses that this system receives mail on.</p>
<p>Value can also be </p>
<p>localhost</p>
<p>, </p>
<p>all</p>
<p>, or </p>
<p>loopback-only</p>
<p> </p>
<p>proxy_interfaces = 1.2.3.4</p>
<p>Network interface addresses that this system receives mail on </p>
<p>by means of a proxy or NAT unit </p>
<p>mynetworks = 10.3.3.0/24 !10.3.3.66</p>
<p>Networks the SMTP clients are allowed to connect from</p>
<p>mydestination = $myhostname, localhost,</p>
<p>   $mydomain, example.com, </p>
<p>   hash:/etc/postfix/otherdomains</p>
<p>Domains for which Postfix will accept received mail.</p>
<p>Value can also be a lookup database file e.g. a hashed map</p>
<p>relayhost = 10.6.6.6</p>
<p>Relay host to which Postfix should send all mail for delivery, </p>
<p>instead of consulting DNS MX records</p>
<p>relay_domains = $mydestination</p>
<p>Sources and destinations for which mail will be relayed.</p>
<p>Can be empty if Postfix is not intended to be a mail relay</p>
<p>virtual_alias_domains = virtualex.org</p>
<p>virtual_alias_maps = /etc/postfix/virtual</p>
<p>or</p>
<p>virtual_alias_domains = hash:/etc/postfix/virtual</p>
<p>Set up Postfix to handle mail for virtual domains too.</p>
<p>The </p>
<p>/etc/postfix/virtual</p>
<p> file is a hashed map, each line of </p>
<p>the file containing the virtual domain email address and the </p>
<p>destination real domain email address: </p>
<p>jdoe@virtualex.org    john.doe@example.org  </p>
<p>  </p>
<p>  </p>
<p>ksmith@virtualex.org  kim.smith  </p>
<p>  </p>
<p>@virtualex.org        root  </p>
<p>  </p>
<p>The </p>
<p>@virtualex.org</p>
<p> in the last line is a catch-all specifying </p>
<p>that all other email messages to the virtual domain are </p>
<p>delivered to the root user on the real domain</p>
<p>mailbox_command = /usr/bin/procmail</p>
<p>Use Procmail as MDA</p>
<p>A line beginning with whitespace or tab is a continuation of the previous line.</p>
<p>A line beginning with a </p>
<p>#</p>
<p> is a comment.  A </p>
<p>#</p>
<p> not placed at the beginning of a line is not a comment delimiter.</p>
<p><b>/etc/postfix/master.cf</b></p>
<p><b>     Postfix master daemon configuration file </b></p>
<p># service type private unpriv chroot wakeup maxproc command + args</p>
<p>smtp      inet n       -      -      -      -       smtpd</p>
<p>pickup    fifo n       -      -      60     1       pickup</p>
<p>cleanup   unix n       -      -      -      0       cleanup</p>
<p>qmgr      fifo n       -      -      300    1       qmgr</p>
<p>rewrite   unix -       -      -      -      -       trivial-rewrite</p>
<p>bounce    unix -       -      -      -      0       bounce</p>
<p>defer     unix -       -      -      -      0       bounce</p>
<p>flush     unix n       -      -      1000?  0       flush</p>
<p>smtp      unix -       -      -      -      -       smtp</p>
<p>showq     unix n       -      -      -      -       showq</p>
<p>error     unix -       -      -      -      -       error</p>
<p>local     unix -       n      n      -      -       local</p>
<p>virtual   unix -       n      n      -      -       virtual</p>
<p>lmtp      unix -       -      n      -      -       lmtp</p>
<p><b>service</b></p>
<p>Name of the service</p>
<p><b>type</b></p>
<p>Transport mechanism used by the service</p>
<p><b>private</b></p>
<p>Whether the service is accessible only by Postfix daemons and not by the whole system.  Default is yes</p>
<p><b>unprivileged</b></p>
<p>Whether the service is unprivileged i.e. not running as root.  Default is yes</p>
<p><b>chroot</b></p>
<p>Whether the service is chrooted.  Default is yes</p>
<p><b>wakeup</b></p>
<p>How often the service needs to be woken up by the master daemon.  Default is never</p>
<p><b>maxproc</b></p>
<p>Max number of simultaneous processes providing the service.  Default is 50</p>
<p><b>command</b></p>
<p>Command used to start the service</p>
<p>The </p>
<p>-</p>
<p> indicates that an option is set to its default value.</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>96/189</b></p>
<p><b>Procmail</b></p>
<p><i>Procmail</i></p>
<p>Procmail is a regex-based MDA whose main purpose is to preprocess and sort incoming email messages.</p>
<p>It is able to work both with the standard mbox format and the Maildir format.</p>
<p>To have all email processed by Procmail, the </p>
<p>~/.forward</p>
<p> file may be edited to contain:</p>
<p>&quot;|exec /usr/local/bin/procmail || exit 75&quot;</p>
<p>/etc/procmailrc</p>
<p>System-wide recipes</p>
<p>~/.procmailrc</p>
<p>User's recipes</p>
<p>procmail -h</p>
<p>List all Procmail flags for recipes</p>
<p>formail</p>
<p>Utility for email filtering and editing</p>
<p>lockfile</p>
<p>Utility for mailbox file locking</p>
<p>mailstat</p>
<p>Utility for generation of reports from Procmail logs</p>
<p><b>/etc/procmailrc </b></p>
<p><b>and</b></p>
<p><b> ~/.procmailrc</b></p>
<p><b>     Procmail recipes</b></p>
<p>PATH=$HOME/bin:/usr/bin:/bin:/usr/sbin:/sbin</p>
<p>MAILDIR=$HOME/Mail</p>
<p>DEFAULT=$MAILDIR/Inbox</p>
<p>LOGFILE=$HOME/.procmaillog</p>
<p>Common parameters, nonspecific to Procmail</p>
<p>:0h: </p>
<p>or</p>
<p> :0:</p>
<p>* ^From: .*(alice|bob)@foobar\.org</p>
<p>$DEFAULT</p>
<p>Flag: match headers (default) and use file locking (highly </p>
<p>recommended when writing to a file or a mailbox in mbox format)</p>
<p>Condition: match the header specifying the sender address</p>
<p>Destination: default mailfolder</p>
<p>:0:</p>
<p>* ^From: .*owner@listserv\.com</p>
<p>* ^Subject:.*Linux</p>
<p>$MAILDIR/Geekstuff1</p>
<p>Conditions: match sender address and subject headers</p>
<p>Destination: specified mailfolder, in mbox format</p>
<p>:0</p>
<p>* ^From: .*owner@listserv\.com</p>
<p>* ^Subject:.*Linux</p>
<p>$MAILDIR/Geekstuff2/</p>
<p>Flag: file locking not necessary because using Maildir format</p>
<p>Conditions: match sender address and subject headers</p>
<p>Destination: specified mailfolder, in Maildir format</p>
<p># Blacklisted by SpamAssassin</p>
<p>:0</p>
<p>* ^X-Spam-Status: Yes</p>
<p>/dev/null </p>
<p>Flag: file locking not necessary because blackholing to </p>
<p>/dev/null</p>
<p>Condition: match SpamAssassin's specific header</p>
<p>Destination: delete the message </p>
<p>:0B:</p>
<p>* hacking</p>
<p>$MAILDIR/Geekstuff</p>
<p>Flag: match body of message instead of headers</p>
<p>:0HB:</p>
<p>* hacking</p>
<p>$MAILDIR/Geekstuff</p>
<p>Flag: match either headers or body of message</p>
<p>:0:</p>
<p>* &gt; 256000</p>
<p>| /root/myprogram</p>
<p>Condition: match messages larger than 256 Kb</p>
<p>Destination: pipe message through the specified program</p>
<p>:0fw</p>
<p>* ^From: .*@foobar\.org</p>
<p>| /root/myprogram</p>
<p>Flags: use the pipe as a filter (modifying the message), and have </p>
<p>Procmail wait that the filter finished processing the message</p>
<p>:0c   </p>
<p>* ^Subject:.*administration</p>
<p>! secretary@domain.com</p>
<p>:0:   </p>
<p>$MAILDIR/Forwarded</p>
<p>Flag: copy the message and proceed with next recipe</p>
<p>Destination: forward to specified email address, and (this is </p>
<p>ordered by the next recipe) save in the specified mailfolder</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>97/189</b></p>
<p><b>Courier POP configuration</b></p>
<p><i>Courier POP configuration</i></p>
<p>The Courier MTA provides modules for ESMTP, IMAP, POP3, webmail, and mailing list services in a single framework.</p>
<p>To use Courier, it is necessary first to launch the </p>
<p>courier-authlib</p>
<p> service, then launch the desired mail service e.g. </p>
<p>courier-imap</p>
<p> for the IMAP service.</p>
<p>/usr/lib/courier-imap/etc/</p>
<p>or</p>
<p>/etc/courier/</p>
<p>imapd</p>
<p>Courier IMAP daemon configuration</p>
<p>imapd-ssl</p>
<p>Courier IMAPS daemon configuration</p>
<p>pop3d</p>
<p>Courier POP3 daemon configuration</p>
<p>pop3d-ssl</p>
<p>Courier POP3S daemon configuration</p>
<p>/usr/lib/courier-imap/share/</p>
<p>Directory for public and private keys</p>
<p>mkimapdcert</p>
<p>Generate a certificate for the IMAPS service</p>
<p>mkpop3dcert</p>
<p>Generate a certificate for the POP3 service</p>
<p>makealiases</p>
<p>Create system aliases in </p>
<p>/usr/lib/courier/etc/aliases.dat</p>
<p>, which is </p>
<p>made by processing a </p>
<p>/usr/lib/courier/etc/aliases/system</p>
<p> text file:</p>
<p>root          : postmaster</p>
<p>mailer-daemon : postmaster</p>
<p>MAILER-DAEMON : postmaster</p>
<p>uucp          : postmaster</p>
<p>postmaster    : admin</p>
<p><b>/usr/lib/courier-imap/etc/pop3d</b></p>
<p><b>     Courier POP configuration file</b></p>
<p>ADDRESS=0</p>
<p>Address on which to listen.  0 means all addresses</p>
<p>PORT=127.0.0.1.900,192.168.0.1.900</p>
<p>Port number on which connections are accepted.  In this case, accept </p>
<p>connections on port 900 on IP addresses 127.0.0.1 and 192.168.0.1</p>
<p>POP3AUTH=&quot;LOGIN CRAM-MD5 CRAM-SHA1&quot;</p>
<p>POP authentication advertising SASL (Simple Authentication and </p>
<p>Security Layer) capability, with CRAM-MD5 and CRAM-SHA1</p>
<p>POP3AUTH_TLS=&quot;LOGIN PLAIN&quot;</p>
<p>Also advertise SASL PLAIN if SSL is enabled</p>
<p>MAXDAEMONS=40</p>
<p>Maximum number of POP3 servers started</p>
<p>MAXPERIP=4</p>
<p>Maximum number of connections to accept from the same IP address</p>
<p>PIDFILE=/var/run/courier/pop3d.pid</p>
<p>PID file</p>
<p>TCPDOPTS=&quot;-nodnslookup -noidentlookup&quot;</p>
<p>Miscellaneous </p>
<p>couriertcpd</p>
<p> options.  Should not be changed</p>
<p>LOGGEROPTS=&quot;-name=pop3d&quot;</p>
<p>Options for </p>
<p>courierlogger</p>
<p>POP3_PROXY=0</p>
<p>Enable or disable proxying</p>
<p>PROXY_HOSTNAME=myproxy</p>
<p>Override value from </p>
<p>gethostname()</p>
<p> when checking if a proxy </p>
<p>connection is required</p>
<p>DEFDOMAIN=&quot;@example.com&quot;</p>
<p>Optional default domain.  If the username does not contain the first </p>
<p>character of </p>
<p>DEFDOMAIN</p>
<p>, then it is appended to the username.  If </p>
<p>DEFDOMAIN</p>
<p> and </p>
<p>DOMAINSEP</p>
<p> are both set, then </p>
<p>DEFDOMAIN</p>
<p> is appended </p>
<p>only if the username does not contain any character from </p>
<p>DOMAINSEP</p>
<p>POP3DSTART=YES</p>
<p>Flag intended to be read by the system startup script</p>
<p>MAILDIRPATH=Maildir</p>
<p>Maildir directory</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>98/189</b></p>
<p><b>Courier IMAP configuration</b></p>
<p><i>Courier IMAP configuration</i></p>
<p><b>/usr/lib/courier-imap/etc/imapd</b></p>
<p><b>     Courier IMAP configuration file</b></p>
<p>ADDRESS=0</p>
<p>Address on which to listen.  0 means all addresses</p>
<p>PORT=127.0.0.1.900,192.168.0.1.900</p>
<p>Port number on which connections are accepted.  In this case, accept </p>
<p>connections on port 900 on IP addresses 127.0.0.1 and 192.168.0.1</p>
<p>AUTHSERVICE143=imap</p>
<p>Authenticate using a different </p>
<p>service</p>
<p> parameter depending on the </p>
<p>connection's port.  This only works with authentication modules that </p>
<p>use the </p>
<p>service</p>
<p> parameter, such as PAM</p>
<p>MAXDAEMONS=40</p>
<p>Maximum number of IMAP servers started</p>
<p>MAXPERIP=20</p>
<p>Maximum number of connections to accept from the same IP address</p>
<p>PIDFILE=/var/run/courier/imapd.pid</p>
<p>PID file for </p>
<p>couriertcpd</p>
<p>TCPDOPTS=&quot;-nodnslookup -noidentlookup&quot;</p>
<p>Miscellaneous </p>
<p>couriertcpd</p>
<p> options.  Should not be changed</p>
<p>LOGGEROPTS=&quot;-name=imapd&quot;</p>
<p>Options for </p>
<p>courierlogger</p>
<p>DEFDOMAIN=&quot;@example.com&quot;</p>
<p>Optional default domain.  If the username does not contain the first </p>
<p>character of </p>
<p>DEFDOMAIN</p>
<p>, then it is appended to the username.  If </p>
<p>DEFDOMAIN</p>
<p> and </p>
<p>DOMAINSEP</p>
<p> are both set, then </p>
<p>DEFDOMAIN</p>
<p> is appended </p>
<p>only if the username does not contain any character from </p>
<p>DOMAINSEP</p>
<p>IMAP_CAPABILITY=&quot;IMAP4rev1 UIDPLUS \ </p>
<p>CHILDREN NAMESPACE THREAD=ORDEREDSUBJECT \</p>
<p>THREAD=REFERENCES SORT QUOTA IDLE&quot;</p>
<p>Specifies what most of the response should be to the CAPABILITY </p>
<p>command</p>
<p>IMAP_KEYWORDS=1</p>
<p>Enable or disable custom IMAP keywords.  Possible values are:</p>
<p>0  </p>
<p>disable keywords</p>
<p>1  </p>
<p>enable keywords</p>
<p>2  </p>
<p>enable keywords with a slower algorithm</p>
<p>IMAP_ACL=1</p>
<p>Enable or disable IMAP ACL extension</p>
<p>SMAP_CAPABILITY=SMAP1</p>
<p>Enable the experimental Simple Mail Access Protocol extensions</p>
<p>IMAP_PROXY=0</p>
<p>Enable or disable proxying</p>
<p>IMAP_PROXY_FOREIGN=0</p>
<p>Proxying to non-Courier servers.  Resends the CAPABILITY command </p>
<p>after logging in to remote server.  May not work with all IMAP clients</p>
<p>IMAP_IDLE_TIMEOUT=60</p>
<p>How often, in seconds, the server should poll for changes to the folder</p>
<p>while in IDLE mode</p>
<p>IMAP_CHECK_ALL_FOLDERS=0</p>
<p>Enable or disable server check for mail in every folder</p>
<p>IMAP_UMASK=022</p>
<p>Set the umask of the server process.  This value is passed to the </p>
<p>umask</p>
<p> command.  Mostly useful for shared folders, where file </p>
<p>permissions of the messages may be important</p>
<p>IMAP_ULIMITD=131072</p>
<p>Set the upper limit of the size of the data segment of the server </p>
<p>process, in Kb.  This value is passed to the </p>
<p>ulimit -d</p>
<p> command.</p>
<p>Used as an additional safety check to stop potential DoS attacks that </p>
<p>exploit memory leaks to exhaust all the available RAM on the server</p>
<p>IMAP_USELOCKS=1</p>
<p>Enable or disable dot-locking to support concurrent multiple access to</p>
<p>the same folder.  Strongly recommended when using shared folders</p>
<p>IMAP_SHAREDINDEXFILE=\</p>
<p>/etc/courier/shared/index</p>
<p>Index of all accessible folders.</p>
<p>This setting should normally not be changed</p>
<p>IMAP_TRASHFOLDERNAME=Trash</p>
<p>Trash folder</p>
<p>IMAP_EMPTYTRASH=Trash:7,Sent:30</p>
<p>Purge folders i.e. delete all messages from the specified folders after </p>
<p>the specified number of days</p>
<p>IMAP_MOVE_EXPUNGE_TO_TRASH=0</p>
<p>Enable or disable moving expunged messages to the trash folder </p>
<p>(instead of directly deleting them)</p>
<p>HEADERFROM=X-IMAP-Sender</p>
<p>Save the return address (</p>
<p>$SENDER</p>
<p>) in the </p>
<p>X-IMAP-Sender</p>
<p> mail </p>
<p>header.  This header is added to the sent message, but not in the </p>
<p>copy of the message saved in the folder</p>
<p>MAILDIRPATH=Maildir</p>
<p>Mail directory</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>99/189</b></p>
<p><b>Dovecot</b></p>
<p><i>Dovecot</i></p>
<p>Dovecot is an open source, security-hardened, fast, and efficient IMAP and POP3 server.</p>
<p>It implements its own high-performance dbox mailbox format.  By default, it uses PAM authentication.</p>
<p>The script </p>
<p>mkcert.sh</p>
<p> can be used to create self-signed SSL certificates.</p>
<p><b>/etc/dovecot.conf</b></p>
<p><b>     Dovecot configuration file</b></p>
<p>base_dir = /var/run/dovecot/</p>
<p>Base directory where to store runtime data</p>
<p>protocols = imaps pop3s</p>
<p>Protocols to serve.</p>
<p>If Dovecot should use </p>
<p>dovecot-auth</p>
<p>, this can be set to </p>
<p>none</p>
<p>listen = *, [::]</p>
<p>Network interfaces on which to accept connections.</p>
<p>In this case, listen to all IPv4 and IPv6 interfaces</p>
<p>disable_plaintext_auth = yes</p>
<p>If yes, disable LOGIN command and all other plaintext authentications </p>
<p>unless SSL/TLS is used (LOGINDISABLED capability)</p>
<p>shutdown_clients = yes</p>
<p>If yes, kill all IMAP and POP3 processes when Dovecot master process </p>
<p>shuts down; if no, Dovecot can be upgraded without forcing existing </p>
<p>client connections to close</p>
<p>log_path = /dev/stderr</p>
<p>Log file to use for error messages, instead of sending them to syslog.</p>
<p>In this case, log to stderr</p>
<p>info_log_path = /dev/stderr</p>
<p>Log file to use for informational and debug messages.</p>
<p>Default value is the same as </p>
<p>log_path</p>
<p>syslog_facility = mail</p>
<p>Syslog facility to use, if logging to syslog</p>
<p>login_dir = /var/run/dovecot/login</p>
<p>Directory where the authentication process places authentication UNIX </p>
<p>sockets.  The login process needs to be able to connect to these sockets</p>
<p>login_chroot = yes</p>
<p>Chroot login process to the </p>
<p>login_dir</p>
<p>login_user = dovecot</p>
<p>User for the login process and for access control in the authentication </p>
<p>process.  This is not the user that will access mail messages</p>
<p>login_process_size = 64</p>
<p>Maximum login process size, in Mb</p>
<p>login_process_per_connection = yes</p>
<p>If yes, each login is processed in its own process (more secure);</p>
<p>if no, each login process processes multiple connections (faster)</p>
<p>login_processes_count = 3</p>
<p>Number of login processes to keep for listening for new connections</p>
<p>login_max_processes_count = 128</p>
<p>Maximum number of login processes to create</p>
<p>login_max_connections = 256</p>
<p>Maximum number of connections allowed per each login process.</p>
<p>This setting is used only if </p>
<p>login_process_per_connection = no</p>
<p>; once</p>
<p>the limit is reached, the process notifies master so that it can create a </p>
<p>new login process</p>
<p>login_greeting = Dovecot ready.</p>
<p>Greeting message for clients</p>
<p>login_trusted_networks = \</p>
<p>10.7.7.0/24 10.8.8.0/24</p>
<p>Trusted network ranges (usually IMAP proxy servers).</p>
<p>Connections from these IP addresses are allowed to override their IP </p>
<p>addresses and ports, for logging and authentication checks.</p>
<p>disable_plaintext_auth</p>
<p> is also ignored for these networks</p>
<p>mbox_read_locks = fcntl</p>
<p>mbox_write_locks = dotlock fcntl</p>
<p>Locking methods to use for locking mailboxes in mbox format.</p>
<p>Possible values are:</p>
<p>dotlock      </p>
<p>Create </p>
<p><i>mailbox</i>.lock</p>
<p> file; oldest and NSF-safe method</p>
<p>dotlock_try  </p>
<p>Same as </p>
<p>dotlock</p>
<p>, but skip if failing</p>
<p>fcntl        </p>
<p>Recommended; works with NFS too if </p>
<p>lockd</p>
<p> is used</p>
<p>flock        </p>
<p>May not exist in all systems; doesn't work with NFS</p>
<p>lockf        </p>
<p>May not exist in all systems; doesn't work with NFS</p>
<p>maildir_stat_dirs = no</p>
<p>Option for mailboxes in Maildir format.  If no (default), the LIST </p>
<p>command returns all entries in the mail directory beginning with a dot; </p>
<p>if yes, returns only entries which are directories</p>
<p>dbox_rotate_size = 2048</p>
<p>dbox_rotate_min_size = 16</p>
<p>Maximum and minimum file size, in Kb, of a mailbox in dbox format </p>
<p>until it is rotated</p>
<p>!include /etc/dovecot/conf.d/*.conf</p>
<p>Include configuration file</p>
<p>!include_try /etc/dovecot/extra.conf</p>
<p>Include optional configuration file, and do not report an error if file is </p>
<p>not found</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>100/189</b></p>
<p><b>Dovecot mailbox configuration</b></p>
<p><i>Dovecot mailbox configuration</i></p>
<p><b>/etc/dovecot.conf</b></p>
<p><b>     Dovecot configuration file</b></p>
<p>mail_location = \</p>
<p>mbox:~/mail:INBOX=/var/spool/mail/%u</p>
<p>or</p>
<p>mail_location = maildir:~/Maildir</p>
<p>Mailbox location, in mbox or Maildir format.  Variables:</p>
<p>%u  </p>
<p>username</p>
<p>%n  </p>
<p>user part in <i>user@domain</i>, same as </p>
<p>%u</p>
<p> if there is no domain</p>
<p>%d  </p>
<p>domain part in <i>user@domain</i>, empty if there is no domain</p>
<p>%h  </p>
<p>home directory</p>
<p>namespace shared {</p>
<p>Definition of a shared namespace, for accessing other users' mailboxes </p>
<p>that have been shared.</p>
<p>Private namespaces are for users' personal emails.</p>
<p>Public namespaces are for shared mailboxes managed by root user</p>
<p>   separator = /</p>
<p>Hierarchy separator to use.  It should be the same for all namespaces, </p>
<p>and depends on the underlying mail storage format</p>
<p>   prefix = shared/%%u/</p>
<p>Prefix required to access this namespace; must be different for each.</p>
<p>In this case, mailboxes are visible under </p>
<p>shared/<i>user@domain</i>/</p>
<p>;</p>
<p>the variables </p>
<p>%%n</p>
<p>, </p>
<p>%%d</p>
<p>, and </p>
<p>%%u</p>
<p> are expanded to the destination user</p>
<p>   location = maildir:%%h/Maildir:\</p>
<p>      INDEX=~/Maildir/shared/%%u</p>
<p>Mailbox location for other users' mailboxes; it is in the same format as </p>
<p>mail_location</p>
<p> which is also the default for it.</p>
<p>%<i>variable</i></p>
<p> and </p>
<p>~/</p>
<p> expand to the logged in user's data;</p>
<p>%%<i>variable</i></p>
<p> expands to the destination user's data</p>
<p>   inbox = no</p>
<p>Define whether this namespace contains the INBOX.  Note that there </p>
<p>can be only one INBOX across all namespaces</p>
<p>   hidden = no</p>
<p>Define whether the namespace is hidden i.e. not advertised to clients </p>
<p>via NAMESPACE extension</p>
<p>   subscriptions = no</p>
<p>Namespace handles its own subscriptions; if set to no, the parent</p>
<p>namespace handles them and Dovecot uses the default namespace for </p>
<p>saving subscriptions.  If </p>
<p>prefix</p>
<p> is empty, this should be set to yes</p>
<p>   list = children</p>
<p>Show the mailboxes under this namespace with LIST command, </p>
<p>making the namespace visible for clients that do not support the </p>
<p>NAMESPACE extension.</p>
<p>In this case, lists child mailboxes but hide the namespace prefix; list </p>
<p>the namespace only if there are visible shared mailboxes</p>
<p>}</p>
<p>mail_uid = 666</p>
<p>mail_gid = 666</p>
<p>UID and GID used to access mail messages</p>
<p>mail_privileged_group = mail</p>
<p>Group to enable temporarily for privileged operations.  Currently this is</p>
<p>used only with INBOX when its initial creation or a dotlocking fails</p>
<p>mail_access_groups = tmpmail</p>
<p>Supplementary groups to with grant access for mail processes.</p>
<p>Used typically to set up access to shared mailboxes</p>
<p>lock_method = fcntl</p>
<p>Locking method for index files.  Can be </p>
<p>fcntl</p>
<p>, </p>
<p>flock</p>
<p>, or </p>
<p>dotlock</p>
<p>first_valid_uid = 500</p>
<p>last_valid_uid = 0</p>
<p>Valid UID range for users; default is 500 and above.  This makes sure </p>
<p>that users cannot login as daemons or other system users.</p>
<p>Denying root login is hardcoded to Dovecot and cannot be bypassed</p>
<p>first_valid_gid = 1</p>
<p>last_valid_gid = 0</p>
<p>Valid GID range for users; default is non-root.</p>
<p>Users with invalid primary GID are not allowed to login</p>
<p>max_mail_processes = 512</p>
<p>Maximum number of running mail processes.</p>
<p>When this limit is reached, new users are not allowed to login</p>
<p>mail_process_size = 256</p>
<p>Maximum mail process size, in Mb</p>
<p>valid_chroot_dirs =</p>
<p>List of directories under which chrooting is allowed for mail processes</p>
<p>mail_chroot =</p>
<p>Default chroot directory for mail processes.  Usually not needed as </p>
<p>Dovecot does not allow users to access files outside their mail directory</p>
<p>mailbox_idle_check_interval = 30</p>
<p>Minimum time, in seconds, to wait between mailbox checks.</p>
<p>When the IDLE command is running, mailbox is checked periodically for</p>
<p>new mails or other changes</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>101/189</b></p>
<p><b>Dovecot POP/IMAP configuration</b></p>
<p><i>Dovecot POP/IMAP configuration</i></p>
<p><b>/etc/dovecot.conf</b></p>
<p><b>     Dovecot configuration file</b></p>
<p>protocol pop3 {</p>
<p>Block with options for the POP3 protocol</p>
<p>   listen = *:110</p>
<p>Network interfaces on which to accept POP3 connections</p>
<p>   login_executable = /usr/libexec/dovecot/pop3-login</p>
<p>Location of the POP3 login executable</p>
<p>   mail_executable = /usr/libexec/dovecot/pop3</p>
<p>Location of the POP3 mail executable</p>
<p>   pop3_no_flag_updates = no</p>
<p>If set to no, do not try to set mail messages non-recent </p>
<p>or seen with POP3 sessions, to reduce disk I/O.</p>
<p>With Maildir format do not move files from </p>
<p>new/</p>
<p> to </p>
<p>cur/</p>
<p>;</p>
<p>with mbox format do not write </p>
<p>Status-</p>
<p> headers</p>
<p>   pop3_lock_session = no</p>
<p>Defines whether to keep the mailbox locked for the </p>
<p>whole POP3 session</p>
<p>   pop3_uidl_format = %08Xu%08Xv</p>
<p>POP3 UIDL (Unique Mail Identifier) format to use</p>
<p>}</p>
<p>protocol imap {</p>
<p>Block with options for the IMAP protocol</p>
<p>   listen = *:143</p>
<p>   ssl_listen = *:993</p>
<p>Network interfaces on which to accept IMAP and IMAPS </p>
<p>connections </p>
<p>   login_executable = /usr/libexec/dovecot/imap-login</p>
<p>Location of the IMAP login executable</p>
<p>   mail_executable = /usr/libexec/dovecot/imap</p>
<p>Location of the IMAP mail executable</p>
<p>   mail_max_userip_connections = 10</p>
<p>Maximum number of IMAP connections allowed for a </p>
<p>user from each IP address</p>
<p>   imap_idle_notify_interval = 120</p>
<p>Waiting time, in seconds, between &quot;OK Still here&quot; </p>
<p>notifications when client is IDLE</p>
<p>}</p>
<p>ssl = yes</p>
<p>SSL/TLS support.  </p>
<p>Possible values are </p>
<p>yes</p>
<p>, </p>
<p>no</p>
<p>, </p>
<p>required</p>
<p>ssl_cert_file = /etc/ssl/certs/dovecot-cert.pem</p>
<p>Location of the SSL certificate</p>
<p>ssl_key_file = /etc/ssl/private/dovecot-key.pem</p>
<p>Location of private key</p>
<p>ssl_key_password = p4ssw0rd</p>
<p>Password of private key, if it is password-protected.</p>
<p>Since </p>
<p>/etc/dovecot.conf</p>
<p> is usually world-readable, it is</p>
<p>better to place this setting into a root-owned 0600 file </p>
<p>instead and include it via the setting</p>
<p>!include_try /etc/dovecot/dovecot-passwd.conf</p>
<p>.</p>
<p>Alternatively, Dovecot can be started with</p>
<p>dovecot -p p4ssw0rd</p>
<p>ssl_ca_file = /etc/dovecot/cafile.pem</p>
<p>List of trusted SSL certificate authorities.</p>
<p>This file contains CA certificates followed by CRLs</p>
<p>ssl_verify_client_cert = yes</p>
<p>Request client to send a certificate</p>
<p>ssl_cipher_list = ALL:!LOW:!SSLv2</p>
<p>List of SSL ciphers to use</p>
<p>verbose_ssl = yes</p>
<p>Show protocol level SSL errors</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>102/189</b></p>
<p><b>Dovecot authentication</b></p>
<p><i>Dovecot authentication</i></p>
<p><b>/etc/dovecot.conf</b></p>
<p><b>     Dovecot configuration file</b></p>
<p>auth_executable = /usr/libexec/dovecot/dovecot-auth</p>
<p>Location of the authentication executable</p>
<p>auth_process_size = 256</p>
<p>Max authentication process size, in Mb</p>
<p>auth_username_chars = abcde</p>
<p> ... </p>
<p>VWXYZ01234567890.-_@</p>
<p>List of allowed characters in the username.  If the </p>
<p>username entered by the user contains a character not </p>
<p>listed in here, the login automatically fails.  This is to </p>
<p>prevent a user exploiting any potential quote-escaping </p>
<p>vulnerabilities with SQL/LDAP databases</p>
<p>auth_realms =</p>
<p>List of realms for SASL authentication mechanisms that </p>
<p>need them.  If empty, multiple realms are not supported</p>
<p>auth_default_realm = example.org</p>
<p>Default realm/domain to use if none was specified</p>
<p>auth_anonymous_username = anonymous</p>
<p>Username to assign to users logging in with ANONYMOUS</p>
<p>SASL mechanism</p>
<p>auth_verbose = no</p>
<p>Defines whether to log unsuccessful authentication </p>
<p>attempts and the reasons why they failed</p>
<p>auth_debug = no</p>
<p>Define whether to enable more verbose logging (e.g. SQL</p>
<p>queries) for debugging purposes</p>
<p>auth_failure_delay = 2</p>
<p>Delay before replying to failed authentications, in seconds</p>
<p>auth default {</p>
<p>   mechanisms = plain login cram-md5</p>
<p>Accepted authentication mechanisms</p>
<p>   passdb passwd-file {</p>
<p>      args = /etc/dovecot.deny</p>
<p>      deny = yes</p>
<p>   }</p>
<p>Deny login to the users listed in </p>
<p>/etc/dovecot.deny</p>
<p> </p>
<p>(this file contains one user per line)</p>
<p>   passdb pam {</p>
<p>      args = cache_key=%u%r dovecot</p>
<p>   }</p>
<p>PAM authentication block.</p>
<p>Enables authentication matching (username and remote </p>
<p>IP address) for PAM</p>
<p>   passdb passwd {</p>
<p>      blocking = yes</p>
<p>      args = </p>
<p>   }</p>
<p>System users e.g. NSS or </p>
<p>/etc/passwd</p>
<p>   passdb shadow {</p>
<p>      blocking = yes</p>
<p>      args = </p>
<p>   }</p>
<p>Shadow passwords for system users, e.g. NSS or </p>
<p>/etc/passwd</p>
<p>   passdb bsdauth {</p>
<p>      cache_key = %u</p>
<p>      args =</p>
<p>   }</p>
<p>PAM-like authentication for OpenBSD</p>
<p>   passdb sql {</p>
<p>      args = /etc/dovecot/dovecot-sql.conf </p>
<p>   }</p>
<p>SQL database</p>
<p>   passdb ldap {</p>
<p>      args = /etc/dovecot/dovecot-ldap.conf </p>
<p>   }</p>
<p>LDAP database</p>
<p>   socket listen {</p>
<p>      master {</p>
<p>         path = /var/run/dovecot/auth-master</p>
<p>         mode = 0600</p>
<p>         user = </p>
<p>         group = </p>
<p>      }</p>
<p>      client {</p>
<p>         path = /var/run/dovecot/auth-client</p>
<p>         mode = 0660</p>
<p>      }</p>
<p>   }</p>
<p>Export the authentication interface to other programs.</p>
<p>Master socket provides access to userdb information, and </p>
<p>is typically used to give Dovecot's local delivery agent </p>
<p>access to userdb so it can find mailbox locations.  The </p>
<p>default user/group is the one who started </p>
<p>dovecot-auth</p>
<p> </p>
<p>(i.e. root).</p>
<p>The client socket is generally safe to export to everyone. </p>
<p>Typical use is to export it to the SMTP server so it can do </p>
<p>SMTP AUTH lookups using it</p>
<p>}</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>103/189</b></p>
<p><b>FTP</b></p>
<p><i>FTP</i></p>
<p>FTP (File Transfer Protocol) is a client-server unencrypted protocol for file transfer.  Secure alternatives are FTPS (FTP </p>
<p>secured with SSL/TLS) and SFTP (SSH File Transfer Protocol).  It can operate either in active or in passive mode.</p>
<p><b>Active mode</b> (default)</p>
<p>1.  Client connects to FTP server on port 21 (control channel) and sends second unprivileged port number</p>
<p>2.  Server acknowledges</p>
<p>3.  Server connects from port 20 (data channel) to client's second unprivileged port number</p>
<p>4.  Client acknowledges</p>
<p><b>Passive mode</b> (more protocol-compliant, because it is the client that initiates the connection)</p>
<p>1.  Client connects to FTP server on port 21 and requests passive mode via the PASV command</p>
<p>2.  Server acknowledges and sends unprivileged port number via the PORT command</p>
<p>3.  Client connects to server's unprivileged port number</p>
<p>4.  Server acknowledges</p>
<p><b>FTP servers</b></p>
<p>Very Secure FTP</p>
<p>Hardened and high-performance FTP implementation.  The </p>
<p>vsftpd</p>
<p> daemon operates with multiple </p>
<p>processes that run as a non-privileged user in a chrooted jail</p>
<p>Pure-FTP</p>
<p>Free and easy-to-use FTP server</p>
<p>pure-ftpd</p>
<p>Pure-FTP daemon</p>
<p>pure-ftpwho</p>
<p>Show clients connected to the Pure-FTP server</p>
<p>pure-mrtginfo</p>
<p>Show connections to the Pure-FTP server as a MRTG graph</p>
<p>pure-statsdecode</p>
<p>Show Pure-FTP log data</p>
<p>pure-pw</p>
<p>Manage Pure-FTP virtual accounts</p>
<p>pure-pwconvert</p>
<p>Convert the system user database to a Pure-FTP virtual accounts database</p>
<p>pure-quotacheck</p>
<p>Manage Pure-FTP quota database</p>
<p>pure-uploadscript</p>
<p>Run a command on the Pure-FTP server to process an uploaded file</p>
<p><b>FTP clients</b></p>
<p>ftp</p>
<p>Standard FTP client</p>
<p>ftp <i>ftpserver.domain.com</i></p>
<p>Connect to an FTP server</p>
<p>lftp</p>
<p>Sophisticated FTP client with support for HTTP and BitTorrent</p>
<p>lftp <i>ftpserver.domain.com</i></p>
<p>Connect to an FTP server and try an anonymous login</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>104/189</b></p>
<p><b>vsftpd</b></p>
<p><i>vsftpd</i></p>
<p><b>/etc/vsftpd/vsftpd.conf</b></p>
<p><b>     Very Secure FTP server configuration file</b></p>
<p>listen=NO</p>
<p>Run </p>
<p>vsftpd</p>
<p> in standalone mode (i.e. not via inetd)?</p>
<p>local_enable=YES</p>
<p>Allow local system users (i.e. in </p>
<p>/etc/passwd</p>
<p>) to log in?</p>
<p>chroot_local_user=YES</p>
<p>Chroot local users in their home directory?</p>
<p>write_enable=YES</p>
<p>Allow FTP commands that write on the filesystem (i.e. </p>
<p>STOR, DELE, RNFR, RNTO, MKD, RMD, APPE, and SITE)?</p>
<p>anonymous_enable=YES</p>
<p>Allow anonymous logins?  If yes, </p>
<p>anonymous</p>
<p> and </p>
<p>ftp</p>
<p> are </p>
<p>accepted as logins</p>
<p>anon_root=/var/ftp/pub</p>
<p>Directory to go after anonymous login</p>
<p>anon_upload_enable=YES</p>
<p>Allow anonymous uploads?</p>
<p>chown_uploads=YES</p>
<p>Change ownership of anonymously uploaded files?</p>
<p>chown_username=ftp</p>
<p>User to whom set ownership of anonymously uploaded </p>
<p>files</p>
<p>anon_world_readable_only=NO</p>
<p>Allow anonymous users to only download world-readable </p>
<p>files?</p>
<p>ssl_enable=YES</p>
<p>Enable SSL?</p>
<p>force_local_data_ssl=NO</p>
<p>Encrypt local data?</p>
<p>force_local_logins_ssl=YES</p>
<p>Force encrypted authentication?</p>
<p>allow_anon_ssl=YES</p>
<p>Allow anonymous users to use SSL?</p>
<p>ssl_tlsv1=YES</p>
<p>ssl_tlsv2=NO</p>
<p>ssl_tlsv3=NO</p>
<p>Allowed SSL/TLS versions</p>
<p>rsa_cert_file=/etc/pki/tls/certs/vsftpd.pem</p>
<p>Location of certificate file</p>
<p>rsa_private_key_file=/etc/pki/tls/certs/vsftpd.pem</p>
<p>Location of private key file</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>105/189</b></p>
<p><b>CUPS</b></p>
<p><i>CUPS</i></p>
<p>In Linux, printers are managed by </p>
<p>cupsd</p>
<p>, the CUPS (Common Unix Printing System) daemon.</p>
<p>Printers are administered via a web interface on the URL http://localhost:631.</p>
<p>/etc/cups/cupsd.conf</p>
<p>CUPS configuration file</p>
<p>/etc/cups/printers.conf</p>
<p>Database of available local CUPS printers</p>
<p>/etc/printcap</p>
<p>Database of printer capabilities, for old printing applications</p>
<p>/var/spool/cups/</p>
<p>Printer spooler for data awaiting to be printed</p>
<p>/var/log/cups/error_log</p>
<p>CUPS error log</p>
<p>/var/log/cups/page_log</p>
<p>Information about printed pages</p>
<p>/etc/init.d/cupsys start</p>
<p>Start the CUPS service</p>
<p>gnome-cups-manager</p>
<p>Run the CUPS Manager graphical application</p>
<p>cupsenable <i>printer0</i></p>
<p>Enable a CUPS printer</p>
<p>cupsdisable <i>printer0</i></p>
<p>Disable a CUPS printer</p>
<p>cupsaccept <i>printer0</i></p>
<p>Accept a job sent on a printer queue</p>
<p>cupsreject -r &quot;<i>Message</i>&quot; <i>printer0</i></p>
<p>Reject a job sent on a printer queue, with an informational message</p>
<p>cupstestppd <i>LEXC510.ppd</i></p>
<p>Test the conformance of a PPD file to the format specification</p>
<p>cupsaddsmb <i>printer0</i></p>
<p>Export a printer to Samba (for use with Windows clients)</p>
<p>cups-config --cflags</p>
<p>Show the necessary compiler options</p>
<p>cups-config --datadir</p>
<p>Show the default CUPS data directory</p>
<p>cups-config --ldflags</p>
<p>Show the necessary linker options</p>
<p>cups-config --libs</p>
<p>Show the necessary libraries to link to</p>
<p>cups-config --serverbin</p>
<p>Show the default CUPS binaries directory that stores filters and backends</p>
<p>cups-config --serverroot</p>
<p>Show the default CUPS configuration file directory</p>
<p>lpstat</p>
<p>Show CUPS status information</p>
<p>lpadmin</p>
<p>Administer CUPS printers</p>
<p>lpadmin -p <i>printer0</i> -P <i>LEXC750.ppd</i></p>
<p>Specify a PPD (Adobe PostScript Printer Description) file to associate to a printer</p>
<p>lp -d <i>printer0</i> <i>file</i></p>
<p>Print a file on the specified printer</p>
<p>lpq</p>
<p>View the default print queue</p>
<p>lpq -P <i>printer0</i></p>
<p>View a specific print queue</p>
<p>lpq <i>user</i></p>
<p>View the print queue of a specific user</p>
<p>lprm -P <i>printer0</i> <i>jobnumber</i></p>
<p>Delete a specific job from a printer queue</p>
<p>lprm -P <i>printer0</i> <i>user</i></p>
<p>Delete all jobs from a specific user from a printer queue</p>
<p>lprm -P <i>printer0</i> -</p>
<p>Delete all jobs from a printer queue</p>
<p>lpc</p>
<p>Manage print queues </p>
<p>a2ps <i>file.txt</i></p>
<p>Convert a text file to PostScript </p>
<p>ps2pdf <i>file.ps</i></p>
<p>Convert a file from PostScript to PDF</p>
<p>mpage <i>file.ps</i></p>
<p>Print a PostScript document on multiple pages per sheet on a PostScript printer</p>
<p>gv <i>file.ps</i></p>
<p>View a PostScript document (the </p>
<p>gv</p>
<p> software is a derivation of GhostView)</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>106/189</b></p>
<p><b>IP addressing</b></p>
<p><i>IP addressing</i></p>
<p><b>IPv4 addressing</b></p>
<p><b>Address range</b></p>
<p><b>Prefix</b></p>
<p><b>Number of addresses</b></p>
<p><b>Reference</b></p>
<p>Classful</p>
<p>Class A (Unicast)</p>
<p>0.0.0.0 – 127.255.255.255</p>
<p>first octet: 0XXX XXXX</p>
<p>/8</p>
<p>128 networks ×</p>
<p>16,777,216 addresses </p>
<p>RFC 791</p>
<p>Class B (Unicast)</p>
<p>128.0.0.0 – 191.255.255.255</p>
<p>first octet: 10XX XXXX</p>
<p>/16</p>
<p>16,384 networks ×</p>
<p>65,536 addresses</p>
<p>RFC 791</p>
<p>Class C (Unicast)</p>
<p>192.0.0.0 – 223.255.255.255</p>
<p>first octet: 110X XXXX</p>
<p>/24</p>
<p>2,097,152 networks ×</p>
<p>256 addresses</p>
<p>RFC 791</p>
<p>Class D (Multicast)</p>
<p>224.0.0.0 – 239.255.255.255</p>
<p>first octet: 1110 XXXX</p>
<p>/4</p>
<p>268,435,456 </p>
<p>RFC 3171</p>
<p>Class E (Experimental)</p>
<p>240.0.0.0 – 255.255.255.255</p>
<p>first octet: 1111 XXXX</p>
<p>/4</p>
<p>268,435,456 </p>
<p>RFC 1166</p>
<p>Private</p>
<p>Private Class A</p>
<p>10.0.0.0 – 10.255.255.255</p>
<p>10.0.0.0/8</p>
<p>16,777,216</p>
<p>RFC 1918</p>
<p>Private Class B</p>
<p>172.16.0.0 – 172.31.255.255</p>
<p>172.16.0.0/12</p>
<p>1,048,576</p>
<p>RFC 1918</p>
<p>Private Class C</p>
<p>192.168.0.0 – 192.168.255.255</p>
<p>192.168.0.0/16</p>
<p>65,536</p>
<p>RFC 1918</p>
<p>Reserved</p>
<p>Source</p>
<p>0.0.0.0 – 0.255.255.255</p>
<p>0.0.0.0/8</p>
<p>16,777,216</p>
<p>RFC 1700</p>
<p>Loopback</p>
<p>127.0.0.0 – 127.255.255.255</p>
<p>127.0.0.0/8</p>
<p>16,777,216</p>
<p>RFC 1700</p>
<p>Autoconf</p>
<p>169.254.0.0 – 169.254.255.255</p>
<p>169.254.0.0/16</p>
<p>65,536</p>
<p>RFC 3330</p>
<p>TEST-NET</p>
<p>192.0.2.0 – 192.0.2.255</p>
<p>192.0.2.0/24</p>
<p>256</p>
<p>RFC 3330</p>
<p>6to4 relay anycast</p>
<p>192.88.99.0 – 192.88.99.255</p>
<p>192.88.99.0/24</p>
<p>256</p>
<p>RFC 3068</p>
<p>Device benchmarks</p>
<p>198.18.0.0 – 198.19.255.255</p>
<p>198.18.0.0/15</p>
<p>131,072</p>
<p>RFC 2544</p>
<p>An IPv4 address is 32-bit long, and is represented divided in four octets (dotted-quad notation), e.g. 193.22.33.44.</p>
<p>There are approximately 4×10</p>
<p>9</p>
<p> total possible IPv4 addresses.</p>
<p>IPv4 classful addressing is obsolete and has been replaced by CIDR (Classless Inter-Domain Routing).</p>
<p><b>IPv6 addressing</b></p>
<p>Unicast</p>
<p>64-bit network prefix (&gt;= 48-bit routing prefix + &lt;= 16-bit subnet id) + 64-bit interface identifier</p>
<p>A 48-bit MAC address is transformed into a 64-bit EUI-64 by inserting ff:fe in the middle.</p>
<p>A EUI-64 is then transformed into an IPv6 interface identifier by inverting the 7</p>
<p>th</p>
<p> most significant bit. </p>
<p>Link-local</p>
<p>fe80:0000:0000:0000 + 64-bit interface identifier</p>
<p>Multicast</p>
<p>ff + 4-bit flag + 4-bit scope field + 112-bit group ID</p>
<p>An IPv6 address is 128-bit long, and is represented divided in eight 16-bit groups (4 hex digits).</p>
<p>Leading zeros in each group can be deleted.  A single chunk of one or more adjacent 0000 groups can be deleted.</p>
<p>e.g. 2130:0000:0000:0000:0007:0040:15bc:235f which can also be written as 2130::7:40:15bc:235f.</p>
<p>There are approximately 3×10</p>
<p>38</p>
<p> total possible IPv6 addresses.</p>
<p>The IANA (Internet Assigned Numbers Authority) manages the allocation of IPv4 and IPv6 addresses, assigning large blocks </p>
<p>to RIRs (Regional Internet Registries) which in turn allocate addresses to ISPs (Internet Service Providers) and other local </p>
<p>registries.  These address blocks can be searched via a WHOIS query to the appropriate RIR, which is:</p>
<p>AFRINIC</p>
<p>for Africa</p>
<p>ARIN</p>
<p>for US, Canada, and Antarctica</p>
<p>APNIC</p>
<p>for Asia and Oceania</p>
<p>LACNIC</p>
<p>for Latin America</p>
<p>RIPE NCC</p>
<p>for Europe, Middle East, and Russia</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>107/189</b></p>
<p><b>Subnetting</b></p>
<p><i>Subnetting</i></p>
<p><b>VLSM chart - Last octet subnetting (CIDR notation) </b></p>
<p><b>Prefix:       /24</b></p>
<p><b>Netmask:     .0 </b></p>
<p><b>      00000000</b></p>
<p><b>1 subnet </b></p>
<p><b>254 hosts each</b></p>
<p><b>254 total hosts</b></p>
<p><b>Prefix:       /25</b></p>
<p><b>Netmask: .128</b></p>
<p><b>       10000000</b></p>
<p><b>2 subnets </b></p>
<p><b>126 hosts each</b></p>
<p><b>252 total hosts</b></p>
<p><b>Prefix:       /26</b></p>
<p><b>Netmask: .192</b></p>
<p><b>       11000000</b></p>
<p><b>4 subnets </b></p>
<p><b>62 hosts each</b></p>
<p><b>248 total hosts</b></p>
<p><b>Prefix:        /27</b></p>
<p><b>Netmask: .224</b></p>
<p><b>        11100000</b></p>
<p><b>8 subnets </b></p>
<p><b>30 hosts each</b></p>
<p><b>240 total hosts</b></p>
<p><b>Prefix:       /28</b></p>
<p><b>Netmask: .240</b></p>
<p><b>        11110000</b></p>
<p><b>16 subnets </b></p>
<p><b>14 hosts each</b></p>
<p><b>224 total hosts</b></p>
<p><b>Prefix:       /29</b></p>
<p><b>Netmask: .248</b></p>
<p><b>        11111000</b></p>
<p><b>32 subnets </b></p>
<p><b>6 hosts each</b></p>
<p><b>192 total hosts</b></p>
<p><b>Prefix:       /30</b></p>
<p><b>Netmask: .252</b></p>
<p><b>        11111100</b></p>
<p><b>64 subnets </b></p>
<p><b>2 hosts each</b></p>
<p><b>128 total hosts</b></p>
<p>.0   </p>
<p>.0</p>
<p>.0</p>
<p>.0</p>
<p>.0</p>
<p>.0</p>
<p>.0</p>
<p>.4</p>
<p>.8</p>
<p>.8</p>
<p>.12</p>
<p>.16</p>
<p>.16</p>
<p>.16</p>
<p>.20</p>
<p>.24</p>
<p>.24</p>
<p>.28</p>
<p>.32</p>
<p>.32</p>
<p>.32</p>
<p>.32</p>
<p>.36</p>
<p>.40</p>
<p>.40</p>
<p>.44</p>
<p>.48</p>
<p>.48</p>
<p>.48</p>
<p>.52</p>
<p>.56</p>
<p>.56</p>
<p>.60</p>
<p>.64</p>
<p>.64</p>
<p>.64</p>
<p>.64</p>
<p>.64</p>
<p>.68</p>
<p>.72</p>
<p>.72</p>
<p>.76</p>
<p>.80</p>
<p>.80</p>
<p>.80</p>
<p>.84</p>
<p>.88</p>
<p>.88</p>
<p>.92</p>
<p>.96</p>
<p>.96</p>
<p>.96</p>
<p>.96</p>
<p>.100</p>
<p>.104</p>
<p>.104</p>
<p>.108</p>
<p>.112</p>
<p>.112</p>
<p>.112</p>
<p>.116</p>
<p>.120</p>
<p>.120</p>
<p>.124</p>
<p>.128</p>
<p>.128</p>
<p>.128</p>
<p>.128</p>
<p>.128</p>
<p>.128</p>
<p>.132</p>
<p>.136</p>
<p>.136</p>
<p>.140</p>
<p>.144</p>
<p>.144</p>
<p>.144</p>
<p>.148</p>
<p>.152</p>
<p>.152</p>
<p>.156</p>
<p>.160</p>
<p>.160</p>
<p>.160</p>
<p>.160</p>
<p>.164</p>
<p>.168</p>
<p>.168</p>
<p>.172</p>
<p>.176</p>
<p>.176</p>
<p>.176</p>
<p>.180</p>
<p>.184</p>
<p>.184</p>
<p>.188</p>
<p>.192</p>
<p>.192</p>
<p>.192</p>
<p>.192</p>
<p>.192</p>
<p>.196</p>
<p>.200</p>
<p>.200</p>
<p>.204</p>
<p>.208</p>
<p>.208</p>
<p>.208</p>
<p>.212</p>
<p>.216</p>
<p>.216</p>
<p>.220</p>
<p>.224</p>
<p>.224</p>
<p>.224</p>
<p>.224</p>
<p>.228</p>
<p>.232</p>
<p>.232</p>
<p>.236</p>
<p>.240</p>
<p>.240</p>
<p>.240</p>
<p>.244</p>
<p>.248</p>
<p>.248</p>
<p>.252</p>
<p>Each block of a column identifies a subnet, whose range of valid hosts addresses is [network address +1 — broadcast </p>
<p>address -1] inclusive. </p>
<p>The network address of the subnet is the number shown inside a block.  </p>
<p>The broadcast address of the subnet is the network address of the block underneath -1 or, for the bottom block, .255.</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>108/189</b></p>
<p><b>Network services</b></p>
<p><i>Network services</i></p>
<p><b>Most common well-known ports</b></p>
<p><b>Port number</b></p>
<p><b>Service</b></p>
<p>20</p>
<p>TCP</p>
<p>FTP (data)</p>
<p>21</p>
<p>TCP</p>
<p>FTP (control)</p>
<p>22</p>
<p>TCP</p>
<p>SSH</p>
<p>23</p>
<p>TCP</p>
<p>Telnet</p>
<p>25</p>
<p>TCP</p>
<p>SMTP</p>
<p>53</p>
<p>TCP/UDP</p>
<p>DNS</p>
<p>67</p>
<p>UDP</p>
<p>BOOTP/DHCP (server)</p>
<p>68</p>
<p>UDP</p>
<p>BOOTP/DHCP (client)</p>
<p>80</p>
<p>TCP</p>
<p>HTTP</p>
<p>110</p>
<p>TCP</p>
<p>POP3</p>
<p>119</p>
<p>TCP</p>
<p>NNTP</p>
<p>123</p>
<p>UDP</p>
<p>NTP</p>
<p>139</p>
<p>TCP/UDP</p>
<p>Microsoft NetBIOS</p>
<p>143</p>
<p>TCP</p>
<p>IMAP</p>
<p>161</p>
<p>UDP</p>
<p>SNMP</p>
<p>443</p>
<p>TCP</p>
<p>HTTPS (HTTP over SSL/TLS)</p>
<p>465</p>
<p>TCP</p>
<p>SMTP over SSL</p>
<p>993</p>
<p>TCP</p>
<p>IMAPS (IMAP over SSL)</p>
<p>995</p>
<p>TCP</p>
<p>POP3S (POP3 over SSL)</p>
<p>1-1023: privileged ports, used server-side</p>
<p>1024-65535: unprivileged ports, used client-side</p>
<p>/etc/services</p>
<p> lists all well-known ports.</p>
<p>Many network services are run by the </p>
<p>xinetd</p>
<p> super server. </p>
<p><b>ISO/OSI and TCP/IP protocol stack models</b></p>
<p><b>Layer</b></p>
<p><b>ISO/OSI</b></p>
<p><b>TCP/IP</b></p>
<p><b>Standards</b></p>
<p><b>Data transmission unit</b></p>
<p><b>7</b></p>
<p>HTTP, SMTP, POP ...</p>
<p>Message</p>
<p><b>6</b></p>
<p><b>5</b></p>
<p><b>4</b></p>
<p>TCP, UDP</p>
<p>Segment (TCP), Datagram (UDP)</p>
<p><b>3</b></p>
<p>IPv4, IPv6, ICMP ...</p>
<p>Packet</p>
<p><b>2</b></p>
<p>Ethernet, Wi-Fi, PPP ...</p>
<p>Frame</p>
<p><b>1</b></p>
<p>Bit</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>Physical</p>
<p>Data Link</p>
<p>Network Access</p>
<p>Network</p>
<p>Internet</p>
<p>Transport</p>
<p>Transport</p>
<p>Session</p>
<p>Application</p>
<p>Application</p>
<p>Presentation</p>
<h1 style="page-break-before:always; "></h1>
<p><b>109/189</b></p>
<p><b>Network configuration commands</b></p>
<p><i>Network configuration commands</i></p>
<p>ip a</p>
<p>ip addr </p>
<p>ip addr show</p>
<p>ifconfig -a</p>
<p>Display configuration of all network </p>
<p>interfaces</p>
<p>ip link show eth0</p>
<p>ifconfig eth0</p>
<p>Display configuration of </p>
<p>eth0</p>
<p>ip addr add dev eth0 10.1.1.3/24</p>
<p>ifconfig eth0 10.1.1.3 netmask 255.255.255.0 broadcast 10.1.1.255</p>
<p>Configure IP address of </p>
<p>eth0</p>
<p>ifconfig eth0 hw ether 45:67:89:ab:cd:ef</p>
<p>Configure MAC address of </p>
<p>eth0</p>
<p>ip link set eth0 up</p>
<p>ifconfig eth0 up</p>
<p>ifup eth0</p>
<p>Activate </p>
<p>eth0</p>
<p>ip link set eth0 down</p>
<p>ifconfig eth0 down</p>
<p>ifdown eth0</p>
<p>Shut down </p>
<p>eth0</p>
<p>dhclient eth0</p>
<p>pump -i eth0</p>
<p>dhcpcd eth0</p>
<p>   (SUSE)</p>
<p>Request an IP address via DHCP</p>
<p>ip neigh</p>
<p>arp -a</p>
<p>Show the ARP cache table (containing </p>
<p>mappings of MAC to IP addresses)</p>
<p>ip neigh show 10.1.1.4</p>
<p>arp 10.1.1.4</p>
<p>Show the ARP cache entry for a host</p>
<p>ip neigh add 10.1.1.5 lladdr 01:23:45:67:89:ab dev eth0</p>
<p>arp -s 10.1.1.5 01:23:45:67:89:ab</p>
<p>Add a new ARP entry for a host</p>
<p>ip neigh del 10.1.1.5 dev eth0</p>
<p>arp -d 10.1.1.5</p>
<p>Delete an ARP entry</p>
<p>ip neigh flush all</p>
<p>Delete the ARP table for all interfaces</p>
<p>hostname</p>
<p>Get the hostname</p>
<p>hostname -f</p>
<p>Get the FQDN (Fully Qualified Domain Name)</p>
<p>hostname mybox</p>
<p>hostnamectl set-hostname --static &quot;mybox&quot;  </p>
<p>(Red Hat)</p>
<p>Set the hostname</p>
<p>hostnamectl  </p>
<p>(Red Hat)</p>
<p>Get the hostname, OS, and other information</p>
<p>/etc/init.d/networking restart  </p>
<p>(Debian)</p>
<p>/etc/init.d/network restart     </p>
<p>(Red Hat)</p>
<p>Restart network services</p>
<p>ethtool <i>option device</i></p>
<p>Query or control network driver and hardware settings</p>
<p>ethtool eth0</p>
<p>View hardware settings of </p>
<p>eth0</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>110/189</b></p>
<p><b>Network configuration files</b></p>
<p><i>Network configuration files</i></p>
<p>/etc/hosts</p>
<p>Mappings between IP addresses and hostnames, for name resolution</p>
<p>127.0.0.1  localhost.localdomain  localhost</p>
<p>10.2.3.4   myhost.domain.org      myhost</p>
<p>/etc/nsswitch.conf</p>
<p>Sources that must be used by various system library lookup functions</p>
<p>passwd:  files nisplus nis</p>
<p>shadow:  files nisplus nis</p>
<p>group:   files nisplus nis</p>
<p>hosts:   files dns nisplus nis</p>
<p>/etc/host.conf</p>
<p>Sources for name resolution, for systems before glibc2.</p>
<p>Obsolete, superseded by </p>
<p>/etc/nsswitch.conf</p>
<p>order hosts,bind</p>
<p>multi on</p>
<p>/etc/resolv.conf</p>
<p>Domain names that must be appended to bare hostnames, and DNS servers </p>
<p>that will be used for name resolution</p>
<p>search domain1.org domain2.org</p>
<p>nameserver  192.168.3.3</p>
<p>nameserver  192.168.4.4</p>
<p>/etc/networks</p>
<p>Mappings between network addresses and names</p>
<p>loopback  127.0.0.0</p>
<p>mylan     10.2.3.0</p>
<p>/etc/services</p>
<p>List of service TCP/UDP port numbers</p>
<p>/etc/protocols</p>
<p>List of available protocols</p>
<p>/sys/class/net</p>
<p>List of all network interfaces in the system</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>111/189</b></p>
<p><b>Red Hat vs Debian network config</b></p>
<p><i>Red Hat vs Debian network config</i></p>
<p><b>Red Hat network configuration</b></p>
<p>/etc/sysconfig/network</p>
<p>Network configuration file</p>
<p>ADDRESS=10.2.3.4</p>
<p>NETMASK=255.255.255.0</p>
<p>GATEWAY=10.2.3.254</p>
<p>HOSTNAME=mylinuxbox.example.org</p>
<p>NETWORKING=yes</p>
<p>/etc/sysconfig/network-scripts/ifcfg-eth0</p>
<p>Configuration file for </p>
<p>eth0</p>
<p>.</p>
<p>This file is read by the </p>
<p>ifup</p>
<p> and </p>
<p>ifdown</p>
<p> scripts</p>
<p>DEVICE=eth0</p>
<p>TYPE=Ethernet</p>
<p>HWADDR=AA:BB:CC:DD:EE:FF</p>
<p>BOOTPROTO=none</p>
<p>ONBOOT=yes</p>
<p>NM_CONTROLLED=no</p>
<p>IPADDR=10.2.3.4</p>
<p>NETMASK=255.255.255.0</p>
<p>GATEWAY=10.2.3.254</p>
<p>DNS1=8.8.8.8</p>
<p>DNS2=4.4.4.4</p>
<p>USERCTL=no</p>
<p>/etc/sysconfig/network-scripts/ifcfg-eth0:0</p>
<p>/etc/sysconfig/network-scripts/ifcfg-eth0:1</p>
<p>/etc/sysconfig/network-scripts/ifcfg-eth0:2</p>
<p>Multiple configuration files for a single </p>
<p>eth0</p>
<p> interface, which allows </p>
<p>binding multiple IP addresses to a single NIC</p>
<p>/etc/sysconfig/network-scripts/route-eth0</p>
<p>Static route configuration for </p>
<p>eth0</p>
<p>default 10.2.3.4 dev eth0</p>
<p>10.7.8.0/24 via 10.2.3.254 dev eth0</p>
<p>10.7.9.0/24 via 10.2.3.254 dev eth0</p>
<p>/etc/ethertypes</p>
<p>Ethernet frame types.</p>
<p>Lists various Ethernet protocol types used on Ethernet networks</p>
<p><b>Debian network configuration</b></p>
<p>/etc/network/interfaces</p>
<p>List and configuration of all network interfaces</p>
<p>allow-hotplug eth0</p>
<p>iface eth0 inet static</p>
<p>   address 10.2.3.4</p>
<p>   netmask 255.255.255.0</p>
<p>   gateway 10.2.3.254</p>
<p>   dns-domain example.com</p>
<p>   dns-nameservers 8.8.8.8 4.4.4.4</p>
<p>/etc/hostname</p>
<p>Hostname of the local machine</p>
<p>/etc/ethers</p>
<p>ARP mappings</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>112/189</b></p>
<p><b>nmcli</b></p>
<p><i>nmcli</i></p>
<p>In RHEL7 and later the network configuration is managed by the NetworkManager daemon.</p>
<p>A <b>connection</b> is a network configuration that applies to a <b>device</b> (aka network interface).  A device can be included in </p>
<p>multiple connections, but only one of them may be active at a time. </p>
<p>The configuration for <i>connection</i> is stored in the file </p>
<p>/etc/sysconfig/network-scripts/ifcfg-<i>connection</i></p>
<p>.  Although it is </p>
<p>possible to set up networking by editing these configuration files, it is much easier to use the command </p>
<p>nmcli</p>
<p>.</p>
<p>nmcli device status</p>
<p>Show all network devices</p>
<p>nmcli device disconnect <i>iface</i></p>
<p>Disconnects the device <i>iface</i>.</p>
<p>This command should be used instead of</p>
<p>nmcli connection down <i>connection</i></p>
<p>because if <i>connection</i> is set to autoconnect, Network </p>
<p>Manager will bring the connection (and the device) up </p>
<p>again short time later</p>
<p>nmcli connection show</p>
<p>Show all connections.</p>
<p>Connections with an empty device entry are inactive</p>
<p>nmcli connection show --active</p>
<p>Show active connections</p>
<p>nmcli connection show <i>connection</i></p>
<p>Show the configuration of <i>connection</i></p>
<p>nmcli connection add con-name <i>connection</i> \</p>
<p>type ethernet ifname <i>iface </i>ipv4.method manual \</p>
<p>ipv4.addresses 10.0.0.13/24 ipv4.gateway 10.0.0.254 </p>
<p>Configure a new <i>connection</i> that uses the Ethernet </p>
<p>interface <i>iface</i> and assigns it an IPv4 address and </p>
<p>gateway</p>
<p>nmcli connection modify <i>connection options</i></p>
<p>Modify the configuration of <i>connection</i></p>
<p>nmcli connection up <i>connection</i></p>
<p>Brings up a <i>connection</i></p>
<p>nmcli connection reload</p>
<p>Reload any manual change made to the files </p>
<p>/etc/sysconfig/network-scripts/ifcfg-*</p>
<p>The manpage </p>
<p>man nmcli-examples</p>
<p> contains examples of network configuration.</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>113/189</b></p>
<p><b>Teaming and bridging</b></p>
<p><i>Teaming and bridging</i></p>
<p><b>Network teaming</b> allows binding together two or more network interfaces to increase throughput or provide redundancy.</p>
<p>RHEL7 and later implement network teaming via the </p>
<p>teamd</p>
<p> daemon.</p>
<p><b>How to set up a teaming connection</b></p>
<p>1.</p>
<p>nmcli connection add type team con-name <i>teamcon </i>ifname <i>teamif </i>\</p>
<p>config '{&quot;runner&quot;:{&quot;name&quot;:&quot;loadbalance&quot;}}'</p>
<p>Set up a team connection <i>teamcon</i> and a </p>
<p>team interface <i>teamif</i> with a runner (in </p>
<p>JSON code) for automatic failover</p>
<p>2.</p>
<p>nmcli connection modify <i>teamcon</i> ipv4.method manual \ </p>
<p>ipv4.addresses 10.0.0.14/24 ipv4.gateway 10.0.0.254</p>
<p>Assign manually an IP address and </p>
<p>gateway</p>
<p>3.</p>
<p>nmcli connection add type team-slave ifname <i>iface</i> \</p>
<p>master <i>teamcon</i></p>
<p>Add an existing device <i>iface</i> as a slave of </p>
<p>team <i>teamcon</i>.  </p>
<p>The slave connection will be automatically</p>
<p>named </p>
<p>team-slave-<i>iface</i></p>
<p>4.</p>
<p>Repeat the previous step for each slave interface.</p>
<p>teamdctl <i>teamif</i> state</p>
<p>Show the state of the team interface <i>teamif</i></p>
<p>teamnl <i>teamif command</i></p>
<p>Debug a team interface <i>teamif</i></p>
<p>A <b>network bridge</b> emulates a hardware bridge, i.e. a Layer 2 device able to forward traffic between networks based on </p>
<p>MAC addresses.</p>
<p><b>How to set up a bridge connection</b></p>
<p>1.</p>
<p>nmcli connection add type bridge con-name <i>brcon</i> ifname <i>brif</i></p>
<p>Set up a bridge connection <i>brcon</i> and a </p>
<p>bridge interface <i>brif</i></p>
<p>2.</p>
<p>nmcli connection modify <i>brcon</i> ipv4.method manual \</p>
<p>ipv4.addresses 10.0.0.15/24 ipv4.gateway 10.0.0.254</p>
<p>Assign manually an IP address and </p>
<p>gateway</p>
<p>3.</p>
<p>nmcli connection add type bridge-slave ifname <i>iface</i> \</p>
<p>master <i>brcon</i></p>
<p>Add an existing device <i>iface</i> as a slave of </p>
<p>bridge <i>brcon</i>.  </p>
<p>The slave connection will be automatically</p>
<p>named </p>
<p>bridge-slave-<i>iface</i></p>
<p>4.</p>
<p>Repeat the previous step for each slave interface.</p>
<p>brctl show <i>brif</i></p>
<p>Display information about the bridge interface <i>brif</i></p>
<p>The manpage </p>
<p>man teamd.conf</p>
<p> contains examples of team configurations and runners.</p>
<p>The manpage </p>
<p>man nmcli-examples</p>
<p> contains examples of teaming and bridging configuration.</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>114/189</b></p>
<p><b>Wireless networking</b></p>
<p><i>Wireless networking</i></p>
<p>iwlist wlan0 scan</p>
<p>List all wireless devices in range, with their quality of signal and other information</p>
<p>iwlist wlan0 freq</p>
<p>Display transmission frequency settings</p>
<p>iwlist wlan0 rate</p>
<p>Display transmission speed settings</p>
<p>iwlist wlan0 txpower</p>
<p>Display transmission power settings</p>
<p>iwlist wlan0 key</p>
<p>Display encryption settings</p>
<p>iwgetid wlan0 <i>option</i></p>
<p>Print NWID, ESSID, AP/Cell address or other information about the wireless network </p>
<p>that is currently in use</p>
<p>iwconfig wlan0</p>
<p>Display configuration of wireless interface </p>
<p>wlan0</p>
<p>iwconfig wlan0 <i>option</i></p>
<p>Configure wireless interface </p>
<p>wlan0</p>
<p>iw dev wlan0 station dump</p>
<p>On a wireless card configured in AP Mode, display information (e.g. MAC address, </p>
<p>tx/rx, bitrate, signal strength) about the clients</p>
<p>rfkill list</p>
<p>List installed wireless devices</p>
<p>rfkill unblock <i>n</i></p>
<p>Enable wireless device number <i>n</i></p>
<p>hcidump -i <i>device</i></p>
<p>Display raw HCI (Host Controller Interface) data exchanged with a Bluetooth <i>device</i></p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>115/189</b></p>
<p><b>Network tools</b></p>
<p><i>Network tools</i></p>
<p>dig <i>example.org</i></p>
<p>Perform a DNS lookup for the specified domain or hostname.</p>
<p>Returns information in BIND zone file syntax; uses an internal</p>
<p>resolver and hence does not honor </p>
<p>/etc/resolv.conf</p>
<p>host <i>example.org</i></p>
<p>nslookup <i>example.org</i>  </p>
<p>(deprecated)</p>
<p>Perform a DNS lookup for the specified domain or hostname.</p>
<p>Does honor </p>
<p>/etc/resolv.conf</p>
<p>dig @<i>nameserver</i> -t MX <i>example.org</i></p>
<p>host -t <i>example.org nameserver</i></p>
<p>Perform a DNS lookup for the MX record of the specified </p>
<p>domain, querying <i>nameserver</i></p>
<p>dig <i>example.org</i> any</p>
<p>host -a <i>example.org</i></p>
<p>Get all DNS records for a domain</p>
<p>dig -x <i>a.b.c.d</i></p>
<p>host <i>a.b.c.d</i></p>
<p>Perform a reverse DNS lookup for the IP address <i>a.b.c.d</i></p>
<p>whois <i>example.org</i></p>
<p>Query the WHOIS service for an Internet resource (usually a </p>
<p>domain name)</p>
<p>ping <i>host</i></p>
<p>Test if a remote host can be reached and measure the round-</p>
<p>trip time to it.  This is done by sending an ICMP Echo Request </p>
<p>datagram and awaiting an ICMP Echo Response</p>
<p>fping -a <i>host1 host2 host3</i></p>
<p>Ping multiple hosts in parallel and report which ones are alive</p>
<p>bing <i>host1 host2</i></p>
<p>Calculate point-to-point throughput between two hosts</p>
<p>traceroute <i>host</i></p>
<p>Print the route, hop by hop, packets trace to a remote host.</p>
<p>This is done by sending a sequence of ICMP Echo Request </p>
<p>datagrams with increasing TTL values, starting with TTL=1, </p>
<p>and expecting ICMP Time Exceeded datagrams</p>
<p>tracepath <i>host</i></p>
<p>Simpler </p>
<p>traceroute</p>
<p>mtr <i>host</i></p>
<p>traceroute</p>
<p> and </p>
<p>ping</p>
<p> combined</p>
<p>redir --laddr=<i>ip1</i> --lport=<i>port1</i> \</p>
<p>--caddr=<i>ip2</i> --cport=<i>port2</i></p>
<p>Redirect all connections coming to local IP address <i>ip1</i> and </p>
<p>port <i>port1</i>, to remote IP address <i>ip2</i> and port <i>port2</i></p>
<p>telnet <i>host</i> <i>port</i></p>
<p>Establish a telnet connection to the specified host and port </p>
<p>number.  If port is omitted, uses default port 23</p>
<p>wget –-no-clobber –-html-extension \</p>
<p>--page-requisites --convert-links \</p>
<p>--recursive --domains example.org \</p>
<p>--no-parent <i>www.example.org/path</i></p>
<p>Download a whole website <i>www.example.org/path</i></p>
<p>curl <i>www.example.org/file.html</i> -o <i>myfile.html</i></p>
<p>Download a file via HTTP and save it locally under another </p>
<p>name</p>
<p>curl -u <i>user</i>:<i>password </i>'ftp://<i>ftpserver/path/file</i>'</p>
<p>Download a file via FTP, after logging in to the server</p>
<p>curl -XPUT <i>webserver</i> -d'<i>data</i>'</p>
<p>Send an HTTP PUT command with <i>data</i> to <i>webserver</i></p>
<p>hping3 <i>options host</i></p>
<p>Send a custom TCP/IP packet to <i>host</i> and display the reply</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>116/189</b></p>
<p><b>Network monitoring</b></p>
<p><i>Network monitoring</i></p>
<p>netstat</p>
<p>Display network connections</p>
<p>netstat –-tcp</p>
<p>netstat -t</p>
<p>Display active TCP connections</p>
<p>netstat -l</p>
<p>Display only listening sockets</p>
<p>netstat -a</p>
<p>Display all listening and non-listening sockets</p>
<p>netstat -n</p>
<p>Display network connections, without resolving hostnames or portnames</p>
<p>netstat -p</p>
<p>Display network connections, with PID and name of program to which each socket belongs</p>
<p>netstat -i</p>
<p>Display network interfaces</p>
<p>netstat -s</p>
<p>Display protocol statistics</p>
<p>netstat -r</p>
<p>Display kernel routing tables (equivalent to </p>
<p>route -e</p>
<p>)</p>
<p>netstat -c</p>
<p>Display network connections continuously</p>
<p>ss</p>
<p>Display socket statistics (similarly to </p>
<p>netstat</p>
<p>)</p>
<p>ss -t -a</p>
<p>Display all TCP sockets</p>
<p>nmap <i>host</i></p>
<p>nmap -sS <i>host</i></p>
<p>Scan for open TCP ports (TCP SYN scan) on remote host</p>
<p>nmap -sP <i>host</i></p>
<p>Do a ping sweep (ICMP ECHO probes) on remote host</p>
<p>nmap -sU <i>host</i></p>
<p>Scan for open UDP ports on remote host</p>
<p>nmap -sV <i>host</i></p>
<p>Do a service and version scan on open ports</p>
<p>nmap -p 1-65535 <i>host</i></p>
<p>Scan all ports (1-65535), not only the common ports, on remote host</p>
<p>nmap -O <i>host</i></p>
<p>Find which operating system is running on remote host (OS fingerprinting)</p>
<p>arp-scan</p>
<p>Scan all hosts on the current LAN.  Uses ARP (Layer 2) packets and is therefore able to find</p>
<p>even the hosts configured to drop all IP or ICMP traffic; for the same reason it cannot scan </p>
<p>hosts outside the same LAN</p>
<p>ngrep</p>
<p>Filter data payload of network packets matching a specified regex</p>
<p>dhcpdump -i eth0</p>
<p>Sniff all DHCP packets on interface </p>
<p>eth0</p>
<p>nload</p>
<p>Display a graph of the current network usage</p>
<p>iptraf</p>
<p>iptraf-ng</p>
<p>IP LAN monitor (Ncurses UI)</p>
<p>netserver</p>
<p>Run a network performance benchmark server</p>
<p>netperf</p>
<p>Do network performance benchmarks by connecting to a netserver</p>
<p>iperf -s</p>
<p>Run a network throughput benchmark server</p>
<p>iperf -c <i>server</i></p>
<p>Perform network throughput tests in client mode, by connecting to an iperf server</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>117/189</b></p>
<p><b>tcpdump</b></p>
<p><i>tcpdump</i></p>
<p>Tcpdump is a packet analyzer (aka packet sniffer).  A GUI equivalent is Wireshark, previously called Ethereal.</p>
<p>tcpdump -ni eth0</p>
<p>Sniff all network traffic on interface </p>
<p>eth0</p>
<p>, </p>
<p>suppressing DNS resolution</p>
<p>tcpdump ip host 10.0.0.2 tcp port 25</p>
<p>Sniff network packets on TCP port 25 from and</p>
<p>to 10.0.0.2</p>
<p>tcpdump ether host '45:67:89:ab:cd:ef'</p>
<p>Sniff traffic from and to the network interface </p>
<p>having MAC address 45:67:89:ab:cd:ef</p>
<p>tcpdump 'src host 10.0.0.2 and (tcp port 80 or tcp port 443)'</p>
<p>Sniff HTTP and HTTPS traffic having as source </p>
<p>host 10.0.0.2</p>
<p>tcpdump -ni eth0 not port 22</p>
<p>Sniff all traffic on </p>
<p>eth0</p>
<p> except that belonging </p>
<p>to the SSH connection</p>
<p>tcpdump -vvnn -i eth0 arp</p>
<p>Sniff ARP traffic on </p>
<p>eth0</p>
<p>, on maximum </p>
<p>verbosity level, without converting host IP </p>
<p>addresses and port numbers to names</p>
<p>tcpdump ip host 10.0.0.2 and not 10.0.0.9</p>
<p>Sniff IP traffic between 10.0.0.2 and any other</p>
<p>host except 10.0.0.9</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>118/189</b></p>
<p><b>netcat</b></p>
<p><i>netcat</i></p>
<p>Netcat is &quot;the Swiss Army knife of networking&quot;, a very flexible generic TCP/IP client/server.</p>
<p>Depending on the distribution, the binary is called </p>
<p>nc</p>
<p>, </p>
<p>ncat</p>
<p> (Red Hat), or </p>
<p>netcat</p>
<p> (SUSE).</p>
<p>nc -z 10.0.0.7 22</p>
<p>ncat 10.0.0.7 22</p>
<p>Scan for a listening SSH daemon on remote host 10.0.0.7</p>
<p>nc -l -p 25</p>
<p>Listen for connections on port 25 (i.e. mimic a SMTP server). </p>
<p>Send any input received on stdin to the connected client and </p>
<p>dump on stdout any data received from the client</p>
<p>nc 10.0.0.7 389 &lt; <i>file</i></p>
<p>Push the content of <i>file</i> to port 389 on remote host 10.0.0.7</p>
<p>echo &quot;GET / HTTP/1.0\r\n\r\n&quot; | nc 10.0.0.7 80</p>
<p>Connect to web server 10.0.0.7 and issue a HTTP GET</p>
<p>while true; \</p>
<p>do nc -l -p 80 -q 1 &lt; <i>page.html</i>; done</p>
<p>while true; \</p>
<p>do echo &quot;&lt;html&gt;&lt;body&gt;Hello&lt;/body&gt;&lt;/html&gt;&quot; \</p>
<p>| ncat -l -p 80; done</p>
<p>Start a minimal web server, serving the specified HTML page </p>
<p>to clients</p>
<p>nc -v -n -z -w1 -r 10.0.0.7 1-1023</p>
<p>Run a TCP port scan against remote host 10.0.0.7.</p>
<p>Probes randomly all privileged ports with a 1-second timeout,</p>
<p>without resolving service names, and with verbose output</p>
<p>echo &quot;&quot; | nc -v -n -w1 10.0.0.7 1-1023</p>
<p>Retrieve the greeting banner of any network service that </p>
<p>might be running on remote host 10.0.0.7</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>119/189</b></p>
<p><b>TCP Wrapper</b></p>
<p><i>TCP Wrapper</i></p>
<p>/etc/hosts.allow</p>
<p>/etc/hosts.deny</p>
<p>Host access control files used by the TCP Wrapper system.</p>
<p>Each file contains zero or more </p>
<p><i>daemon</i>:<i>client</i></p>
<p> lines.  The first matching line is considered.</p>
<p>Access is granted when a </p>
<p><i>daemon</i>:<i>client</i></p>
<p> pair matches an entry in </p>
<p>/etc/hosts.allow</p>
<p>.</p>
<p>Otherwise, access is denied when a </p>
<p><i>daemon</i>:<i>client</i></p>
<p> pair matches an entry in </p>
<p>/etc/hosts.deny</p>
<p>.</p>
<p>Otherwise, access is granted.</p>
<p><b>/etc/hosts.allow </b></p>
<p><b>and</b></p>
<p><b> /etc/hosts.deny </b></p>
<p><b>lines syntax</b></p>
<p>ALL: ALL</p>
<p>All services to all hosts</p>
<p>ALL: .example.edu</p>
<p>All services to all hosts of the example.edu domain</p>
<p>ALL: .example.edu EXCEPT host1.example.edu</p>
<p>All services to all hosts of example.edu, except host1</p>
<p>in.fingerd: .example.com</p>
<p>Finger service to all hosts of example.com</p>
<p>in.tftpd: LOCAL</p>
<p>TFTP to hosts of the local domain only</p>
<p>sshd: 10.0.0.3 10.0.0.4 10.1.1.0/24</p>
<p>SSH to the hosts and network specified</p>
<p>sshd: 10.0.1.0/24</p>
<p>sshd: 10.0.1.</p>
<p>sshd: 10.0.1.0/255.255.255.0</p>
<p>SSH to 10.0.1.0/24</p>
<p>in.tftpd: ALL: spawn (/safe_dir/safe_finger \</p>
<p>-l @%h | /bin/mail -s %d-%h root) &amp;</p>
<p>Send a finger probe to hosts attempting TFTP and </p>
<p>notify root user via email</p>
<p>portmap: ALL: (echo Illegal RPC request \</p>
<p>from %h | /bin/mail root) &amp;</p>
<p>When a client attempts a RPC request via the </p>
<p>portmapper (NFS access), echo a message to the </p>
<p>terminal and notify the root user via email</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>120/189</b></p>
<p><b>Routing</b></p>
<p><i>Routing</i></p>
<p><b>Output of command </b></p>
<p><b>route -en</b></p>
<p>Kernel IP routing table</p>
<p>Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</p>
<p>192.168.3.0     0.0.0.0         255.255.255.0   U     0      0        0 eth0</p>
<p>0.0.0.0         192.168.3.1     0.0.0.0         UG    0      0        0 eth0</p>
<p><b>Destination</b></p>
<p><i>network or host</i></p>
<p>destination network or host</p>
<p>0.0.0.0</p>
<p>default route</p>
<p><b>Gateway</b></p>
<p><i>host</i></p>
<p>gateway</p>
<p>0.0.0.0</p>
<p>*</p>
<p>no gateway needed, network is directly connected</p>
<p>-</p>
<p>rejected route</p>
<p><b>Genmask</b></p>
<p><i>network mask</i></p>
<p>network mask to apply for the destination network</p>
<p>255.255.255.255</p>
<p>destination host</p>
<p>0.0.0.0</p>
<p>default route</p>
<p><b>Flags</b></p>
<p>U</p>
<p>route is up</p>
<p>G</p>
<p>use gateway</p>
<p>H</p>
<p>target is host</p>
<p>!</p>
<p>rejected route</p>
<p>D</p>
<p>dynamically installed by daemon</p>
<p>M</p>
<p>modified from routing daemon</p>
<p>R</p>
<p>reinstate route for dynamic routing</p>
<p>ip route</p>
<p>route -en</p>
<p>route -F</p>
<p>netstat -rn</p>
<p>Display IP routing table</p>
<p>ip route show cache</p>
<p>route -C</p>
<p>Display kernel routing cache</p>
<p>ip route add default via 10.1.1.254</p>
<p>route add default gw 10.1.1.254</p>
<p>Add a default gateway 10.1.1.254</p>
<p>ip route add 10.2.0.1 dev eth0</p>
<p>ip route add 10.2.0.1 via 10.2.0.254</p>
<p>route add -host 10.2.0.1 gw 10.2.0.254</p>
<p>Add a route for a host 10.2.0.1</p>
<p>ip route add 10.2.0.0/16 via 10.2.0.254</p>
<p>route add -net 10.2.0.0 netmask 255.255.0.0 gw 10.2.0.254</p>
<p>Add a route for a network 10.2.0.0/16</p>
<p>ip route delete 10.2.0.1 dev eth0</p>
<p>route del -host 10.2.0.1 gw 10.2.0.254</p>
<p>Delete a route for a host 10.2.0.1</p>
<p>ip route flush all</p>
<p>Delete the routing table for all interfaces</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>121/189</b></p>
<p><b>iptables</b></p>
<p><i>iptables</i></p>
<p>The Netfilter framework provides firewalling capabilities in Linux.  It is implemented by the user-space application programs </p>
<p>iptables</p>
<p> for IPv4 (which replaced </p>
<p>ipchains</p>
<p>, which itself replaced </p>
<p>ipfwadm</p>
<p>) and </p>
<p>ip6tables</p>
<p> for IPv6.  </p>
<p>iptables is implemented in the kernel and therefore does not have a daemon process or a service.</p>
<p>The ability to track connection state is provided by the </p>
<p>ip_conntrack</p>
<p> kernel module.</p>
<p>In RHEL 7, the firewall is managed by the </p>
<p>firewalld</p>
<p> daemon which uses iptables as backend.  It is possible, but </p>
<p>discouraged, to use iptables directly by disabling firewalld and installing the package </p>
<p>iptables-services</p>
<p>, which provides </p>
<p>systemd units for iptables.</p>
<p>In RHEL 8, iptables has been replaced by </p>
<p>nftables</p>
<p>, with firewalld as frontend. </p>
<p>In Ubuntu, the firewall is managed by the </p>
<p>ufw</p>
<p> (Uncomplicated Firewall) service, with iptables as backend.</p>
<p>/etc/sysconfig/iptables</p>
<p>Default file containing the firewall rules</p>
<p>iptables-restore &lt; <i>file</i></p>
<p>Load into iptables the firewall rules specified in the <i>file</i></p>
<p>iptables-save &gt; <i>file</i></p>
<p>Save into iptables the firewall rules specified in the <i>file</i></p>
<p><b>iptables rules file</b></p>
<p>*filter</p>
<p>:INPUT ACCEPT [0:0]</p>
<p>:FORWARD ACCEPT [0:0]</p>
<p>:OUTPUT ACCEPT [0:0]</p>
<p>COMMIT</p>
<p>Delete all rules and open the firewall to all connections</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>122/189</b></p>
<p><b>iptables rules</b></p>
<p><i>iptables rules</i></p>
<p>Iptables uses <b>tables</b> containing sets of <b>chains</b>, which contain sets of <b>rules</b>.  Each rule has a <b>target</b> (e.g. ACCEPT).</p>
<p>The &quot;filter&quot; table contains chains INPUT, FORWARD, OUTPUT (built-in chains); this is the default table to which all iptables </p>
<p>commands are applied, unless another table is specified via the </p>
<p>-t</p>
<p> option.</p>
<p>The &quot;nat&quot; table contains chains PREROUTING, OUTPUT, POSTROUTING.</p>
<p>The &quot;mangle&quot; table contains chains PREROUTING, OUTPUT. </p>
<p>When a packet enters the system, it is handed to the INPUT chain.  If the destination is local, it is processed; if the </p>
<p>destination is not local and IP forwarding is enabled, the packet is handed to the FORWARD chain, otherwise it is dropped.</p>
<p>An outgoing packet generated by the system will go through the OUTPUT chain.</p>
<p>If NAT is in use, an incoming packet will pass at first through the PREROUTING chain, and an outgoing packet will pass last </p>
<p>through the POSTROUTING chain.</p>
<p>iptables -A INPUT -s 10.0.0.6 -j ACCEPT</p>
<p>Add a rule to accept all packets from 10.0.0.6</p>
<p>iptables -A INPUT -s 10.0.0.7 -j REJECT</p>
<p>Add a rule to reject all packets from 10.0.0.7 and send </p>
<p>back a ICMP response to the sender </p>
<p>iptables -A INPUT -s 10.0.0.8 -j DROP</p>
<p>Add a rule to silently drop all packets from 10.0.0.8</p>
<p>iptables -A INPUT -s 10.0.0.9 -j LOG</p>
<p>Add a rule to log (via syslog) all packets from 10.0.0.9</p>
<p>iptables -D INPUT -s 10.0.0.9 -j LOG</p>
<p>Delete a specific rule</p>
<p>iptables -D INPUT 42</p>
<p>Delete rule 42 of the INPUT chain</p>
<p>iptables -F INPUT</p>
<p>Flush all rules of the INPUT chain</p>
<p>iptables -F</p>
<p>Flush all rules, hence disabling the firewall</p>
<p>iptables -t mangle -F</p>
<p>Flush all rules of the &quot;mangle&quot; table</p>
<p>iptables -t mangle -X</p>
<p>Delete all user-defined (not built-in) rules in the &quot;mangle&quot; </p>
<p>table</p>
<p>iptables -L INPUT</p>
<p>List the rules of the INPUT chain</p>
<p>iptables -L -n</p>
<p>List all rules, without translating numeric values (IP </p>
<p>addresses to FQDNs and port numbers to services)</p>
<p>iptables -N mychain</p>
<p>Define a new chain</p>
<p>iptables -P INPUT DROP</p>
<p>Define the chain policy target, which takes effect when no</p>
<p>rule matches and the end of the rules list is reached</p>
<p>iptables -A OUTPUT -d 10.7.7.0/24 -j DROP </p>
<p>Add a rule to drop all packets with destination 10.7.7.0/24</p>
<p>iptables -A FORWARD -i eth0 -o eth1 -j LOG</p>
<p>Add a rule to log all packets entering the system via eth0 </p>
<p>and exiting via eth1</p>
<p>iptables -A INPUT -p 17 -j DROP</p>
<p>iptables -A INPUT -p udp -j DROP</p>
<p>Add a rule to drop all incoming UDP traffic (protocol </p>
<p>numbers are defined in </p>
<p>/etc/protocols</p>
<p>)</p>
<p>iptables -A INPUT --sport 1024:65535 --dport 53 \</p>
<p>-j ACCEPT</p>
<p>Add a rule to accept all packets coming from any </p>
<p>unprivileged port and with destination port 53</p>
<p>iptables -A INPUT -p icmp --icmp-type echo-request \</p>
<p>-m limit --limit 1/s -i eth0 -j ACCEPT</p>
<p>Add a rule to accept incoming pings through eth0 at a </p>
<p>maximum rate of 1 ping/second</p>
<p>iptables -A INPUT -m state --state ESTABLISHED \</p>
<p>-j ACCEPT</p>
<p>Load the module for stateful packet filtering, and add a </p>
<p>rule to accept all packets that are part of a </p>
<p>communication already tracked by the state module </p>
<p>iptables -A INPUT -m state --state NEW -j ACCEPT</p>
<p>Add a rule to accept all packets that are not part of a </p>
<p>communication already tracked by the state module </p>
<p>iptables -A INPUT -m state --state RELATED -j ACCEPT</p>
<p>Add a rule to accept all packets that are related (e.g. </p>
<p>ICMP responses to TCP or UDP traffic) to a communication</p>
<p>already tracked by the state module </p>
<p>iptables -A INPUT -m state --state INVALID -j ACCEPT</p>
<p>Add a rule to accept all packets that do not match any of </p>
<p>the states above  </p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>123/189</b></p>
<p><b>iptables NAT routing</b></p>
<p><i>iptables NAT routing</i></p>
<p><b>SNAT (Source Network Address Translation)</b></p>
<p>iptables -t nat -A POSTROUTING -s 10.0.0.0/24 -o eth1 \</p>
<p>-j SNAT --to-source 93.184.216.119</p>
<p>Map all traffic leaving the LAN to the external IP </p>
<p>address 93.184.216.119</p>
<p>iptables -t nat -A POSTROUTING -s 10.0.0.0/24 -o eth1 \</p>
<p>-j SNAT --to-source 93.184.216.119:93.184.216.127</p>
<p>Map all traffic leaving the LAN to a pool of external </p>
<p>IP addresses 93.184.216.119-127</p>
<p>iptables -t nat -A POSTROUTING -o eth1 -j MASQUERADE</p>
<p>Map all traffic leaving the LAN to the address </p>
<p>dynamically assigned to eth1 via DHCP</p>
<p><b>DNAT (Destination Network Address Translation)</b></p>
<p>iptables -t nat -A PREROUTING -i eth1 -d 93.184.216.119 \</p>
<p>-j DNAT --to-destination 10.0.0.13</p>
<p>Allow the internal host 10.0.0.13 to be publicly </p>
<p>reachable via the external address 93.184.216.119</p>
<p><b>PAT (Port Address Translation)</b></p>
<p>iptables -t nat -A PREROUTING -i eth1 -d 93.184.216.119 \</p>
<p>-p tcp --dport 80 -j DNAT --to-destination 10.0.0.13:8080</p>
<p>Make publicly accessible a webserver that is </p>
<p>located in the LAN, by mapping port 8080 of the </p>
<p>internal host 10.0.0.13 to port 80 of the external </p>
<p>address 93.184.216.119</p>
<p>iptables -t nat -A PREROUTING -i eth0 -d ! 10.0.0.0/24 \</p>
<p>-p tcp --dport 80 -j REDIRECT --to-ports 3128</p>
<p>Redirect all outbound HTTP traffic originating from </p>
<p>the LAN to a proxy running on port 3128 on the </p>
<p>Linux box</p>
<p>sysctl -w net.ipv4.ip_forward=1</p>
<p>echo 1 &gt; /proc/sys/net/ipv4/ip_forward </p>
<p>Enable IP forwarding; necessary to set up a Linux machine as a router. </p>
<p>(This command causes other network options to be changed as well.)</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>LAN</p>
<p>10.0.0.0/24</p>
<p>Linux box</p>
<p>NAT router</p>
<p>eth1</p>
<p>93.184.216.119</p>
<p>eth0</p>
<p>10.0.0.1</p>
<p>Internet</p>
<h1 style="page-break-before:always; "></h1>
<p><b>124/189</b></p>
<p><b>firewalld</b></p>
<p><i>firewalld</i></p>
<p>In firewalld, a network interface (aka <b>interface</b>) or a subnet address (aka <b>source</b>) can be assigned to a specific <b>zone</b>.  </p>
<p>To determine to which zone a packet belongs, first the zone of the source is analyzed, then the zone of the interface; if no </p>
<p>source or interface matches, the packet is associated to the default zone (which is &quot;public&quot;, unless set otherwise).</p>
<p>If the zone is not specified (via </p>
<p>--zone=<i>zone</i></p>
<p>), the command is applied to the default zone.  </p>
<p>By default, commands are temporary; adding the </p>
<p>--permanent</p>
<p> option to a command sets it as permanent, or shows </p>
<p>permanent settings only.  </p>
<p>Temporary commands are effective immediately but are canceled at reboot, firewall reload, or firewall restart.</p>
<p>Permanent commands are effective only after reboot, firewall reload, or firewall restart. </p>
<p><b>Firewalld zones (as obtained by </b></p>
<p><b>firewall-cmd --get-zones</b></p>
<p><b>)</b></p>
<p>block</p>
<p>Rejects incoming connections with an ICMP HOST_PROHIBITED; allows only established connections</p>
<p>dmz</p>
<p>Used to expose services to the public; allows only specific incoming connections</p>
<p>drop</p>
<p>Drops all incoming packets; allows only outgoing connections</p>
<p>external</p>
<p>Used for routing and masquerading; allows only specific connections </p>
<p>home</p>
<p>Allows only specific incoming connections</p>
<p>internal</p>
<p>Used to define internal networks and allow only private network traffic</p>
<p>public</p>
<p>Allows only specific incoming connections.  Default zone</p>
<p>trusted</p>
<p>Accepts all traffic</p>
<p>work</p>
<p>Used to define internal networks and allow only private network traffic</p>
<p>systemctl status firewalld</p>
<p>firewall-cmd --state</p>
<p>Check the status of the firewall</p>
<p>firewall-config</p>
<p>Firewall management GUI</p>
<p>firewall-cmd --reload</p>
<p>Reload firewall configuration; this applies all permanent changes and </p>
<p>cancels all temporary changes.  Current connections are not terminated</p>
<p>firewall-cmd --complete-reload</p>
<p>Reload firewall configuration, stopping all current connections</p>
<p>firewall-cmd --runtime-to-permanent </p>
<p>Transform all temporary changes to permanent</p>
<p>firewall-cmd --list-all-zones</p>
<p>List all zones and their full settings</p>
<p>firewall-cmd --get-default-zone</p>
<p>Show the default zone</p>
<p>firewall-cmd --set-default-zone=home</p>
<p>Set &quot;home&quot; as the default zone</p>
<p>firewall-cmd --get-active-zones</p>
<p>Show the active zones i.e. zones bound to </p>
<p>either an interface or a source</p>
<p>firewall-cmd --get-zones</p>
<p>Show all available zones</p>
<p>firewall-cmd --get-zone-of-interface=eth0</p>
<p>Show the zone assigned to </p>
<p>eth0</p>
<p>firewall-cmd --new-zone=test</p>
<p>Create a new zone called &quot;test&quot;</p>
<p>firewall-cmd --zone=home --change-interface=eth0</p>
<p>Assign eth0 to the &quot;home&quot; zone</p>
<p>firewall-cmd --zone=home --list-all</p>
<p>List temporary settings of the &quot;home&quot; zone</p>
<p>firewall-cmd --zone=home --list-all --permanent</p>
<p>List permanent settings of the &quot;home&quot; zone</p>
<p>firewall-cmd --zone=home --add-source=10.1.1.0/24</p>
<p>Assign 10.1.1.0/24 to the &quot;home&quot; zone i.e. </p>
<p>route all traffic from that subnet to that zone</p>
<p>firewall-cmd --zone=home --list-sources</p>
<p>List sources bound to the &quot;home&quot; zone</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>125/189</b></p>
<p><b>firewalld rules</b></p>
<p><i>firewalld rules</i></p>
<p>firewall-cmd --zone=trusted --add-service=ssh</p>
<p>firewall-cmd --zone=trusted --add-port=22/tcp</p>
<p>Add the SSH service to the &quot;trusted&quot; zone</p>
<p>firewall-cmd --zone=trusted --add-service={ssh,http,https}</p>
<p>Add the SSH, HTTP, and HTTPS services to the </p>
<p>&quot;trusted&quot; zone</p>
<p>firewall-cmd --zone=trusted --list-services</p>
<p>Show temporary and permanent services </p>
<p>bound to the &quot;trusted&quot; zone</p>
<p>firewall-cmd --zone=trusted --list-ports</p>
<p>Show temporary and permanent ports open on</p>
<p>the &quot;trusted&quot; zone</p>
<p>firewall-cmd --get-services</p>
<p>List all predefined services</p>
<p>Predefined services are configured in </p>
<p>/usr/lib/firewalld/services/<i>service</i>.xml</p>
<p>.</p>
<p>User-defined services are configured in </p>
<p>/etc/firewalld/services/<i>service</i>.xml</p>
<p>.</p>
<p>firewall-cmd --get-icmptypes</p>
<p>Show all known types of ICMP messages </p>
<p>firewall-cmd --add-icmp-block=echo-reply</p>
<p>Block a specific ICMP message type</p>
<p>firewall-cmd --query-icmp-block=echo-reply</p>
<p>Tell if a specific ICMP message type is blocked</p>
<p>firewall-cmd --list-icmp-block</p>
<p>Show the list of blocked ICMP message types</p>
<p>firewall-cmd --add-rich-rule='<i>richrule</i>'</p>
<p>Set up a <b>rich rule</b> (for more complex and </p>
<p>detailed firewall configurations)</p>
<p>firewall-cmd --add-rich-rule='rule \</p>
<p>family=ipv4 source address=10.2.2.0/24 service name=tftp</p>
<p>log prefix=tftp level=info limit value=3/m accept'</p>
<p>Set up a rich rule to allow tftp connections </p>
<p>from subnet 10.2.2.0/24 and log them via </p>
<p>syslog at a rate of 3 per minute</p>
<p>firewall-cmd --list-rich-rules</p>
<p>List all rich rules</p>
<p>The manpage </p>
<p>man firewalld.richlanguage</p>
<p> contains several examples of rich rules.</p>
<p>firewall-cmd --direct --add-rule <i>directrule</i> </p>
<p>Set up a <b>direct rule</b> (in iptables format)</p>
<p>firewall-cmd --direct --add-rule \</p>
<p>ipv4 filter INPUT 0 -p tcp --dport 22 -j ACCEPT</p>
<p>Set up a direct rule to allow SSH connections</p>
<p>firewall-offline-cmd <i>directrule</i></p>
<p>Set up a direct rule when firewalld is not </p>
<p>running</p>
<p>firewall-cmd --direct --get-all-rules</p>
<p>Show all direct rules</p>
<p>The manpage </p>
<p>man firewalld.direct</p>
<p> documents the syntax of direct rules.</p>
<p>User-defined direct rules are stored in </p>
<p>/etc/firewalld/direct.xml</p>
<p>.</p>
<p>firewall-cmd --zone=<i>zone</i> --add-masquerade</p>
<p>Set up masquerading for hosts of <i>zone</i>; </p>
<p>packets originating from <i>zone</i> will get the </p>
<p>firewall's IP address on the &quot;external&quot; zone as </p>
<p>source address </p>
<p>firewall-cmd --zone=<i>zone</i> --add-rich-rule='rule \</p>
<p>family=ipv4 source address=10.2.2.0/24 masquerade'</p>
<p>Set up masquerading only for those hosts of </p>
<p><i>zone</i> located in subnet 10.2.2.0/24</p>
<p>firewall-cmd --zone=<i>zone</i> --add-forward-port=\</p>
<p>port=22:proto=tcp:toport=2222:toaddr=10.7.7.7</p>
<p>Set up port forwarding for hosts of <i>zone</i>; </p>
<p>incoming connections to port 22 for hosts of </p>
<p><i>zone</i> will be forwarded to port 2222 on host </p>
<p>10.7.7.7</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>126/189</b></p>
<p><b>SSH</b></p>
<p><i>SSH</i></p>
<p>Secure Shell (SSH) is a protocol (not a shell) for encrypted secure communications.  It is mostly used as a replacement to </p>
<p>Telnet to securely login to a remote server's terminal, but can be applied to any network protocol.  Some of the most </p>
<p>common applications of SSH are Secure Copy (SCP) and SSH File Transfer Protocol (SFTP).</p>
<p>ssh <i>user</i>@<i>host</i></p>
<p>Connect to a remote <i>host</i> via SSH and login as <i>user</i>.</p>
<p>Options:</p>
<p>-v  -vv  -vvv   </p>
<p>Increasing levels of verbosity</p>
<p>-p <i>n            </i></p>
<p>Use port <i>n</i> instead of standard port 22 </p>
<p>ssh <i>user</i>@<i>host</i> <i>command</i></p>
<p>Execute a command on a remote host</p>
<p>autossh <i>user</i>@<i>host</i></p>
<p>Connect to a remote host, monitoring the connection and </p>
<p>restarting it automatically if it dies</p>
<p>sshpass -p <i>password</i> ssh <i>user</i>@<i>host</i></p>
<p>Connect to a remote host using the specified password</p>
<p>pssh -i -H &quot;<i>host1 host2 host3</i>&quot; <i>command</i></p>
<p>Execute a command in parallel on a group of remote hosts</p>
<p>ssh-keygen -t rsa -b 2048</p>
<p>Generate interactively a 2048-bit RSA key pair; will prompt for a </p>
<p>passphrase</p>
<p>ssh-keygen -t dsa</p>
<p>Generate a DSA key pair</p>
<p>ssh-keygen -p -t rsa</p>
<p>Change passphrase of the private key</p>
<p>ssh-keygen -q -t rsa -f <i>keyfile</i> -N '' -C ''</p>
<p>Generate a RSA key with no passphrase (for non-interactive use) </p>
<p>and no comment</p>
<p>ssh-keygen -lf <i>keyfile</i></p>
<p>View key length and fingerprint of a public or private key</p>
<p>&lt; <i>keyfile.pub</i> awk '{print $2}' \</p>
<p>| base64 -d | openssl <i>hashfunction</i></p>
<p>View fingerprint of a key, calculated using <i>hashfunction</i>.</p>
<p>RSA keys fingerprint use </p>
<p>sha1</p>
<p> (deprecated) or </p>
<p>md5</p>
<p>ssh-keyscan <i>host</i> &gt;&gt; ~/.ssh/known_hosts</p>
<p>Get the public key of <i>host</i> and add it to the user's known hosts file</p>
<p>ssh-agent</p>
<p>Echo to the terminal the environment variables that must be set in </p>
<p>order to use the SSH Agent</p>
<p>eval `ssh-agent`</p>
<p>Start the SSH Agent daemon that caches decrypted private keys in</p>
<p>memory; also shows the PID of ssh-agent and sets the appropriate</p>
<p>environment variables.</p>
<p>Once ssh-agent is started, the keys to cache must be added via </p>
<p>the </p>
<p>ssh-add</p>
<p> command; cached keys will then be automatically </p>
<p>used by any SSH tool e.g. </p>
<p>ssh</p>
<p>, </p>
<p>sftp</p>
<p>, </p>
<p>scp</p>
<p> </p>
<p>ssh-agent bash -c 'ssh-add <i>keyfile</i>' </p>
<p>Start ssh-agent and cache the specified key</p>
<p>ssh-add</p>
<p>Add the default private keys to the ssh-agent cache</p>
<p>ssh-add <i>keyfile</i></p>
<p>Add a specific private key to the ssh-agent cache</p>
<p>ssh-copy-id <i>user</i>@<i>host</i></p>
<p>Use locally available keys to authorize, via public key </p>
<p>authentication, login of <i>user</i> on a remote <i>host</i>. </p>
<p>This is done by copying the user's local public key </p>
<p>~/.ssh/id_rsa.pub</p>
<p> to </p>
<p>~/.ssh/authorized_keys</p>
<p> on the remote </p>
<p>host</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>127/189</b></p>
<p><b>SSH tools</b></p>
<p><i>SSH tools</i></p>
<p>scp <i>/path1/file</i> <i>user</i>@<i>host</i>:<i>/path2/</i></p>
<p>scp <i>user</i>@<i>host</i>:<i>/path1/file</i> <i>/path2/</i></p>
<p>scp <i>user1</i>@<i>host1</i>:<i>/path1/file</i> <i>user2</i>@<i>host2</i>:<i>/path2/</i></p>
<p>Non-interactive secure file copy via SSH.</p>
<p>Can transfer files from local to remote, from remote to local, </p>
<p>or between two remote hosts</p>
<p>sftp <i>user</i>@<i>host</i></p>
<p>SSH FTP-like tool for secure file transfer</p>
<p>scponly</p>
<p>SSH wrapper pseudo-shell providing access to remote users </p>
<p>for secure file transfer, but without execution privileges </p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>128/189</b></p>
<p><b>SSH operations</b></p>
<p><i>SSH operations</i></p>
<p><b>SSH port forwarding (aka SSH tunneling)</b></p>
<p>ssh -L 2525:mail.foo.com:25 user@mail.foo.com</p>
<p>Establish a SSH encrypted tunnel from localhost to remote</p>
<p>host mail.foo.com, redirecting traffic from local port 2525 </p>
<p>to port 25 of remote host mail.foo.com.</p>
<p>Useful if the local firewall blocks outgoing port 25.  In this </p>
<p>case, port 2525 is used to go out; the application must be </p>
<p>configured to connect to localhost on port 2525 (instead of</p>
<p>mail.foo.com on port 25)</p>
<p>ssh -L 2525:mail.foo.com:25 user@login.foo.com</p>
<p>Establish a SSH encrypted tunnel from localhost to remote</p>
<p>host login.foo.com.</p>
<p>Remote host login.foo.com will then forward, unencrypted,</p>
<p>all data received over the tunnel on port 2525 to remote </p>
<p>host mail.foo.com on port 25</p>
<p><b>SSH reverse forwarding (aka SSH reverse tunneling)</b></p>
<p>ssh -R 2222:localhost:22 user@login.foo.com</p>
<p>Establish a SSH encrypted reverse tunnel from remote </p>
<p>host login.foo.com back to localhost, redirecting traffic </p>
<p>sent to port 2222 of remote host login.foo.com back </p>
<p>towards local port 22.</p>
<p>Useful if the local firewall blocks incoming connections so </p>
<p>remote hosts cannot connect back to local machine.  In </p>
<p>this case, port 2222 of login.foo.com is opened for </p>
<p>listening and connecting back to localhost on port 22; </p>
<p>remote host login.foo.com is then able to connect to the </p>
<p>local machine on port 2222 (redirected to local port 22)</p>
<p><b>SSH as a SOCKS proxy</b></p>
<p>ssh -D 33333 user@login.foo.com</p>
<p>The application supporting SOCKS must be configured to </p>
<p>connect to localhost on port 33333.  Data is tunneled from</p>
<p>localhost to login.foo.com, then unencrypted to destination</p>
<p><b>X11 Forwarding</b></p>
<p>ssh -X user@login.foo.com</p>
<p>Enable the local display to execute locally a X application </p>
<p>stored on a remote host login.foo.com</p>
<p><b>How to enable public key authentication</b></p>
<p>1.  On remote host, set </p>
<p>PubkeyAuthentication yes</p>
<p> in </p>
<p>/etc/ssh/sshd_config</p>
<p>2.  On local machine, do </p>
<p>ssh-copy-id you@remotehost</p>
<p> (or copy your public key to the remote host by hand)</p>
<p><b>How to enable host-based authentication amongst a group of trusted hosts</b></p>
<p>1.  On all hosts, set </p>
<p>HostbasedAuthentication yes</p>
<p> in </p>
<p>/etc/ssh/sshd_config</p>
<p>2.  On all hosts, create </p>
<p>/etc/ssh/shosts.equiv</p>
<p> and enter in this file all trusted hostnames</p>
<p>3.  Connect via SSH manually from your machine on each host so that all hosts' public keys go into </p>
<p>~/.ssh/known_hosts</p>
<p>4.  Copy </p>
<p>~/.ssh/known_hosts</p>
<p> from your machine to </p>
<p>/etc/ssh/ssh_known_hosts</p>
<p> on all hosts</p>
<p><b>How to enable X11 Forwarding</b></p>
<p>1.  On remote host 10.2.2.2, set </p>
<p>X11Forwarding yes</p>
<p> in </p>
<p>/etc/ssh/sshd_config</p>
<p>, and make sure that </p>
<p>xauth</p>
<p> is installed </p>
<p>2.  On local host 10.1.1.1, type </p>
<p>ssh -X 10.2.2.2</p>
<p>, then run on remote host the graphical application e.g. </p>
<p>xclock &amp;</p>
<p>It is also possible to enable X11 Forwarding via telnet (but this is insecure and obsolete, and therefore not recommended):</p>
<p>1.  On remote host 10.2.2.2, type </p>
<p>export DISPLAY=10.1.1.1:0.0</p>
<p>2.  On local host 10.1.1.1, type </p>
<p>xhost +</p>
<p> </p>
<p>3.  On local host 10.1.1.1, type </p>
<p>telnet 10.2.2.2</p>
<p>, then run on remote host the graphical application e.g. </p>
<p>xclock &amp;</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>129/189</b></p>
<p><b>SSH configuration</b></p>
<p><i>SSH configuration</i></p>
<p>/etc/ssh/sshd_config</p>
<p>SSH server daemon configuration file</p>
<p>/etc/ssh/ssh_config</p>
<p>SSH client global configuration file</p>
<p>/etc/ssh/ssh_host_key</p>
<p>Host's private key (should be mode 0600)</p>
<p>/etc/ssh/ssh_host_key.pub</p>
<p>Host's public key</p>
<p>/etc/ssh/shosts.equiv</p>
<p>Names of trusted hosts for host-based authentication</p>
<p>/etc/ssh/ssh_known_hosts</p>
<p>Database of host public keys that were previously accepted as legitimate</p>
<p>~/.ssh/</p>
<p>User's SSH directory (must be mode 0700)</p>
<p>~/.ssh/config</p>
<p>SSH client user configuration file</p>
<p>~/.ssh/id_rsa</p>
<p>~/.ssh/id_dsa</p>
<p>User's RSA or DSA private key, as generated by </p>
<p>ssh-keygen</p>
<p> </p>
<p>~/.ssh/id_rsa.pub</p>
<p>~/.ssh/id_dsa.pub</p>
<p>User's RSA or DSA public key, as generated by </p>
<p>ssh-keygen</p>
<p> </p>
<p>~/.ssh/known_hosts</p>
<p>Host public keys that were previously accepted as legitimate by the user</p>
<p>~/.ssh/authorized_keys</p>
<p>~/.ssh/authorized_keys2  </p>
<p>(obsolete)</p>
<p>Trusted public keys; the corresponding private keys allow the user to </p>
<p>authenticate on this host</p>
<p><b>/etc/ssh/sshd_config</b></p>
<p><b>     SSH server configuration file</b></p>
<p>PermitRootLogin yes</p>
<p>Control superuser login via SSH.  Possible values are:</p>
<p>yes                   </p>
<p>Superuser can login</p>
<p>no                    </p>
<p>Superuser cannot login</p>
<p>without-password      </p>
<p>Superuser cannot login with password</p>
<p>forced-commands-only  </p>
<p>Superuser can only run commands in SSH command line</p>
<p>AllowUsers jdoe ksmith</p>
<p>DenyUsers jhacker</p>
<p>List of users that can/cannot login via SSH, or </p>
<p>*</p>
<p> for everybody</p>
<p>AllowGroups geeks</p>
<p>DenyGroups *</p>
<p>List of groups whose members can/cannot login via SSH, or </p>
<p>*</p>
<p> for all groups</p>
<p>PasswordAuthentication yes</p>
<p>Permit authentication via login and password </p>
<p>PubKeyAuthentication yes</p>
<p>Permit authentication via public key</p>
<p>HostbasedAuthentication yes</p>
<p>Permit authentication based on trusted hosts </p>
<p>Protocol 1,2</p>
<p>Specify protocols supported by SSH.  Value can be 1 or 2 or both</p>
<p>X11Forwarding yes</p>
<p>Allow X11 Forwarding</p>
<p><b>/etc/ssh/ssh_config</b></p>
<p><b> and </b></p>
<p><b>~/.ssh/config</b></p>
<p><b>     SSH client configuration file</b></p>
<p>Host *</p>
<p>List of hosts to which the following directives will apply, or </p>
<p>*</p>
<p> for all hosts</p>
<p>StrictHostKeyChecking yes</p>
<p>Ask before adding new host keys to the </p>
<p>~/.ssh/known_hosts</p>
<p> file, and refuse to </p>
<p>connect if the key for a known host has changed.  This prevents MITM attacks</p>
<p>GSSAPIAuthentication yes</p>
<p>Support authentication using GSSAPI</p>
<p>ForwardX11Trusted yes</p>
<p>Allow remote X11 clients to fully access the original X11 display</p>
<p>IdentityFile ~/.ssh/id_rsa</p>
<p>User identity file for authentication.  Default values are:</p>
<p>~/.ssh/identity</p>
<p> for protocol version 1</p>
<p>~/.ssh/id_rsa</p>
<p> and </p>
<p>~/.ssh/id_dsa</p>
<p> for protocol version 2</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>130/189</b></p>
<p><b>X.509</b></p>
<p><i>X.509</i></p>
<p>The X.509 standard defines the format of public key certificates and other related files.  It includes cryptographic standards </p>
<p>and protocols such as SSL/TLS, PKCS7, PKCS12, and OCSP.  </p>
<p>The Public Key Infrastructure X.509 (PKIX) is described in RFC 5280.</p>
<p><b>X.509 file formats</b></p>
<p><b>DER</b></p>
<p>Binary-encoded certificate</p>
<p><b>PEM</b></p>
<p>ASCII-armored Base64-encoded certificate, included between these two lines:</p>
<p>-----BEGIN <i>X.509_FILE_TYPE</i>----- </p>
<p>  </p>
<p>-----END <i>X.509_FILE_TYPE</i>-----   </p>
<p>  </p>
<p>DER and PEM are also used as file extensions for different types of files; see below.</p>
<p><b>X.509 file type extensions</b></p>
<p><b>CRT</b></p>
<p><b>CER</b></p>
<p>Certificate or certificate chain</p>
<p><b>CSR</b></p>
<p>Certificate Signing Request</p>
<p><b>KEY</b></p>
<p>Private key</p>
<p><b>CRL</b></p>
<p>Certificate Revocation List</p>
<p><b>DER</b></p>
<p>Certificate; DER-encoded</p>
<p><b>PEM</b></p>
<p>Certificate (including or not the private key), certificate chain, or Certificate Signing Request; </p>
<p>PEM-encoded</p>
<p><b>Other file type extensions</b></p>
<p><b>P12</b></p>
<p><b>PFX</b></p>
<p>Certificate (including or not the private key), certificate chain, or Certificate Signing Request; </p>
<p>bundled in a PKCS#12 archive file format</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>131/189</b></p>
<p><b>OpenSSL</b></p>
<p><i>OpenSSL</i></p>
<p>openssl x509 -text -in <i>cert.crt</i> -noout</p>
<p>Read a certificate</p>
<p>openssl req -text -in <i>cert.csr</i> -noout</p>
<p>Read a Certificate Signing Request</p>
<p>openssl req -new -key <i>cert.key</i> -out <i>cert.csr</i></p>
<p>Generate a Certificate Signing Request, given a </p>
<p>private key</p>
<p>openssl req -new -keyout <i>cert.key</i> -out <i>cert.csr</i> \</p>
<p>-newkey rsa:2048 -nodes</p>
<p>Generate a Certificate Signing Request, creating also </p>
<p>a 2048-bit RSA key pair (unencrypted, for non-</p>
<p>interactive use)</p>
<p>openssl x509 -req -in <i>cert.csr</i> -CAcreateserial \</p>
<p>-CA <i>ca.crt</i> -CAkey <i>ca.key</i> -out <i>cert.crt</i> -days <i>validity</i></p>
<p>Sign a certificate as a CA, given a Certificate Signing </p>
<p>Request</p>
<p>openssl req -x509 -keyout <i>cert.key </i>-out <i>cert.crt</i> \</p>
<p>-newkey rsa:2048 -nodes -days <i>validity</i></p>
<p>Generate a self-signed root certificate, and create a </p>
<p>new CA private key</p>
<p>openssl ca -config <i>ca.conf</i> -in <i>cert.csr</i> \</p>
<p>-out <i>cert.crt</i> -days <i>validity</i> -verbose</p>
<p>Sign a certificate</p>
<p>openssl ca -config <i>ca.conf</i> -gencrl -revoke <i>cert.crt</i> \</p>
<p>-crl_reason <i>why</i></p>
<p>Revoke a certificate</p>
<p>openssl ca -config <i>ca.conf</i> -gencrl -out <i>list.crl</i></p>
<p>Generate a Certificate Revocation List containing all </p>
<p>revoked certificates so far</p>
<p>openssl x509 -in <i>cert.pem</i> -outform DER -out <i>cert.der</i></p>
<p>Convert a certificate from PEM to DER</p>
<p>openssl pkcs12 -export -in <i>cert.pem</i> \</p>
<p>-inkey <i>cert.key</i> -out <i>cert.pfx</i> -name <i>friendlyname</i></p>
<p>Convert a certificate from PEM to PKCS#12 including </p>
<p>the private key</p>
<p>openssl pkcs12 -in <i>cert.p12</i> -out <i>cert.crt</i> -clcerts \</p>
<p>-nokeys</p>
<p>Convert a certificate from PKCS#12 to PEM</p>
<p>openssl pkcs12 -in <i>cert.p12 </i>-out <i>cert.key</i> -nocerts \</p>
<p>-nodes</p>
<p>Extract the private key from a PKCS#12 certificate</p>
<p>openssl pkcs12 -in <i>cert.p12 </i>-out <i>ca.crt</i> -cacerts</p>
<p>Extract the CA certificate from a PKCS#12 certificate</p>
<p>cat <i>cert.crt cert.key</i> &gt; <i>cert.pem</i></p>
<p>Create a PEM certificate from CRT and private key</p>
<p>openssl dgst -<i>hashfunction</i> -out <i>file.hash file</i></p>
<p>Generate the digest (hash) of a file</p>
<p>openssl dgst -<i>hashfunction</i> <i>file</i> | cmp -b <i>file.hash</i></p>
<p>Check the hash of a file; no output means OK</p>
<p>openssl dgst -<i>hashfunction</i> -sign <i>private.key</i> \</p>
<p>-out <i>file.sig file</i></p>
<p>Sign a file</p>
<p>openssl dgst -<i>hashfunction</i> -verify <i>public.key</i> \</p>
<p>-signature <i>file.sig file</i></p>
<p>Verify the signature of a file</p>
<p>openssl enc -e -<i>cipher</i> -in <i>file</i> -out <i>file.enc</i> -salt</p>
<p>Encrypt a file</p>
<p>openssl enc -d -<i>cipher</i> -in <i>file.enc</i> -out <i>file</i></p>
<p>Decrypt a file</p>
<p>openssl genpkey -algorithm RSA -cipher 3des \ </p>
<p>-pkeyopt rsa_keygen_bits:2048 -out <i>keypair.pem</i></p>
<p>Generate a 2048-bit RSA key pair protected by a </p>
<p>TripleDES-encrypted passphrase</p>
<p>openssl pkey -text -in <i>private.key </i>-noout</p>
<p>Examine a private key</p>
<p>openssl pkey -in <i>old.key </i>-out <i>new.key</i> -<i>cipher</i></p>
<p>Change the passphrase of a private key</p>
<p>openssl pkey -in <i>old.key</i> -out <i>new.key</i> </p>
<p>Remove the passphrase from a private key</p>
<p>1.  </p>
<p>openssl s_client -connect <i>www.site.com</i>:443 &gt; <i>tmpfile</i> </p>
<p>Inspect an SSL certificate from a website</p>
<p>2.                      CTRL-C</p>
<p>3.  </p>
<p>openssl x509 -in <i>tmpfile</i> -text</p>
<p>openssl list-message-digest-commands</p>
<p>List all available hash functions</p>
<p>openssl list-cipher-commands</p>
<p>List all available ciphers</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>CTRL</p>
<p>C</p>
<h1 style="page-break-before:always; "></h1>
<p><b>132/189</b></p>
<p><b>CA.pl</b></p>
<p><i>CA.pl</i></p>
<p>CA.pl -newca</p>
<p>Create a Certification Authority hierarchy</p>
<p>CA.pl -newreq</p>
<p>Generate a Certificate Signing Request</p>
<p>CA.pl -newreq-nodes</p>
<p>Generate a Certificate Signing Request, creating also a key pair (unencrypted,</p>
<p>for non-interactive use)</p>
<p>CA.pl -signreq</p>
<p>Sign a Certificate Signing Request</p>
<p>CA.pl -pkcs12 &quot;<i>Certificate name</i>&quot;</p>
<p>Generate a PKCS#12 certificate from a Certificate Signing Request</p>
<p>CA.pl -newcert</p>
<p>Generate a self-signed certificate</p>
<p>CA.pl -verify</p>
<p>Verify a certificate against the Certification Authority certificate for &quot;demoCA&quot;</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>133/189</b></p>
<p><b>GnuPG</b></p>
<p><i>GnuPG</i></p>
<p>GnuPG aka GPG (GNU Privacy Guard) is a well-known implementation of the OpenPGP standard described in RFC 4880.</p>
<p>The OpenPGP standard derives from PGP (Pretty Good Privacy), the first tool for strong encryption available to the general </p>
<p>public. </p>
<p>gpg --gen-key</p>
<p>Generate a key pair</p>
<p>gpg --import <i>alice.asc</i></p>
<p>Import Alice's public key <i>alice.asc</i> into your keyring</p>
<p>gpg --list-keys</p>
<p>List the keys contained into your keyring</p>
<p>gpg --list-secret-keys</p>
<p>List your private keys contained into your keyring</p>
<p>gpg --list-public-keys</p>
<p>List the public keys contained into your keyring</p>
<p>gpg --export -o <i>keyring.gpg</i></p>
<p>Export your whole keyring to a file <i>keyring.gpg</i></p>
<p>gpg --export-secret-key -a &quot;You&quot; -o <i>private.key</i></p>
<p>Export your private key to a file <i>private.key</i></p>
<p>gpg --export-public-key -a &quot;Alice&quot; -o <i>alice.pub</i></p>
<p>Export Alice's public key to a file <i>alice.pub</i></p>
<p>gpg --edit-key &quot;Alice&quot;</p>
<p>Sign Alice's public key</p>
<p>gpg -e -u &quot;You&quot; -r &quot;Alice&quot; <i>file</i></p>
<p>Sign <i>file</i> (with your private key) and encrypt it to Alice </p>
<p>(with Alice's public key) </p>
<p>gpg -d <i>file.gpg</i> -o <i>file</i></p>
<p>Decrypt <i>file.gpg</i> (with your own private key) and save the </p>
<p>decrypted file to <i>file</i></p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>134/189</b></p>
<p><b>OpenVPN</b></p>
<p><i>OpenVPN</i></p>
<p>OpenVPN is an open source software that implements a Virtual Private Network (VPN) between two endpoints.  The </p>
<p>encrypted VPN tunnel uses UDP port 1194.</p>
<p>openvpn --genkey --secret <i>keyfile</i></p>
<p>Generate a shared secret keyfile for OpenVPN authentication.</p>
<p>The keyfile must be copied on both server and client</p>
<p>openvpn server.conf</p>
<p>Start the VPN on the server side</p>
<p>openvpn client.conf</p>
<p>Start the VPN on the client side</p>
<p>/etc/openvpn/server.conf</p>
<p>Server-side configuration file:</p>
<p>dev tun</p>
<p>ifconfig <i>server_IP client_IP</i></p>
<p>keepalive 10 60</p>
<p>ping-timer-rem</p>
<p>persist-tun</p>
<p>persist-key</p>
<p>secret <i>keyfile</i></p>
<p>/etc/openvpn/client.conf</p>
<p>Client-side configuration file:</p>
<p>remote <i>server_public_IP</i></p>
<p>dev tun </p>
<p>ifconfig <i>client_IP server_IP</i></p>
<p>keepalive 10 60</p>
<p>ping-timer-rem</p>
<p>persist-tun</p>
<p>persist-key</p>
<p>secret <i>keyfile</i></p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>135/189</b></p>
<p><b>Security tools</b></p>
<p><i>Security tools</i></p>
<p>md5sum</p>
<p>sha1sum</p>
<p>sha224sum</p>
<p>sha256sum</p>
<p>sha384sum</p>
<p>sha512sum</p>
<p>shasum </p>
<p>Print or check the digest of a file generated by a specific hashing algorithm</p>
<p>stunnel</p>
<p>TLS encryption wrapper.  Can be used to secure any client-server protocol</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>136/189</b></p>
<p><b>Key bindings - terminal</b></p>
<p><i>Key bindings - terminal</i></p>
<p><b> Key</b></p>
<p><b> Alternate key</b></p>
<p><b>Function </b></p>
<p>Move cursor forward one character</p>
<p>Move cursor backward one character</p>
<p>Move cursor to beginning of line</p>
<p>Move cursor to end of line</p>
<p>Delete character to the left of cursor</p>
<p>Delete word to the left of cursor</p>
<p>Delete all characters to the left of cursor</p>
<p>Delete all characters to the right of cursor</p>
<p>Swap current character with previous one</p>
<p>Swap current word with previous one</p>
<p>Scroll up the screen buffer</p>
<p>Scroll down the screen buffer</p>
<p>Clear screen (same as </p>
<p>clear</p>
<p>)</p>
<p>Previous command in history</p>
<p>Next command in history </p>
<p>Reverse history search</p>
<p>Autocomplete commands, filenames, and directory names</p>
<p>Autocomplete filenames and directory names only</p>
<p>Expand the Bash alias currently entered on the command line </p>
<p>Line feed</p>
<p>Carriage return</p>
<p>Pause transfer to terminal</p>
<p>Forward history search (if XON/XOFF flow control is disabled) </p>
<p>Resume transfer to terminal</p>
<p>Send a SIGTSTP to put the current job in background </p>
<p>Send a SIGINT to stop the current process</p>
<p>Send a EOF to current process (same as </p>
<p>logout</p>
<p> if process is a shell)</p>
<p>Send a SIGINT to reboot the machine (same as </p>
<p>shutdown -r now</p>
<p>),</p>
<p>as specified in </p>
<p>/etc/inittab</p>
<p> and </p>
<p>/etc/init/control-alt-delete</p>
<p>Switch between text consoles (same as </p>
<p>chvt <i>n</i></p>
<p>)</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>CTRL</p>
<p>F</p>
<p>CTRL</p>
<p>B</p>
<p>CTRL</p>
<p>A</p>
<p>HOME</p>
<p>CTRL</p>
<p>E</p>
<p>END</p>
<p>CTRL</p>
<p>H</p>
<p>BACKSPACE</p>
<p>CTRL</p>
<p>W</p>
<p>CTRL</p>
<p>U</p>
<p>CTRL</p>
<p>K</p>
<p>CTRL</p>
<p>T</p>
<p>ESC</p>
<p>T</p>
<p>SHIFT</p>
<p>PAGE UP</p>
<p>SHIFT</p>
<p>PAGE DOWN</p>
<p>CTRL</p>
<p>L</p>
<p>CTRL</p>
<p>P</p>
<p>CTRL</p>
<p>N</p>
<p>R</p>
<p>TAB</p>
<p>CTRL</p>
<p>J</p>
<p>RETURN</p>
<p>CTRL</p>
<p>M</p>
<p>CTRL</p>
<p>S</p>
<p>CTRL</p>
<p>Q</p>
<p>CTRL</p>
<p>Z</p>
<p>CTRL</p>
<p>C</p>
<p>CTRL</p>
<p>D</p>
<p>CTRL</p>
<p>ALT</p>
<p>DEL</p>
<p>CTRL</p>
<p>ALT</p>
<p>F1 ... F6</p>
<p>↑</p>
<p>↓</p>
<p>←</p>
<p>→</p>
<p>CTRL</p>
<p>E</p>
<p>ALT</p>
<p>/</p>
<p>ALT</p>
<p>CTRL</p>
<p>CTRL</p>
<p>I</p>
<h1 style="page-break-before:always; "></h1>
<p><b>137/189</b></p>
<p><b>Key bindings - X Window</b></p>
<p><i>Key bindings - X Window</i></p>
<p><b> Key</b></p>
<p><b> Alternate key</b></p>
<p><b>Function </b></p>
<p>Switch between X Window consoles</p>
<p>Increase X Window screen resolution</p>
<p>Decrease X Window screen resolution</p>
<p>Switch between X Window tasks</p>
<p>Switch to next workspace</p>
<p>Switch to previous workspace</p>
<p>Reboot the X Window server</p>
<p><b>GNOME</b></p>
<p>Switch between windows in the current workspace</p>
<p>Show activities overview</p>
<p>Lock screen</p>
<p>Show tray messages</p>
<p>Maximize current window</p>
<p>Restore normal size of current window</p>
<p>Maximize current window to left half screen</p>
<p>Maximize current window to right half screen</p>
<p>Run command</p>
<p>Increase terminal font size</p>
<p>Decrease terminal font size</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>CTRL</p>
<p>ALT</p>
<p>F7 ... F11</p>
<p>CTRL</p>
<p>ALT</p>
<p>+</p>
<p>CTRL</p>
<p>ALT</p>
<p>-</p>
<p>CTRL</p>
<p>TAB</p>
<p>CTRL</p>
<p>ALT</p>
<p>BACKSPACE</p>
<p>CTRL</p>
<p>ALT</p>
<p>→</p>
<p>CTRL</p>
<p>ALT</p>
<p>←</p>
<p>CTRL</p>
<p>ALT</p>
<p>↓</p>
<p>CTRL</p>
<p>ALT</p>
<p>↑</p>
<p>ALT</p>
<p>TAB</p>
<p>SUPER</p>
<p>L</p>
<p>SUPER</p>
<p>M</p>
<p>SUPER</p>
<p>ALT</p>
<p>F2</p>
<p>CTRL</p>
<p>+</p>
<p>CTRL</p>
<p>-</p>
<p>SUPER</p>
<p>↑</p>
<p>SUPER</p>
<p>↓</p>
<p>SUPER</p>
<p>←</p>
<p>SUPER</p>
<p>→</p>
<h1 style="page-break-before:always; "></h1>
<p><b>138/189</b></p>
<p><b>udev</b></p>
<p><i>udev</i></p>
<p>The Hardware Abstraction Layer (HAL) manages device files and provides plug-and-play facilities.  The HAL daemon </p>
<p>hald</p>
<p> </p>
<p>maintains a persistent database of devices.</p>
<p>udev is the device manager for the Linux kernel.  It dynamically generates the device nodes in </p>
<p>/dev/</p>
<p> for devices present on </p>
<p>the system; it also provides persistent naming for storage devices in </p>
<p>/dev/disk</p>
<p>.</p>
<p>When a device is added, removed, or changes state, the kernel sends an uevent received by the </p>
<p>udevd</p>
<p> daemon which will </p>
<p>pass the uevent through a set of rules stored in </p>
<p>/etc/udev/rules.d/*.rules </p>
<p>and</p>
<p> /lib/udev/rules.d/*.rules</p>
<p>.</p>
<p>udevadm monitor</p>
<p>udevmonitor</p>
<p>Show all kernel uevents and udev messages</p>
<p>udevadm info --attribute-walk --name=/dev/sda</p>
<p>Print all attributes of device </p>
<p>/dev/sda</p>
<p> in udev rules key format</p>
<p>cat /sys/block/sda/size</p>
<p>Print the size attribute of disk </p>
<p>sda</p>
<p> in 512-byte blocks.</p>
<p>This information is retrieved from sysfs </p>
<p>udevadm test /dev/sdb</p>
<p>Simulate an udev event run for the device and print debug output</p>
<p>gnome-device-manager</p>
<p>Browser for the HAL device manager</p>
<p><b>/etc/udev/rules.d/*.rules </b></p>
<p><b>and</b></p>
<p><b> /lib/udev/rules.d/*.rules</b></p>
<p><b>     udev rules</b></p>
<p>KERNEL==&quot;hda&quot;, NAME=&quot;mydisk&quot;</p>
<p>Match a device which was named by the </p>
<p>kernel as </p>
<p>hda</p>
<p>; name the device node as </p>
<p>&quot;mydisk&quot;.  The device node will be therefore</p>
<p>/dev/mydisk</p>
<p> </p>
<p>KERNEL==&quot;hdb&quot;, DRIVER==&quot;ide-disk&quot;, SYMLINK+=&quot;mydisk myhd&quot;</p>
<p>Match a device with kernel name and driver </p>
<p>as specified; name the device node with the </p>
<p>default name and create two symbolic links</p>
<p>/dev/mydisk</p>
<p> and </p>
<p>/dev/myhd</p>
<p> pointing to </p>
<p>/dev/hdb</p>
<p> </p>
<p>KERNEL==&quot;fd<i>[0-9]</i>*&quot;, NAME=&quot;floppy/%n&quot;, SYMLINK+=&quot;%k&quot;</p>
<p>Match all floppy disk drives (i.e. </p>
<p>fd<i>n</i></p>
<p>); place </p>
<p>device node in </p>
<p>/dev/floppy/<i>n</i></p>
<p> and create a </p>
<p>symlink </p>
<p>/dev/fd<i>n</i></p>
<p> to it</p>
<p>SUBSYSTEM==&quot;block&quot;, ATTR{size}==&quot;41943040&quot;, SYMLINK+=&quot;mydisk&quot;</p>
<p>Match a block device with a size attribute of </p>
<p>41943040; create a symlink </p>
<p>/dev/mydisk</p>
<p> </p>
<p>KERNEL==&quot;fd<i>[0-9]</i>*&quot;, OWNER=&quot;jdoe&quot;</p>
<p>Match all floppy disk drives; give ownership </p>
<p>of the device file to user &quot;jdoe&quot;</p>
<p>KERNEL==&quot;sda&quot;, PROGRAM=&quot;/bin/mydevicenamer %k&quot;, SYMLINK+=&quot;%c&quot;</p>
<p>Match a device named by the kernel as </p>
<p>sda</p>
<p>; </p>
<p>to name the device, use the defined </p>
<p>program which takes on stdin the kernel </p>
<p>name and output on stdout e.g. <i>name1 </i></p>
<p><i>name2</i>.  Create symlinks </p>
<p>/dev/<i>name1</i></p>
<p> and </p>
<p>/dev/<i>name2</i></p>
<p> pointing to </p>
<p>/dev/sda</p>
<p>KERNEL==&quot;sda&quot;, ACTION==&quot;add&quot;, RUN+=&quot;/bin/myprogram&quot;</p>
<p>Match a device named by the kernel as </p>
<p>sda</p>
<p>; </p>
<p>run the defined program when the device is </p>
<p>connected</p>
<p>KERNEL==&quot;sda&quot;, ACTION==&quot;remove&quot;, RUN+=&quot;/bin/myprogram&quot;</p>
<p>Match a device named by the kernel as </p>
<p>sda</p>
<p>; </p>
<p>run the defined program when the device is </p>
<p>disconnected</p>
<p>%n</p>
<p> = kernel number (e.g. = </p>
<p>3</p>
<p> for </p>
<p>fd3</p>
<p>)</p>
<p>%k</p>
<p> = kernel name (e.g. = </p>
<p>fd3</p>
<p> for </p>
<p>fd3</p>
<p>)</p>
<p>%c</p>
<p> = device name as output from program</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>139/189</b></p>
<p><b>Kernel</b></p>
<p><i>Kernel</i></p>
<p>A kernel version number has the form <i>major.minor.patchlevel</i>.</p>
<p>Kernel images are usually gzip-compressed and can be of two types: zImage (max 520 Kb) and bzImage (no size limit).</p>
<p>Kernel modules can be loaded dynamically into the kernel to provide additional functionalities on demand, instead of being </p>
<p>included when the kernel is compiled; this reduces memory footprint.</p>
<p>kerneld</p>
<p> (daemon) and </p>
<p>kmod</p>
<p> (kernel thread) facilitate the dynamic loading of kernel modules.</p>
<p>/lib/modules/<i>X.Y.Z</i>/*.ko</p>
<p>Kernel modules for kernel version <i>X.Y.Z</i></p>
<p>/lib/modules/<i>X.Y.Z</i>/modules.dep</p>
<p>Modules dependencies.</p>
<p>This file needs to be recreated (via the command </p>
<p>depmod -a</p>
<p>) </p>
<p>after a reboot or a change in module dependencies</p>
<p>/etc/modules.conf</p>
<p>/etc/conf.modules  </p>
<p>(deprecated)</p>
<p>Modules configuration file</p>
<p>/usr/src/linux/</p>
<p>Directory containing the kernel source code to be compiled</p>
<p>/usr/src/linux/.config</p>
<p>Kernel configuration file</p>
<p>freeramdisk</p>
<p>Free the memory used for the </p>
<p>initrd</p>
<p> image.  This command </p>
<p>must be run directly after unmounting </p>
<p>/initrd</p>
<p>mkinitrd <i>initrd_image kernel_version  </i></p>
<p>(Red Hat)</p>
<p>Create an </p>
<p>initrd</p>
<p> image file </p>
<p>mkinitramfs  </p>
<p>(Debian)</p>
<p>Create an </p>
<p>initrd</p>
<p> image file according to the configuration file</p>
<p>/etc/initramfs-tools/initramfs.conf</p>
<p> </p>
<p>dracut</p>
<p>Create initial ramdisk images for preloading modules</p>
<p>dbus-monitor</p>
<p>Monitor messages going through a D-Bus message bus</p>
<p>dbus-monitor --session</p>
<p>Monitor session messages (default)</p>
<p>dbus-monitor --system</p>
<p>Monitor system messages</p>
<p>kexec -l <i>kernel_image</i> --append=<i>options</i> \</p>
<p>--initrd=<i>initrd_image</i> &amp;&amp; kexec -e</p>
<p>Load a kernel image file into memory and boot it.  This allows </p>
<p>running a different kernel without rebooting the machine </p>
<p>The runtime loader </p>
<p>ld.so</p>
<p> loads the required shared libraries of the program into RAM, searching in this order:</p>
<p>1.</p>
<p>LD_LIBRARY_PATH</p>
<p>Environment variable specifying the list of dirs where libraries should be searched for first</p>
<p>2.</p>
<p>/etc/ld.so.cache</p>
<p>Cache file</p>
<p>3.</p>
<p>/lib</p>
<p> and </p>
<p>/usr/lib</p>
<p>Default locations for shared libraries</p>
<p>Shared library locations (other than the default ones </p>
<p>/lib</p>
<p> and </p>
<p>/usr/lib</p>
<p>) can be specified in the file </p>
<p>/etc/ld.so.conf</p>
<p>.</p>
<p>ldconfig</p>
<p>Create a cache file </p>
<p>/etc/ld.so.cache</p>
<p> of all available </p>
<p>dynamically linked libraries.  This command should be run </p>
<p>when the system complains about missing libraries</p>
<p>ldd <i>program_or_lib</i></p>
<p>Print library dependencies</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>140/189</b></p>
<p><b>Kernel management</b></p>
<p><i>Kernel management</i></p>
<p>lspci</p>
<p>List PCI devices</p>
<p>lspci -d 8086:</p>
<p>List all Intel hardware present.  PCI IDs are stored in:</p>
<p>/usr/share/misc/pci.ids    </p>
<p>(Debian)</p>
<p>/usr/share/hwdata/pci.ids  </p>
<p>(Red Hat)</p>
<p>lsusb</p>
<p>List USB devices</p>
<p>lsusb -d 8086:</p>
<p>List all Intel USB devices present.  USB IDs are stored in:</p>
<p>/var/lib/usbutils/usb.ids  </p>
<p>(Debian)</p>
<p>/usr/share/hwdata/usb.ids  </p>
<p>(Red Hat)</p>
<p>lsdev</p>
<p>List information about the system hardware</p>
<p>lshw</p>
<p>List system hardware</p>
<p>lscpu</p>
<p>List information about the CPU architecture</p>
<p>uname</p>
<p>Print system information.  Values that can be printed are:</p>
<p>-s  </p>
<p>Kernel name</p>
<p>-n  </p>
<p>Network node hostname</p>
<p>-r  </p>
<p>Kernel release number <i>X.Y.Z</i></p>
<p>-v  </p>
<p>Kernel version number</p>
<p>-m  </p>
<p>Machine hardware name</p>
<p>-p  </p>
<p>Processor type</p>
<p>-i  </p>
<p>Hardware platform</p>
<p>-o  </p>
<p>Operating system</p>
<p>-a  </p>
<p>All the above information, in that order</p>
<p>evtest</p>
<p>Monitor and query input device events in </p>
<p>/dev/input/event<i>n</i></p>
<p>dmesg</p>
<p>Print the messages of the kernel ring buffer.  Options are:</p>
<p>-T    </p>
<p>Print human-readable timestamps</p>
<p>-n 1  </p>
<p>Set the logging level to 1 (= only panic messages)</p>
<p>journalctl</p>
<p>Display the Systemd journal, which contains the kernel logs</p>
<p>journalctl -n <i>n</i></p>
<p>Display the most recent <i>n</i> log lines (default is 10)</p>
<p>journalctl --since &quot;1 hour ago&quot;</p>
<p>Display events happened in the last hour</p>
<p>journalctl -x</p>
<p>Display events, adding explanations from the message catalog</p>
<p>journalctl -f</p>
<p>Display the journal in real-time</p>
<p>journalctl -u crond.service</p>
<p>journalctl _SYSTEMD_UNIT=crond.service</p>
<p>Display the log entries created by the cron service</p>
<p>mkdir -p /var/log/journal/ &amp;&amp; \</p>
<p>systemctl restart systemd-journald</p>
<p>Enable persistent storage of logs in </p>
<p>/var/log/journal/</p>
<p>(by default, journalctl stores the logfiles in RAM only)</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>141/189</b></p>
<p><b>Kernel compile and patching</b></p>
<p><i>Kernel compile and patching</i></p>
<p><b>Kernel compile</b></p>
<p><b>Download</b></p>
<p>Download the kernel source code </p>
<p>linux-<i>X.Y.Z</i>.tar.bz2</p>
<p> from </p>
<p>http://www.kernel.org</p>
<p> </p>
<p>to the base of the kernel source tree </p>
<p>/usr/src/linux</p>
<p><b>Clean</b></p>
<p>make clean</p>
<p>Delete most generated files</p>
<p>make mrproper</p>
<p>Delete all generated files and kernel configuration</p>
<p>make distclean</p>
<p>Delete temporary files, patch leftovers, and similar files</p>
<p><b>Configure</b></p>
<p>make config</p>
<p>Terminal-based (options must be set in sequence)</p>
<p>make menuconfig</p>
<p>Ncurses UI</p>
<p>make xconfig</p>
<p>make gconfig</p>
<p>GUI</p>
<p>make oldconfig</p>
<p>Create a new configuration file, based on the options in the old </p>
<p>configuration file and in the source code</p>
<p>Components (e.g. device drivers) can be either:</p>
<p>- not compiled</p>
<p>- compiled into the kernel binary, for support of devices always used on the system or necessary for </p>
<p>the system to boot</p>
<p>- compiled as a kernel module, for optional devices</p>
<p>The configuration command creates a configuration file </p>
<p>/usr/src/linux/.config</p>
<p> containing </p>
<p>instructions for the kernel compilation</p>
<p><b>Build</b></p>
<p>make bzImage</p>
<p>Compile the kernel</p>
<p>make modules</p>
<p>Compile the kernel modules</p>
<p>make all</p>
<p>Compile kernel and kernel modules</p>
<p>make -j2 all</p>
<p> will speed up compilation by allocating 2 simultaneous compile jobs</p>
<p><b>Modules install</b></p>
<p>make modules_install</p>
<p>Install the previously built modules present in </p>
<p>/lib/modules/<i>X.Y.Z</i></p>
<p><b>Kernel install</b></p>
<p>make install</p>
<p>Install the kernel automatically</p>
<p>To install the kernel by hand:</p>
<p>1.  Copy the new compiled kernel and other files into the boot partition:</p>
<p>cp /usr/src/linux/<i>arch</i>/boot/bzImage /boot/vmlinuz-<i>X.Y.Z </i></p>
<p>(kernel)</p>
<p>cp /usr/src/linux/<i>arch</i>/boot/System.map-<i>X.Y.Z </i>/boot </p>
<p>   </p>
<p>cp /usr/src/linux/<i>arch</i>/boot/config-<i>X.Y.Z </i>/boot </p>
<p>(config options used for this compile)</p>
<p>2.  Create an entry in GRUB to boot on the new kernel</p>
<p><b>Package</b></p>
<p>Optionally, the kernel can be packaged for install on other machines</p>
<p>make rpm-pkg</p>
<p>Build source and binary RPM packages</p>
<p>make binrpm-pkg</p>
<p>Build binary RPM package</p>
<p>make deb-pkg</p>
<p>Builds binary DEB package</p>
<p><b>Kernel patching</b></p>
<p><b>Download</b></p>
<p>Download and decompress the patch to </p>
<p>/usr/src</p>
<p><b>Patch</b></p>
<p>patch -p1 &lt; file.patch</p>
<p>Apply the patch</p>
<p>patch -Rp1 &lt; file.patch</p>
<p>Remove (reverse) a patch.</p>
<p>Alternatively, applying the patch again reverses it</p>
<p><b>Build</b></p>
<p>Build the patched kernel as explained above</p>
<p><b>Install</b></p>
<p>Install the patched kernel as explained above</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>142/189</b></p>
<p><b>Kernel modules</b></p>
<p><i>Kernel modules</i></p>
<p>Kernel modules allow the kernel to access functions (symbols) for kernel services e.g. hardware drivers, network stack, or </p>
<p>filesystem abstraction.</p>
<p>lsmod</p>
<p>List the modules that are currently loaded into the kernel</p>
<p>insmod <i>module</i></p>
<p>Insert a module into the kernel.  If the module requires another module or if it </p>
<p>does not detect compatible hardware, insertion will fail</p>
<p>rmmod <i>module</i></p>
<p>Remove a module from the kernel.  If the module is in use by another module, it</p>
<p>is necessary to remove the latter first</p>
<p>modinfo <i>module</i></p>
<p>Display the list of parameters accepted by the module</p>
<p>depmod -a</p>
<p>Probe all modules in the kernel modules directory and generate the file that lists </p>
<p>their dependencies</p>
<p>It is recommended to use </p>
<p>modprobe</p>
<p> instead of </p>
<p>insmod</p>
<p> and </p>
<p>rmmod</p>
<p>, because it automatically handles prerequisites when </p>
<p>inserting modules, is more specific about errors, and accepts just the module name instead of requiring the full pathname. </p>
<p>modprobe <i>module</i> <i>option</i>=<i>value</i></p>
<p>Insert a module into the running kernel, with the specified parameters.  </p>
<p>Prerequisite modules will be inserted automatically</p>
<p>modprobe -a</p>
<p>Insert all modules</p>
<p>modprobe -t <i>directory</i></p>
<p>Attempt to load all modules contained in the directory until a module succeeds.</p>
<p>This action probes the hardware by successive module-insertion attempts for a </p>
<p>single type of hardware, e.g. a network adapter</p>
<p>modprobe -r <i>module</i></p>
<p>Remove a module</p>
<p>modprobe -c <i>module</i></p>
<p>Display module configuration</p>
<p>modprobe -l</p>
<p>List loaded modules</p>
<p><b>Configuration of device drivers</b></p>
<p>Device drivers support the kernel with instructions on how to use that device.</p>
<p><b>Device driver compiled</b></p>
<p><b>into the kernel</b></p>
<p>Configure the device driver by passing a kernel parameter in the GRUB menu:</p>
<p>kernel /vmlinuz ro root=/dev/vg0/root vga=0x33c</p>
<p><b>Device driver provided</b></p>
<p><b>as a kernel module</b></p>
<p>Edit module configuration in </p>
<p>/etc/modprobe.conf</p>
<p> or </p>
<p>/etc/modprobe.d/</p>
<p> (Red Hat):</p>
<p>alias eth0 3c59x</p>
<p>Specify that eth0 uses the </p>
<p>3c59x.ko</p>
<p> driver module</p>
<p>options 3c509 irq=10,11</p>
<p>Assign IRQ 10 and 11 to 3c509 devices</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>143/189</b></p>
<p><b>/proc</b></p>
<p><i>/proc</i></p>
<p>/proc</p>
<p> is a pseudo filesystem that gives access to process data held in the kernel.</p>
<p><b>File</b></p>
<p><b>Information stored (can be viewed via </b></p>
<p><b>cat</b></p>
<p><b>)</b></p>
<p><b>Equivalent command </b></p>
<p>/proc/bus</p>
<p>Buses (e.g. PCI, USB, PC Card)</p>
<p>/proc/cpuinfo</p>
<p>CPUs information</p>
<p>/proc/devices</p>
<p>Drivers currently loaded</p>
<p>/proc/dma</p>
<p>DMA channels in use</p>
<p>/proc/filesystems</p>
<p>Filesystems supported by the system</p>
<p>/proc/interrupts</p>
<p>Current IRQs (Interrupt Requests)</p>
<p>procinfo</p>
<p>/proc/ioports</p>
<p>I/O addresses in use</p>
<p>/proc/kcore</p>
<p>Memory allocatable by the kernel</p>
<p>/proc/loadavg</p>
<p>System load averages</p>
<p>uptime</p>
<p>/proc/mdstat</p>
<p>Information about RAID arrays and devices</p>
<p>/proc/meminfo</p>
<p>Total and free memory</p>
<p>free</p>
<p>/proc/modules</p>
<p>Kernel modules currently loaded</p>
<p>lsmod</p>
<p>/proc/mounts</p>
<p>Mounted partitions</p>
<p>mount</p>
<p>/proc/net/dev</p>
<p>Network interface statistics</p>
<p>/proc/partitions</p>
<p>Drive partition information</p>
<p>fdisk -l</p>
<p>/proc/swaps</p>
<p>Size of total and used swap areas</p>
<p>swapon -s</p>
<p>/proc/sys/</p>
<p>sysfs: exposes tunable kernel parameters</p>
<p>/proc/sys/kernel/</p>
<p>Kernel information and parameters</p>
<p>/proc/sys/net/</p>
<p>Network information and parameters</p>
<p>/proc/uptime</p>
<p>Time elapsed since boot</p>
<p>uptime</p>
<p>/proc/version</p>
<p>Linux version</p>
<p>uname -a</p>
<p>/proc/<i>n</i>/</p>
<p>Information about process with PID <i>n</i></p>
<p>ps <i>n</i></p>
<p>/proc/<i>n</i>/cmdline</p>
<p>Command by which the process was launched</p>
<p>/proc/<i>n</i>/cwd</p>
<p>Symlink to process' working directory</p>
<p>/proc/<i>n</i>/environ</p>
<p>Values of environment variables of process</p>
<p>/proc/<i>n</i>/exe</p>
<p>Symlink to process' executable</p>
<p>/proc/<i>n</i>/fd</p>
<p>Files currently opened by the process</p>
<p>lsof -p <i>n</i></p>
<p>/proc/<i>n</i>/root</p>
<p>Symlink to process' filesystem root</p>
<p>/proc/<i>n</i>/status</p>
<p>Status of process</p>
<p>/proc/sys</p>
<p> is the only writable branch of </p>
<p>/proc</p>
<p> and can be used to tune kernel parameters on-the-fly.</p>
<p>All changes are lost after system shutdown, unless applied via </p>
<p>sysctl -p</p>
<p>.</p>
<p>sysctl fs.file-max</p>
<p>cat /proc/sys/fs/file-max</p>
<p>Get the maximum allowed number of open files</p>
<p>sysctl -w &quot;fs.file-max=100000&quot;</p>
<p>echo &quot;100000&quot; &gt; /proc/sys/fs/file-max</p>
<p>Set the maximum allowed number of open files to 100000</p>
<p>sysctl -a</p>
<p>List all available kernel tuning options</p>
<p>sysctl -p</p>
<p>Apply all tuning settings listed in </p>
<p>/etc/sysctl.conf</p>
<p>. </p>
<p>This command is usually run at boot by the system initialization script, </p>
<p>to make permanent changes to kernel parameters</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>144/189</b></p>
<p><b>/dev</b></p>
<p><i>/dev</i></p>
<p>/dev</p>
<p> contains the device files to access all devices in the system.</p>
<p><b>File</b></p>
<p><b>Device</b></p>
<p>/dev/sda</p>
<p>SCSI, PATA, or SATA hard drive</p>
<p>/dev/hda</p>
<p>IDE hard drive</p>
<p>/dev/pda</p>
<p>Parallel port IDE hard drive</p>
<p>/dev/vda</p>
<p>Virtual disk for KVM-based virtual machines</p>
<p>/dev/sda</p>
<p>, </p>
<p>/dev/sdb</p>
<p>, </p>
<p>/dev/sdc</p>
<p> ...</p>
<p> </p>
<p>First, second, third ... hard drive</p>
<p>/dev/sda1</p>
<p>, </p>
<p>/dev/sda2</p>
<p>, </p>
<p>/dev/sda3</p>
<p> ...  </p>
<p>First, second, third ... partition of the first hard drive</p>
<p>/dev/md0</p>
<p>Metadisk group, for use with RAID</p>
<p>/dev/sr0</p>
<p>SCSI CD-ROM</p>
<p>/dev/pcd0</p>
<p>Parallel port CD-ROM</p>
<p>/dev/cdrom</p>
<p>CD-ROM.  Usually symlinked to </p>
<p>/dev/sr0</p>
<p>/dev/fd0</p>
<p>Floppy disk drive</p>
<p>/dev/ht0</p>
<p>IDE tape drive</p>
<p>/dev/pt0</p>
<p>Parallel port tape drive</p>
<p>/dev/sg0</p>
<p>Generic SCSI device</p>
<p>/dev/loop0</p>
<p>Loopback device</p>
<p>/dev/autofs</p>
<p>AutoFS device</p>
<p>/dev/fuse</p>
<p>FUSE device</p>
<p>/dev/dsp</p>
<p>Digital Signal Processor device.  Interfaces with the soundcard</p>
<p>/dev/fb0</p>
<p>Framebuffer device.  Interfaces with the graphics hardware</p>
<p>/dev/lp0</p>
<p>Parallel port printer device</p>
<p>/dev/parport0</p>
<p>Raw parallel port device</p>
<p>/dev/mem</p>
<p>Physical memory</p>
<p>/dev/kmem</p>
<p>Kernel virtual memory</p>
<p>/dev/core</p>
<p>Obsolete.  Symlink to </p>
<p>/proc/kcore</p>
<p>/dev/stdin</p>
<p>Standard Input</p>
<p>/dev/stdout</p>
<p>Standard Output</p>
<p>/dev/stderr</p>
<p>Standard Error</p>
<p>/dev/null </p>
<p>Null device, aka blackhole or bit bucket.  Discards any received data</p>
<p>/dev/zero</p>
<p>Zero device.  Outputs an infinite stream of zero bytes (NUL) on reads</p>
<p>/dev/full</p>
<p>&quot;Always full&quot; device.  Similar to </p>
<p>/dev/zero</p>
<p>, and also returns an error &quot;No </p>
<p>space left on device&quot; (ENOSPC) on writes </p>
<p>/dev/random</p>
<p>Non-deterministic random number generator.  Gathers entropy from the </p>
<p>system to generate randomness; once the entropy pool is depleted, the </p>
<p>device blocks all reads until it can collect more entropy</p>
<p>/dev/urandom</p>
<p>Pseudo random number generator.  Faster but unsafe for cryptographic </p>
<p>purposes</p>
<p>/dev/console</p>
<p>System console</p>
<p>/dev/tty</p>
<p>Terminal for current process</p>
<p>/dev/tty0</p>
<p>Current virtual console</p>
<p>/dev/ttyS0</p>
<p>Serial port, usually used for modem connections</p>
<p>/dev/ptyp0</p>
<p>Pseudo-TTY master</p>
<p>/dev/ttyp0</p>
<p>Pseudo-TTY slave</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>145/189</b></p>
<p><b>System recovery</b></p>
<p><i>System recovery</i></p>
<p>If the kernel has been booted in emergency mode and </p>
<p>init</p>
<p> has not been run, some initial configuration is necessary e.g.</p>
<p>mount /proc</p>
<p>mount -o remount,rw /</p>
<p>mount -a</p>
<p>If mounting the filesystems fails:</p>
<p>mknod /dev/sda</p>
<p>mknod /dev/sda1</p>
<p>fdisk -l /dev/sda</p>
<p>fsck -y /dev/sda1</p>
<p>mount -t ext3 /dev/sda1 /mnt/sysimage</p>
<p>chroot /mnt/sysimage</p>
<p>To install a package using an alternative root directory (useful if the system has been booted from a removable media):</p>
<p>rpm -U --root /mnt/sysimage package.rpm</p>
<p>To install GRUB on the specified directory (which must contain </p>
<p>/boot/grub/</p>
<p>):</p>
<p>grub-install –-root-directory=/mnt/sysimage /dev/sda</p>
<p>Alternative method:</p>
<p>chroot /mnt/sysimage</p>
<p>grub-install /dev/sda</p>
<p>Run </p>
<p>sync</p>
<p> and unmount all filesystems before exiting the shell, to ensure that all changes have been written on disk.</p>
<p><b>How to reset the root password (RHEL 7 and 8)</b></p>
<p>1.</p>
<p>Power up the system and, once on the GRUB 2 boot screen, press         to edit the current entry</p>
<p>2.</p>
<p>On the kernel line that mentions </p>
<p>linux16</p>
<p>, remove the </p>
<p>rhgb</p>
<p> and </p>
<p>quiet</p>
<p> parameters and add </p>
<p>rd.break</p>
<p> at the end </p>
<p>3.</p>
<p>Press                   ; the system will boot on the initramfs </p>
<p>switch_root</p>
<p> prompt</p>
<p>4.</p>
<p>Remount the filesystem as writable</p>
<p>mount -o remount,rw /sysroot</p>
<p>5.</p>
<p>Change the filesystem root</p>
<p>chroot /sysroot</p>
<p>6.</p>
<p>Modify the root password</p>
<p>passwd root</p>
<p>7.</p>
<p>Force SELinux to relabel context on next boot</p>
<p>touch /.autorelabel</p>
<p>8.</p>
<p>Remount the filesystem as readonly (not strictly necessary)</p>
<p>mount -o remount,ro /sysroot</p>
<p>9.</p>
<p>Exit the chroot environment</p>
<p>exit</p>
<p>10.</p>
<p>Resume system boot</p>
<p>exit</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>CTRL</p>
<p>X</p>
<p>E</p>
<h1 style="page-break-before:always; "></h1>
<p><b>146/189</b></p>
<p><b>DNS</b></p>
<p><i>DNS</i></p>
<p><b>DNS implementations</b></p>
<p>BIND</p>
<p>Berkeley Internet Name Domain system, is the standard DNS server for UNIX </p>
<p>Unbound</p>
<p>Standard DNS server in RHEL 7</p>
<p>dnsmasq</p>
<p>Lightweight DNS, DHCP and TFTP server for a small network</p>
<p>djbdns</p>
<p>Security-hardened DNS server that also includes DNS debugging tools</p>
<p>PowerDNS</p>
<p>Alternative open-source DNS server</p>
<p>named</p>
<p>BIND Name Daemon</p>
<p>ndc</p>
<p>Name Daemon Controller for BIND 8</p>
<p>rndc</p>
<p>Remote Name Daemon Controller for BIND 9, uses a shared key to communicate securely with </p>
<p>named</p>
<p>dnswalk <i>example.org.</i></p>
<p>DNS debugger</p>
<p>rndc reconfig</p>
<p>Reload BIND configuration and new zones</p>
<p>rndc reload <i>example.org</i></p>
<p>Reload the zone <i>example.org</i></p>
<p>rndc freeze <i>example.org</i></p>
<p>Suspend updates for the zone <i>example.org</i></p>
<p>rndc thaw <i>example.org</i></p>
<p>Resume updates for the zone <i>example.org</i></p>
<p>rndc tsig-list</p>
<p>List all currently active TSIG keys</p>
<p>DNSSEC was designed to secure the DNS tree and hence prevent cache poisoning.</p>
<p>The TSIG (Transaction SIGnature) standard, that authenticates communications between two trusted systems, is used to </p>
<p>sign zone transfers and DDNS (Dynamic DNS) updates. </p>
<p>dnssec-keygen -a dsa -b 1024 \</p>
<p>-n HOST <i>dns1.example.org </i></p>
<p>Generate a TSIG key with DNSSEC algorithm <i>nnn</i> and key fingerprint <i>fffff</i>.</p>
<p>This will create two key files</p>
<p>Kdns1.example.org.+<i>nnn</i>+<i>fffff</i>.key</p>
<p>   </p>
<p>Kdns1.example.org.+<i>nnn</i>+<i>fffff</i>.private</p>
<p>   </p>
<p>which contain a key number that must be inserted both in </p>
<p>/etc/named.conf</p>
<p> and</p>
<p>/etc/rndc.conf</p>
<p>rndc-confgen -a</p>
<p>Generate a </p>
<p>/etc/rndc.key</p>
<p> key file:</p>
<p>key &quot;rndc-key&quot; {</p>
<p>   algorithm hmac-md5;</p>
<p>   secret &quot;vyZqL3tPHsqnA57e4LT0Ek==&quot;;</p>
<p>};</p>
<p>options {</p>
<p>   default-key &quot;rndc-key&quot;;</p>
<p>   default-server 127.0.0.1;</p>
<p>   default-port 953;</p>
<p>};</p>
<p>This file is automatically read both by </p>
<p>named</p>
<p> and </p>
<p>rndc</p>
<p>dnssec-signzone <i>example.org</i></p>
<p>Sign the zone <i>example.org</i></p>
<p>named -u named -g named</p>
<p>Run BIND as user/group &quot;named&quot; (must be created if needed) instead of root</p>
<p>named -t /var/cache/bind</p>
<p>Run BIND in a chroot jail </p>
<p>/var/cache/bind</p>
<p> </p>
<p>(actually it is the </p>
<p>chroot</p>
<p> command that starts the </p>
<p>named</p>
<p> server)</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>147/189</b></p>
<p><b>DNS configuration</b></p>
<p><i>DNS configuration</i></p>
<p><b>/etc/named.conf</b></p>
<p><b>     DNS server configuration file</b></p>
<p>controls {</p>
<p>   inet 127.0.0.1 allow {localhost;} keys {rndckey;};</p>
<p>};</p>
<p>key &quot;rndc-key&quot; {                                // TSIG key</p>
<p>   algorithm dsa;</p>
<p>   secret &quot;HYZur46fftdUQ43BJKI093t4t78lkp&quot;;</p>
<p>};</p>
<p>acl &quot;mynetwork&quot; {10.7.0.0/24;};                // Alias definition</p>
<p>                                               // Built-in ACLs: any, none, localhost, localnets</p>
<p>options {</p>
<p>   directory &quot;/var/named&quot;;                     // Working directory</p>
<p>   version &quot;0.0&quot;;                              // Hide version number by replacing it with 0.0</p>
<p>   listen-on port 53 {10.7.0.1; 127.0.0.1;};   // Port and own IP addresses to listen on</p>
<p>   blackhole {172.17.17.0/24;};                // IPs whose packets are to be ignored</p>
<p>   allow-query {mynetwork;};                   // IPs allowed to do iterative queries</p>
<p>   allow-query-on {any;};                      // Local IPs that can accept iterative queries</p>
<p>   allow-query-cache {any;};                   // IPs that can get an answer from cache </p>
<p>   allow-recursion {mynetwork;};      // IPs to accept recursive queries from (typically </p>
<p>                                      // own network's IPs).  The DNS server does the full</p>
<p>                                      // resolution process on behalf of these client IPs,</p>
<p>                                      // and returns a referral for the other IPs</p>
<p>   allow-recursion-on {mynetwork;};   // Local IPs that can accept recursive queries</p>
<p>   allow-transfer {10.7.0.254;};      // Zone transfer is restricted to these IPs (slaves);</p>
<p>                                      // on slave servers, this option should be disabled</p>
<p>   allow-update {any;};               // IPs to accept DDNS updates from</p>
<p>   recursive-clients 1000;            // Max number of simultaneous recursive lookups</p>
<p>   dnssec-enable yes;                 // Enable DNSSEC</p>
<p>   dialup no;                         // Not a dialup connection: external zone maintenance</p>
<p>                                      // (e.g. sending heartbeat packets, external zone transfers)</p>
<p>                                      // is then permitted </p>
<p>   forward first;                              // Site-wide cache: bypass the normal resolution </p>
<p>   forwarders {10.7.0.252; 10.7.0.253;};       // method by querying first these central DNS</p>
<p>                                               // servers if they are available</p>
<p>};</p>
<p>// Define the root name servers</p>
<p>zone &quot;.&quot; {</p>
<p>   type hint;</p>
<p>   file &quot;root.cache&quot;;</p>
<p>}</p>
<p>// Configure system to act as a master server for the example.org domain</p>
<p>zone &quot;example.org&quot; IN {      </p>
<p>   type master;</p>
<p>   file &quot;master/example.org.zone&quot;;     // Zone file for the example.org domain</p>
<p>};</p>
<p>zone &quot;240.123.224.in-addr.arpa&quot; IN {   // Configure reverse lookup zone (for 224.123.240.0/24)   </p>
<p>   type master;</p>
<p>   file &quot;slave/example.org.revzone&quot;;</p>
<p>};</p>
<p>// Configure system to act as a slave server for the example2.org domain</p>
<p>zone &quot;example2.org&quot; IN {      </p>
<p>   type slave;</p>
<p>   file &quot;slave/example2.org.zone&quot;;     // Slave: do not edit this zone file!</p>
<p>   masters {10.7.0.254;};</p>
<p>};</p>
<p>zone &quot;0.7.10.in-addr.arpa&quot; IN {        // Configure reverse lookup zone (for 10.7.0.0/24)      </p>
<p>   type slave;</p>
<p>   file &quot;slave/10.7.0.revzone&quot;;</p>
<p>   masters {10.7.0.254;};</p>
<p>};</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>148/189</b></p>
<p><b>DNS zone file</b></p>
<p><i>DNS zone file</i></p>
<p><b>/var/named/master/example.org.zone</b></p>
<p><b>     DNS zone file for the example.org zone</b></p>
<p>$TTL 86400      ; TTL (1 day)</p>
<p>$ORIGIN example.org.</p>
<p>example.org IN SOA dns1.example.org. help.example.org. (   ; Master DNS server is dns1.example.org</p>
<p>   2014052300   ; serial                                   ; If problems, contact help@example.org</p>
<p>   28800        ; refresh (8 hours) </p>
<p>   7200         ; retry (2 hours) </p>
<p>   604800       ; expire (1 week) </p>
<p>   600 )        ; negative TTL (10 mins)</p>
<p>        IN NS     dns1.example.org.</p>
<p>        IN NS     dns2.example.org.</p>
<p>        IN MX     10 mail1.example.org.</p>
<p>        IN MX     20 mail2.example.org.</p>
<p>dns1    IN A      224.123.240.3</p>
<p>dns2    IN A      224.123.240.4</p>
<p>mail1   IN A      224.123.240.73</p>
<p>mail2   IN A      224.123.240.77</p>
<p>foo     IN A      224.123.240.12</p>
<p>bar     IN A      224.123.240.13</p>
<p>www     IN A      224.123.240.19</p>
<p>baz     IN CNAME  bar</p>
<p>subdomain   IN NS   ns1.subdomain.example.org.   ; Glue records</p>
<p>            IN NS   ns2.subdomain.example.org.</p>
<p>ns1.subdomain.example.org.   IN A   224.123.240.201</p>
<p>ns2.subdomain.example.org.   IN A   224.123.240.202</p>
<p><b>/var/named/master/example.org.revzone</b></p>
<p><b>     DNS reverse zone file for the example.org zone</b></p>
<p>$TTL 86400      ; TTL (1 day)</p>
<p>example.org IN SOA dns1.example.org. help.example.org. (</p>
<p>   2014052300   ; serial </p>
<p>   28800        ; refresh (8 hours) </p>
<p>   7200         ; retry (2 hours) </p>
<p>   604800       ; expire (1 week) </p>
<p>   600 )        ; negative TTL (10 mins)</p>
<p>12.240.123.224.in-addr.arpa   IN PTR   foo</p>
<p>13.240.123.224.in-addr.arpa   IN PTR   bar</p>
<p>19.240.123.224.in-addr.arpa   IN PTR   www</p>
<p><b>Resource Records</b></p>
<p>$TTL</p>
<p>How long to cache a positive response</p>
<p>$ORIGIN</p>
<p>Suffix appended to all names not ending with a dot.</p>
<p>Useful when defining multiple subdomains inside the same zone</p>
<p><b>SOA</b></p>
<p>Start Of Authority for the example.org zone</p>
<p>serial</p>
<p>Serial number.  Must be increased after each edit of the zone file</p>
<p>refresh</p>
<p>How frequently a slave server refreshes its copy of zone data from the master</p>
<p>retry</p>
<p>How frequently a slave server retries connecting to the master </p>
<p>expire</p>
<p>How long a slave server relies on its copy of zone data.  After this time period expires, </p>
<p>the slave server is not authoritative anymore for the zone unless it can contact a master</p>
<p>negative TTL</p>
<p>How long to cache a non-existent answer</p>
<p><b>A</b></p>
<p>Address: maps names to IP addresses.  Used for DNS lookups. </p>
<p><b>PTR</b></p>
<p>Pointer: maps IP addresses to names.  Used for reverse DNS lookups.  </p>
<p>Each A record must have a matching PTR record</p>
<p><b>CNAME</b></p>
<p>Canonical Name: specifies an alias for a host with an A record (even in a different zone).  </p>
<p>Discouraged as it causes multiple lookups; it is better to use multiple A records instead</p>
<p><b>NS</b></p>
<p>Name Service: specifies the authoritative name servers for the zone </p>
<p><b>MX</b></p>
<p>Mailserver: specifies address and priority of the servers able to handle mail for the zone</p>
<p>Glue Records are not really part of the zone; they delegate authority for other zones, usually subdomains</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>149/189</b></p>
<p><b>HTTP response codes</b></p>
<p><i>HTTP response codes</i></p>
<p><b>Most common HTTP response codes</b></p>
<p><b>1XX</b></p>
<p><b>Informational</b></p>
<p><b>100 Continue</b></p>
<p>The server received the request headers, so the client should continue by </p>
<p>sending the remainder of the request</p>
<p><b>101 Switching Protocols</b></p>
<p>The server agreed to switch protocol upon client's demand</p>
<p><b>2XX</b></p>
<p><b>Success</b></p>
<p><b>200 OK</b></p>
<p>The request was successful</p>
<p><b>201 Created</b></p>
<p>The request was successful, and resulted in a resource being created</p>
<p><b>204 No Content</b></p>
<p>The request was successful, and the server does not need to return any </p>
<p>content</p>
<p><b>206 Partial Content</b></p>
<p>The request was successful, and the server is returning only partial </p>
<p>content because the client sent a Range header field</p>
<p><b>3XX</b></p>
<p><b>Redirection</b></p>
<p><b>301 Moved Permanently</b></p>
<p>The requested resource was permanently moved to a new URI</p>
<p><b>302 Found</b></p>
<p>The requested resource was temporarily moved to a new URI</p>
<p><b>303 See Other</b></p>
<p>The requested resource can be found on another URI, and should be </p>
<p>retrieved from there via a GET</p>
<p><b>304 Not Modified</b></p>
<p>The client sent a conditional GET request, and the resource has not been </p>
<p>modified since last time it was requested</p>
<p><b>307 Temporary Redirect</b></p>
<p>The requested resource was temporarily moved to a new URI, but future </p>
<p>requests should use the original URI</p>
<p><b>4XX</b></p>
<p><b>Client Error</b></p>
<p><b>400 Bad Request</b></p>
<p>The server was unable to understand the request due to bad syntax</p>
<p><b>401 Unauthorized</b></p>
<p>The request requires user authentication</p>
<p><b>403 Forbidden</b></p>
<p>The client did not have the necessary permissions to access the </p>
<p>requested resource</p>
<p><b>404 Not Found</b></p>
<p>The requested resource was not found on the server</p>
<p><b>408 Request Timeout</b></p>
<p>The server timed out while waiting for the request</p>
<p><b>409 Conflict</b></p>
<p>The request could not be processed because of a conflict in the resource </p>
<p>state</p>
<p><b>410 Gone</b></p>
<p>The requested resource is no longer available on the server and will not </p>
<p>be available again</p>
<p><b>451 Unavailable for Legal </b></p>
<p><b>Reasons</b></p>
<p>The requested resource is not available due to government censorship</p>
<p><b>5XX</b></p>
<p><b>Server Error</b></p>
<p><b>500 Internal Server Error</b></p>
<p>The server encountered a generic error while trying to fulfill the request</p>
<p><b>501 Not Implemented</b></p>
<p>The server was unable to recognize the request method</p>
<p><b>502 Bad Gateway</b></p>
<p>The server is acting as a gateway or proxy, and received an invalid </p>
<p>response from the upstream server</p>
<p><b>503 Service Unavailable</b></p>
<p>The server is temporarily unavailable due to overload or maintenance</p>
<p><b>504 Gateway Timeout</b></p>
<p>The server is acting as a gateway or proxy, and a request to the </p>
<p>upstream server timed out</p>
<p><b>505 HTTP Version Not </b></p>
<p><b>Supported</b></p>
<p>The server does not support the HTTP protocol version used in the </p>
<p>request</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>150/189</b></p>
<p><b>Apache</b></p>
<p><i>Apache</i></p>
<p>Apache is an open source and widespread HTTP server, originally based on the NCSA HTTPd server.</p>
<p>apachectl   </p>
<p>(Red Hat)</p>
<p>httpd       </p>
<p>(Red Hat)</p>
<p>apache2ctl  </p>
<p>(Debian)</p>
<p>   </p>
<p>Manage the Apache webserver</p>
<p>apachectl start</p>
<p>Start the Apache webserver daemon</p>
<p>apachectl status</p>
<p>Display a brief status report</p>
<p>apachectl fullstatus</p>
<p>Display a detailed status report</p>
<p>apachectl graceful</p>
<p>Gracefully restart Apache; currently open connections are not aborted</p>
<p>apachectl graceful-stop</p>
<p>Gracefully stop Apache; currently open connections are not aborted</p>
<p>apachectl configtest</p>
<p>apachectl -t</p>
<p>Test the configuration file, reporting any syntax error</p>
<p>apachectl -M</p>
<p>List all loaded and shared modules </p>
<p>/var/www/html</p>
<p>Default document root directory</p>
<p>$HOME/public_html</p>
<p>Default document root directory for users' websites</p>
<p>Web content must be readable by the user/group the Apache process runs as.  For security reasons, it should be owned and </p>
<p>writable by the superuser or the webmaster user/group (usually </p>
<p>www-data</p>
<p>), not the Apache user/group.</p>
<p>/etc/httpd/conf/httpd.conf</p>
<p>/etc/httpd/conf.d/*.conf    </p>
<p>(Red Hat)</p>
<p>Apache configuration files</p>
<p>/etc/apache2/httpd.conf </p>
<p>(Debian and SUSE)</p>
<p>The Apache webserver contains a number of MPMs (Multi-Processing Modules) which can operate following two methods:</p>
<p>prefork MPM</p>
<p>A number of child processes is spawned in advance, with each child serving one connection.</p>
<p>Highly reliable due to Linux memory protection that isolates each child process.</p>
<p>worker MPM</p>
<p>Multiple child processes spawn multiple threads, with each thread serving one connection.</p>
<p>More scalable but prone to deadlocks if third-party non-threadsafe modules are loaded.</p>
<p><b>HTTPS</b></p>
<p>HTTPS (i.e. HTTP over SSL/TLS) allows securing communications between the webserver and the client by encrypting </p>
<p>all communications end-to-end between the two.  A webserver using HTTPS hands over its public key to the client </p>
<p>when the client connects to the server via port 443.  The server's public key is signed by a CA (Certification </p>
<p>Authority), whose validity is ensured by the root certificates stored into the client's browser.</p>
<p>The </p>
<p>openssl</p>
<p> command and its user-friendly </p>
<p>CA.pl</p>
<p> script are the tools of the OpenSSL crypto library that can be used </p>
<p>to accomplish all public key crypto operations e.g. generate key pairs, Certificate Signing Requests, and self-signed </p>
<p>certificates.  Another user-friendly tool is </p>
<p>genkey</p>
<p>.</p>
<p>Virtual hosting with HTTPS requires assigning a unique IP address for each virtual host; this because the SSL </p>
<p>handshake (during which the server sends its certificate to the client's browser) takes place before the client sends </p>
<p>the </p>
<p>Host:</p>
<p> header (which tells to which virtual host the client wants to talk).</p>
<p>A workaround for this is SNI (Server Name Indication) which makes the browser send the hostname in the first </p>
<p>message of the SSL handshake.  Another workaround is to have all multiple name-based virtual hosts use the same </p>
<p>SSL certificate with a wildcard domain e.g. *.example.org.</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>151/189</b></p>
<p><b>Apache server configuration</b></p>
<p><i>Apache server configuration</i></p>
<p><b>Apache configuration file</b></p>
<p><b>Server configuration directives</b></p>
<p>ServerName www.mysite.org:80</p>
<p>Name and port (if omitted, uses default HTTP port 80) of server</p>
<p>ServerRoot /etc/httpd</p>
<p>Root directory for configuration and log files</p>
<p>ServerAdmin webmaster@mysite.org</p>
<p>Contact address that the server includes in any HTTP error </p>
<p>messages to the client.  Can be an email address or a URL</p>
<p>StartServers 5</p>
<p>Number of servers to start initially</p>
<p>MinSpareServers 5</p>
<p>MaxSpareServers 10</p>
<p>Minimum and maximum number of idle child server processes</p>
<p>MaxClients 256          </p>
<p>(before v2.3.13)</p>
<p>MaxRequestWorkers 256   </p>
<p>(v2.3.13 and later)</p>
<p>Max number of simultaneous requests that will be served; clients</p>
<p>above this limit will get a HTTP error 503 - Service Unavailable.</p>
<p>Prefork MPM: max number of child processes launched to serve </p>
<p>requests.</p>
<p>Worker MPM: max total number of threads available to serve </p>
<p>requests</p>
<p>ServerLimit 256</p>
<p>Prefork MPM: max configured value for </p>
<p>MaxRequestWorkers</p>
<p>.</p>
<p>Worker MPM: in conjunction with </p>
<p>ThreadLimit</p>
<p>, max configured </p>
<p>value for </p>
<p>MaxRequestWorkers</p>
<p>ThreadsPerChild 25</p>
<p>Worker MPM: number of threads created by each child process </p>
<p>ThreadLimit 64</p>
<p>Worker MPM: max configured value for </p>
<p>ThreadsPerChild</p>
<p>MaxRequestsPerChild 16      </p>
<p>(v2.2)</p>
<p>MaxConnectionsPerChild 16   </p>
<p>(v2.4)</p>
<p>Max number of connections allowed per child</p>
<p>LoadModule mime_module modules/mod_mime.so</p>
<p>Load the module </p>
<p>mime_module</p>
<p> by linking in the object file or </p>
<p>library </p>
<p>modules/mod_mime.so</p>
<p>Listen 10.17.1.1:80</p>
<p>Listen 10.17.1.5:8080</p>
<p>Make the server accept connections on the specified IP </p>
<p>addresses (optional) and ports</p>
<p>User nobody</p>
<p>Group nobody</p>
<p>User and group the Apache process runs as.  For security </p>
<p>reasons, this should not be root</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>152/189</b></p>
<p><b>Apache main configuration</b></p>
<p><i>Apache main configuration</i></p>
<p><b>Apache configuration file</b></p>
<p><b>Main configuration directives</b></p>
<p>DocumentRoot /var/www/html</p>
<p>Directory in filesystem that maps to the root of the website</p>
<p>Alias /image /mydir/pub/image</p>
<p>Map the URL </p>
<p>http://www.mysite.org/image/</p>
<p> to the directory </p>
<p>/mydir/pub/image</p>
<p> in the filesystem.  This allows Apache to </p>
<p>serve content placed outside of the document root</p>
<p>TypesConfig conf/mime.types</p>
<p>Media types file.  The path is relative to </p>
<p>ServerRoot</p>
<p>AddType image/jpeg jpeg jpg jpe</p>
<p>Map the specified filename extensions onto the specified content </p>
<p>type.  These entries add to or override the entries from the </p>
<p>media types file </p>
<p>conf/mime.types</p>
<p> </p>
<p>Redirect permanent /foo /bar</p>
<p>Redirect to a URL on the same host.  Status can be:</p>
<p>permanent   </p>
<p>return an HTTP status 301 - Moved Permanently</p>
<p>temp        </p>
<p>return an HTTP status 302 - Found (default)</p>
<p>seeother    </p>
<p>return an HTTP status 303 - See Other</p>
<p>gone        </p>
<p>return an HTTP status 410 - Gone</p>
<p>Redirect /foo http://www.example.com/foo</p>
<p>Redirect to a URL on a different host</p>
<p>AccessFileName .htaccess</p>
<p>Name of the distributed configuration file, which contains </p>
<p>directives that apply to the document directory it is in and to all </p>
<p>its subtrees</p>
<p>&lt;Directory &quot;/var/www/html/foobar&quot;&gt;</p>
<p>   AllowOverride AuthConfig Limit</p>
<p>&lt;/Directory&gt;</p>
<p>Specify which global directives an </p>
<p>.htaccess</p>
<p> file can override:</p>
<p>AuthConfig   </p>
<p>Authorization directives for directory protection</p>
<p>FileInfo     </p>
<p>Document type and metadata</p>
<p>Indexes      </p>
<p>Directory indexing</p>
<p>Limit        </p>
<p>Host access control</p>
<p>Options      </p>
<p>Specific directory features</p>
<p>All          </p>
<p>All directives</p>
<p>None         </p>
<p>No directive</p>
<p><b>Limited scope directives</b></p>
<p>&lt;Directory &quot;/var/www/html/foobar&quot;&gt;</p>
<p>   <i>[list of directives]</i></p>
<p>&lt;/Directory&gt;</p>
<p>Limit the scope of the specified directives to the directory </p>
<p>/var/www/html/foobar</p>
<p> and its subdirectories</p>
<p>&lt;Location /foobar&gt;</p>
<p>   <i>[list of directives]</i></p>
<p>&lt;/Location&gt;</p>
<p>Limit the scope of the specified directive to the URL </p>
<p>http://www.mysite.org/foobar/</p>
<p> and its subdirectories</p>
<p><b>Logging directives</b></p>
<p>LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b&quot;</p>
<p>Specify the format of a log</p>
<p>LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b&quot; common</p>
<p>Specify a nickname for a log format.</p>
<p>In this case, specifies &quot;common&quot; for the CLF (Common Log </p>
<p>Format) which is defined as such:</p>
<p>%h   </p>
<p>IP address of the client host</p>
<p>%l   </p>
<p>Identity of client as determined by </p>
<p>identd</p>
<p>%u   </p>
<p>User ID of client making the request</p>
<p>%t   </p>
<p>Timestamp the server completed the request</p>
<p>%r   </p>
<p>Request as done by the user</p>
<p>%s   </p>
<p>Status code sent by the server to the client</p>
<p>%b   </p>
<p>Size of the object returned, in bytes</p>
<p>CustomLog /var/log/httpd/access_log common</p>
<p>Set up a log filename, with the format or (as in this case) </p>
<p>the nickname specified </p>
<p>TransferLog /var/log/httpd/access_log</p>
<p>Set up a log filename, with format determined by the most </p>
<p>recent </p>
<p>LogFormat</p>
<p> directive which did not define a nickname</p>
<p>TransferLog &quot;|rotatelogs access_log 86400&quot;</p>
<p>Set log rotation every 24 hours</p>
<p>HostnameLookups Off</p>
<p>Disable DNS hostname lookup to save network traffic.</p>
<p>Hostnames can be resolved later by processing the log file:</p>
<p>logresolve &lt;access_log &gt;accessdns_log   </p>
<p>    </p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>153/189</b></p>
<p><b>Apache virtual hosts</b></p>
<p><i>Apache virtual hosts</i></p>
<p><b>Apache configuration file</b></p>
<p><b>Virtual hosts directives</b></p>
<p>NameVirtualHost *   </p>
<p>(v2.2)</p>
<p>Specify which IP address will serve virtual hosting.  The </p>
<p>argument can be an IP address, an <i>address:port</i> pair, or </p>
<p>*</p>
<p> for all </p>
<p>IP addresses of the server.  The same argument need to be </p>
<p>inserted in the relevant </p>
<p>&lt;VirtualHost&gt;</p>
<p> directive</p>
<p>&lt;VirtualHost *:80&gt;</p>
<p>   ServerName www.mysite.org</p>
<p>   ServerAlias mysite.org *.mysite.org</p>
<p>   DocumentRoot /var/www/vhosts/mysite</p>
<p>&lt;/VirtualHost&gt;</p>
<p>The first listed virtual host is also the default virtual host.</p>
<p>It inherits those main settings that does not override.</p>
<p>This virtual host answers to </p>
<p>http://www.mysite.org</p>
<p>, and also </p>
<p>redirects there all HTTP requests on the domain mysite.org</p>
<p>&lt;VirtualHost *:80&gt;</p>
<p>   ServerAdmin webmaster@www.mysite2.org</p>
<p>   ServerName www.mysite2.org</p>
<p>   DocumentRoot /var/www/vhosts/mysite2</p>
<p>   ErrorLog /var/www/logs/mysite2</p>
<p>&lt;/VirtualHost&gt;</p>
<p>Name-based virtual host </p>
<p>http://www.mysite2.org</p>
<p>.</p>
<p>Multiple name-based virtual hosts can share the same IP </p>
<p>address; DNS must be configured accordingly to map each name</p>
<p>to the correct IP address.  Cannot be used with HTTPS</p>
<p>&lt;VirtualHost *:8080&gt;</p>
<p>   ServerName www.mysite3.org</p>
<p>   DocumentRoot /var/www/vhosts/mysite3</p>
<p>&lt;/VirtualHost&gt;</p>
<p>Port-based virtual host answering to connections on port 8080.</p>
<p>A </p>
<p>Listen 8080</p>
<p> directive must also be present</p>
<p>&lt;VirtualHost 10.17.1.5:80&gt;</p>
<p>   ServerName www.mysite4.org</p>
<p>   DocumentRoot /var/www/vhosts/mysite4</p>
<p>&lt;/VirtualHost&gt;</p>
<p>IP-based virtual host answering to </p>
<p>http://10.17.1.5</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>154/189</b></p>
<p><b>Apache authorization</b></p>
<p><i>Apache authorization</i></p>
<p><b>Apache configuration file</b></p>
<p><b>Authorization directives</b></p>
<p>AuthName &quot;Protected zone&quot;</p>
<p>Name of the realm.  The client will be shown the realm name </p>
<p>and prompted to enter a user and password</p>
<p>AuthType Basic</p>
<p>Type of user authentication: </p>
<p>Basic</p>
<p>, </p>
<p>Digest</p>
<p>, </p>
<p>Form</p>
<p>, or </p>
<p>None</p>
<p>AuthUserFile &quot;/var/www/.htpasswd&quot;</p>
<p>User database file.  Each line has the format </p>
<p><i>user</i>:<i>encryptedpassword</i></p>
<p><i> </i></p>
<p>To add a user to the database file, use the command:</p>
<p>htpasswd /var/www/.htpasswd <i>user</i></p>
<p>(will prompt for password)</p>
<p>AuthGroupFile &quot;/var/www/.htgroup&quot;</p>
<p>Group database file.  Each line specifies a group followed by the </p>
<p>usernames of all its members:</p>
<p><i>group</i>: <i>user1 user2 user3</i></p>
<p>Require valid-user</p>
<p>Control who can access the protected resource.</p>
<p>valid-user    </p>
<p>any user in the user database file</p>
<p>user <i>user</i>     </p>
<p>only the specified user</p>
<p>group <i>group</i>   </p>
<p>only the members of the specified group</p>
<p>Satisfy Any</p>
<p>Set the access policy concerning user and host control.</p>
<p>All   </p>
<p>both </p>
<p>Require</p>
<p> and </p>
<p>Allow</p>
<p> criteria must be satisfied</p>
<p>Any   </p>
<p>any of </p>
<p>Require</p>
<p> or </p>
<p>Allow</p>
<p> criteria must be satisfied</p>
<p>Allow from 10.13.13.0/24</p>
<p>Deny from 10.13.14.0/24</p>
<p>(v2.2)</p>
<p>Control which host can or cannot access the protected resource</p>
<p>Order Allow,Deny   </p>
<p>(v2.2)</p>
<p>Control the evaluation order of </p>
<p>Allow</p>
<p> and </p>
<p>Deny</p>
<p> directives.</p>
<p>Allow,Deny</p>
<p>First, all </p>
<p>Allow</p>
<p> directives are evaluated; at </p>
<p>least one must match, or the request is </p>
<p>rejected.  Next, all </p>
<p>Deny</p>
<p> directives are </p>
<p>evaluated; if any matches, the request is </p>
<p>rejected.  Last, any requests which do not </p>
<p>match an </p>
<p>Allow</p>
<p> or a </p>
<p>Deny</p>
<p> directive are </p>
<p>denied </p>
<p>Deny,Allow</p>
<p>First, all </p>
<p>Deny</p>
<p> directives are evaluated; if </p>
<p>any match, the request is denied unless it </p>
<p>also matches an </p>
<p>Allow</p>
<p> directive.  Any </p>
<p>requests which do not match any </p>
<p>Allow</p>
<p> or </p>
<p>Deny</p>
<p> directives are permitted</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>155/189</b></p>
<p><b>Apache SSL/TLS</b></p>
<p><i>Apache SSL/TLS</i></p>
<p><b>Apache configuration file</b></p>
<p><b>SSL/TLS directives (</b></p>
<p><b>mod_ssl</b></p>
<p><b> module)</b></p>
<p>SSLCertificateFile \</p>
<p>/etc/httpd/conf/ssl.crt/server.crt </p>
<p>SSL server certificate</p>
<p>SSLCertificateKeyFile \</p>
<p>/etc/httpd/conf/ssl.key/server.key</p>
<p>SSL server private key (for security reasons, this file must</p>
<p>be mode 600 and owned by root)</p>
<p>SSLCACertificatePath \</p>
<p>/usr/local/apache2/conf/ssl.crt/</p>
<p>Directory containing the certificates of CAs.  Files in this </p>
<p>directory are PEM-encoded and accessed via symlinks to </p>
<p>hash filenames</p>
<p>SSLCACertificateFile \</p>
<p>/usr/local/apache2/conf/ssl.crt/ca-bundle.crt</p>
<p>Certificates of CAs.  Certificates are PEM-encoded and </p>
<p>concatenated in a single bundle file in order of preference</p>
<p>SSLCertificateChainFile \</p>
<p>/usr/local/apache2/conf/ssl.crt/ca.crt </p>
<p>Certificate chain of the CAs.  Certificates are PEM-encoded</p>
<p>and concatenated from the issuing CA certificate of the </p>
<p>server certificate to the root CA certificate.  Optional</p>
<p>SSLEngine on</p>
<p>Enable the SSL/TLS Protocol Engine</p>
<p>SSLProtocol +SSLv3 +TLSv1.2</p>
<p>SSL protocol flavors that the client can use to connect to </p>
<p>server.  Possible values are:</p>
<p>SSLv2     </p>
<p>(deprecated)</p>
<p>SSLv3</p>
<p>TLSv1</p>
<p>TLSv1.1</p>
<p>TLSv1.2</p>
<p>All       </p>
<p>(all the above protocols)</p>
<p>SSLCipherSuite \</p>
<p>ALL:!aDH:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP</p>
<p>Cipher suite available for the SSL handshake (key </p>
<p>exchange algorithms, authentication algorithms, </p>
<p>cipher/encryption algorithms, MAC digest algorithms)</p>
<p>ServerTokens Full</p>
<p>Server response header field to send back to client.</p>
<p>Possible values are:</p>
<p>Prod      </p>
<p>sends</p>
<p> Server: Apache</p>
<p>Major     </p>
<p>sends</p>
<p> Server: Apache/2</p>
<p>Minor     </p>
<p>sends</p>
<p> Server: Apache/2.4</p>
<p>Minimal   </p>
<p>sends</p>
<p> Server: Apache/2.4.2</p>
<p>OS        </p>
<p>sends</p>
<p> Server: Apache/2.4.2 (Unix)</p>
<p>Full      </p>
<p>sends</p>
<p> Server: Apache/2.4.2 (Unix) \</p>
<p>                PHP/4.2.2 MyMod/1.2 </p>
<p>(default)</p>
<p>ServerSignature Off</p>
<p>Trailing footer line on server-generated documents.</p>
<p>Possible values are:</p>
<p>Off     </p>
<p>no footer line (default)</p>
<p>On      </p>
<p>server version number and </p>
<p>ServerName</p>
<p>EMail   </p>
<p>as above, plus a mailto link to </p>
<p>ServerAdmin</p>
<p>SSLVerifyClient none</p>
<p>Certificate verification level for client authentication.</p>
<p>Possible values are:</p>
<p>none</p>
<p>no client certificate is required</p>
<p>require</p>
<p>the client needs to present a valid </p>
<p>certificate</p>
<p>optional</p>
<p>the client may present a valid </p>
<p>certificate (this option is unused </p>
<p>as it doesn't work on all browsers)</p>
<p>optional_no_ca</p>
<p>the client may present a valid </p>
<p>certificate but it doesn't need to </p>
<p>be successfully verifiable (this </p>
<p>option is practically used only for </p>
<p>SSL testing)</p>
<p>TraceEnable on</p>
<p>Enable TRACE requests</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>156/189</b></p>
<p><b>Apache proxy</b></p>
<p><i>Apache proxy</i></p>
<p>A <b>forward proxy</b> provides proxy services, typically web content caching and/or filtering, for clients located in a LAN.</p>
<p>All outgoing requests from the clients, and the responses from the Internet, pass through the proxy.</p>
<p>The clients must be manually configured (e.g. in the browser's connection settings) to use the proxy.</p>
<p><b>Apache configuration file</b></p>
<p><b>Forward proxy</b></p>
<p>ProxyRequests On</p>
<p>Enable forward proxy requests</p>
<p>ProxyVia On</p>
<p>Add a </p>
<p>Via:</p>
<p> HTTP header line to every request and reply</p>
<p>&lt;Proxy &quot;*&quot;&gt;</p>
<p>   Require ip 10.1.1</p>
<p>&lt;/Proxy&gt;</p>
<p>Serve only proxy requests coming from 10.1.1.0/24</p>
<p>A <b>reverse proxy</b> aka <b>gateway</b> allows to expose a single entry point for one or more webservers in a LAN.  This </p>
<p>improves security and simplifies management, as features (e.g. load balancing, firewalling, automatic redirection from</p>
<p>HTTP to HTTPS, redirection on default ports) can be configured centrally.</p>
<p>It is necessary to create a DNS A record that maps site.example.com to the public IP address of the proxy.</p>
<p><b>Apache configuration file</b></p>
<p><b>Reverse proxy</b></p>
<p>&lt;VirtualHost *:80&gt;</p>
<p>Virtual host for HTTP</p>
<p>   ServerName site.example.com</p>
<p>Define website name</p>
<p>   RewriteEngine On</p>
<p>   RewriteCond %{HTTPS} off</p>
<p>   RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}</p>
<p>Alternatively:</p>
<p>   Redirect &quot;/&quot; &quot;https://10.2.2.73:443/&quot;</p>
<p>Redirect all HTTP requests to HTTPS</p>
<p>&lt;/VirtualHost&gt;</p>
<p>&lt;VirtualHost *:443&gt;</p>
<p>Virtual host for HTTPS</p>
<p>   ServerName site.example.com</p>
<p>Define website name</p>
<p>   ServerSignature On</p>
<p>Set a footer line under server-generated pages</p>
<p>   &lt;Proxy *&gt;</p>
<p>      Require all granted</p>
<p>   &lt;/Proxy&gt;</p>
<p>Serve all proxy requests</p>
<p>   SSLEngine on</p>
<p>   SSLProtocol ALL -SSLv2 -SSLv3</p>
<p>   SSLHonorCipherOrder on</p>
<p>   SSLCipherSuite DEFAULT</p>
<p>   SSLCertificateFile    /etc/httpd/ssl/site.crt</p>
<p>   SSLCertificateKeyFile /etc/httpd/ssl/site.key</p>
<p>   SSLCACertificateFile  /etc/httpd/ssl/site.ca.crt</p>
<p>Enable and configure SSL</p>
<p>   ProxyPass        &quot;/&quot; &quot;http://10.2.2.73:8080/&quot;</p>
<p>   ProxyPassReverse &quot;/&quot; &quot;http://10.2.2.73:8080/&quot;</p>
<p>Enable reverse proxying for server 10.2.2.73</p>
<p>&lt;/VirtualHost&gt;</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<p>webserver</p>
<p>10.2.2.73:8080</p>
<p>Apache</p>
<p>reverse proxy</p>
<p>Internet</p>
<p>http://site.example.com</p>
<p>https://site.example.com</p>
<p>webserver</p>
<p>10.2.2.73:8080</p>
<p>Internet</p>
<p>webserver</p>
<p>10.2.2.73:8080</p>
<p>Apache</p>
<p>forward proxy</p>
<p>LAN</p>
<p>10.1.1.0/24</p>
<h1 style="page-break-before:always; "></h1>
<p><b>157/189</b></p>
<p><b>Tomcat</b></p>
<p><i>Tomcat</i></p>
<p>Apache Tomcat is an open source Java Servlet Container implementing several Java EE specifications, originally part of the </p>
<p>Jakarta Project.  It is composed of:</p>
<p>- Catalina, the core component and servlet container implementation;</p>
<p>- Coyote, an HTTP connector component, providing a pure Java webserver environment to run Java code;</p>
<p>- Jasper, a JSP (Java Server Pages) engine, which parses JSP files and compiles them into Java servlets. </p>
<p>Tomcat has been removed from RHEL 8; instead, it is suggested to use the JBoss Enterprise Application Platform, which </p>
<p>includes Apache and Tomcat.</p>
<p>$JAVA_HOME</p>
<p>Root of the Java installation e.g. </p>
<p>/usr/lib/jvm/java-1.8.0-openjdk.x86_64/</p>
<p> </p>
<p>$CATALINA_HOME</p>
<p>Root of the Tomcat installation e.g. </p>
<p>/usr/share/tomcat7/</p>
<p>$CATALINA_BASE</p>
<p>Tomcat may also be configured for multiple instances by defining the variable </p>
<p>$CATALINA_BASE</p>
<p> for</p>
<p>each instance.  If a single instance of Tomcat is running, </p>
<p>$CATALINA_BASE</p>
<p> is the same as </p>
<p>$CATALINA_HOME</p>
<p><b>Tomcat global files</b></p>
<p>$CATALINA_BASE/conf/server.xml</p>
<p>Tomcat main configuration file</p>
<p>$CATALINA_BASE/conf/web.xml</p>
<p>Options and values applied to all web applications running on a </p>
<p>specific Tomcat instance.  These can be overridden by the </p>
<p>application-specific servlet configuration defined in </p>
<p>$CATALINA_BASE/webapps/<i>appname</i>/WEB-INF/web.xml</p>
<p> </p>
<p>$CATALINA_BASE/conf/context.xml</p>
<p>Context applied to all web applications running on a specific </p>
<p>Tomcat instance</p>
<p>$CATALINA_BASE/conf/tomcat-users.xml</p>
<p>Users, passwords, and roles applied to a specific Tomcat </p>
<p>instance </p>
<p>$CATALINA_BASE/conf/catalina.policy</p>
<p>Tomcat's core security policy for the Catalina class</p>
<p>$CATALINA_BASE/conf/catalina.properties</p>
<p>Java properties file for the Catalina class </p>
<p>$CATALINA_BASE/conf/logging.properties</p>
<p>Java properties file for Catalina's built-in logging functions</p>
<p>$CATALINA_BASE/lib/</p>
<p>JAR files accessible by both web applications and internal </p>
<p>Tomcat code</p>
<p>$JAVA_HOME/jre/lib/security/<i>keystore</i>.jks</p>
<p>Java keystore</p>
<p><b>Tomcat application-specific files</b></p>
<p>$CATALINA_BASE/webapps/<i>appname</i>/WEB-INF/</p>
<p>HTML, JSP, and other files to serve to the client browser</p>
<p>$CATALINA_BASE/webapps/<i>appname</i>/WEB-INF/web.xml</p>
<p>Description of servlets and other components of the application,</p>
<p>and initialization parameters</p>
<p>$CATALINA_BASE/webapps/<i>appname</i>/WEB-INF/classes/</p>
<p>Java class files that aren't in JAR format.  The directory </p>
<p>hierarchy from here reflects the class hierarchy</p>
<p>$CATALINA_BASE/webapps/<i>appname</i>/WEB-INF/lib/</p>
<p>Other JAR files (e.g. third-party libraries, JDBC drivers) required</p>
<p>by the application</p>
<p><b>Tomcat log files</b></p>
<p>$CATALINA_BASE/logs/catalina.out</p>
<p>Tomcat log</p>
<p>$CATALINA_BASE/logs/localhost.log</p>
<p>Host log </p>
<p>$CATALINA_BASE/logs/localhost_access.log</p>
<p>Host HTTP access log</p>
<p>$CATALINA_BASE/logs/manager.log</p>
<p>Application log </p>
<p>$CATALINA_BASE/logs/host-manager.log</p>
<p>Application log </p>
<p>java -X</p>
<p>Display all available </p>
<p>-X</p>
<p> options (nonstandard HotSpot JVM options)</p>
<p>java -XshowSettings:properties -version</p>
<p>Print Java runtime settings</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>158/189</b></p>
<p><b>Samba server</b></p>
<p><i>Samba server</i></p>
<p>Samba is a free-software, cross-platform implementation of SMB/CIFS.  SMB (Server Message Block) is Microsoft's </p>
<p>proprietary protocol for file and printer sharing, while CIFS (Common Internet File System) is the public version of SMB.</p>
<p><b>Commonly used ports in Samba</b></p>
<p>TCP/UDP 137</p>
<p>netbios-ns</p>
<p>NetBIOS name service requests and responses</p>
<p>TCP/UDP 138</p>
<p>netbios-dgm</p>
<p>NetBIOS datagram services e.g. server announcements</p>
<p>TCP/UDP 139</p>
<p>netbios-ssn</p>
<p>NetBIOS session service e.g. file and printer sharing</p>
<p>TCP 445</p>
<p>microsoft-ds</p>
<p>Active Directory; registration and translation of NetBIOS names, network browsing</p>
<p>TCP 389</p>
<p>LDAP</p>
<p>TCP 901</p>
<p>SWAT service</p>
<p>The full list of used ports can be found via the command </p>
<p>grep -i netbios /etc/services</p>
<p>.</p>
<p>smbd</p>
<p>Server Message Block daemon.  Provides SMB file and printer sharing, browser services, user authentication, </p>
<p>and resource lock.  An extra copy of this daemon runs for each client connected to the server</p>
<p>nmbd</p>
<p>NetBIOS Name Service daemon.  Handles NetBIOS name lookups, WINS requests, list browsing and elections. </p>
<p>An extra copy of this daemon runs if Samba functions as a WINS server; another extra copy of this daemon </p>
<p>runs if DNS is used to translate NetBIOS names.</p>
<p>WINS (Windows Internet Name Service) is a name service used to translate NetBIOS names to IP addresses. </p>
<p>/etc/smb/</p>
<p>/etc/samba/  </p>
<p>(RHEL 7)</p>
<p>Samba directory</p>
<p>/etc/samba/lmhosts</p>
<p>Samba NetBIOS hosts file</p>
<p>/etc/samba/netlogon</p>
<p>User logon directory</p>
<p>smbd -V</p>
<p>smbclient -V</p>
<p>Show the version of the Samba server</p>
<p>testparm</p>
<p>Check the Samba configuration file and report any error</p>
<p>smbpasswd <i>user</i></p>
<p>Change the Samba password of <i>user</i> </p>
<p>smbpasswd -a <i>user</i></p>
<p>Create a new Samba <i>user</i> and set his password</p>
<p>nmblookup <i>smbserver</i></p>
<p>Look up the NetBIOS name of a server and map it to an IP </p>
<p>address</p>
<p>nmblookup -U <i>winsserver</i> -R <i>WORKGROUP</i>#1B</p>
<p>Query recursively a WINS server for the Domain Master </p>
<p>Browser for the specified workgroup </p>
<p>nmblookup -U <i>winsserver</i> -R <i>WORKGROUP</i>#1D</p>
<p>Query recursively a WINS server for the Domain Controller </p>
<p>for the specified workgroup</p>
<p>net</p>
<p>Tool for administration of Samba and remote CIFS servers</p>
<p>net rpc shutdown -r -S <i>smbserver</i> -U root%<i>password</i></p>
<p>Reboot a CIFS server</p>
<p>net rpc service list -S <i>smbserver</i></p>
<p>List available services on a CIFS server</p>
<p>net status sessions</p>
<p>Show active Samba sessions</p>
<p>net status shares</p>
<p>Show Samba shares</p>
<p>net rpc info</p>
<p>Show information about the domain</p>
<p>net groupmap list</p>
<p>Show group mappings between Samba and Windows</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>159/189</b></p>
<p><b>Samba client</b></p>
<p><i>Samba client</i></p>
<p>mount.cifs</p>
<p>smbmount</p>
<p>Mount a Samba share on a Linux filesystem, using the CIFS </p>
<p>filesystem interface</p>
<p>mount //<i>smbserver</i>/share1 /mnt/share1 -t cifs \</p>
<p>-o username=<i>user</i></p>
<p>Mount a Samba share as <i>user</i></p>
<p>smbstatus</p>
<p>Display current information about shares, clients connections,</p>
<p>and locked files</p>
<p>smbclient //<i>smbserver</i>/share1</p>
<p>Access a Samba share on a server (with an FTP-like interface)</p>
<p>smbclient -L //<i>smbserver</i> -W<i> WORKGROUP </i>-U<i> user</i></p>
<p>List the Samba resources available on a server, belonging to </p>
<p>the specified workgroup and accessible to the specified user</p>
<p>cat msg.txt | smbclient -M <i>client</i> -U <i>user</i></p>
<p>Show a message popup on the client machine, using the </p>
<p>WinPopup protocol</p>
<p><b>Samba mount options</b></p>
<p>username=<i>user</i></p>
<p>Mount the share as <i>user</i></p>
<p>password=<i>password</i></p>
<p>Specify the mount user's <i>password</i></p>
<p>credentials=<i>credfile</i></p>
<p>Mount the share as the user defined in the credentials file <i>credfile</i> </p>
<p>which must have this format:</p>
<p>username=<i>user</i></p>
<p>password=<i>password</i></p>
<p>multiuser</p>
<p>Mount the share in multiuser mode</p>
<p>sec=ntlmssp</p>
<p>Set the security level to NTLMSSP.</p>
<p>This is required in RHEL 7 to enable multiuser mode</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>160/189</b></p>
<p><b>Samba global configuration</b></p>
<p><i>Samba global configuration</i></p>
<p><b>/etc/samba/smb.conf</b></p>
<p><b>     Samba configuration</b></p>
<p>[global]</p>
<p>Global server settings: defines parameters applicable for the whole </p>
<p>Samba server and sets the defaults that will be used for the </p>
<p>parameters not mentioned in other sections</p>
<p>   workgroup = MYWORKGROUP</p>
<p>Make Samba join the specified workgroup</p>
<p>   server string = Linux Samba Server %L</p>
<p>Describe server to the clients</p>
<p>   hosts allow = 10.9.9.0/255.255.255.0</p>
<p>Allow only the specified machines to connect to the server</p>
<p>   security = user</p>
<p>Set up user-level authentication</p>
<p>   encrypt passwords = yes</p>
<p>Use encrypted passwords</p>
<p>   smb passwd file = /etc/samba/smbpasswd</p>
<p>Refer to the specified password file for user authentication.</p>
<p>A new user's password will need to be set both in Linux and Samba by</p>
<p>using these commands from shell prompt:</p>
<p>passwd <i>newuser</i></p>
<p>smbpasswd <i>newuser</i></p>
<p>   unix password sync = yes</p>
<p>When the password of a client user (e.g. under Windows) is changed, </p>
<p>change the Linux and Samba passwords accordingly</p>
<p>   username map = /etc/samba/smbusers</p>
<p>Map each Samba server user name to client user name(s).</p>
<p>The file </p>
<p>/etc/samba/smbusers</p>
<p> has the following format:</p>
<p>root = Administrator Admin</p>
<p>jdoe = &quot;John Doe&quot;</p>
<p>kgreen = &quot;Kim Green&quot;</p>
<p>   netbios name = Mysambabox</p>
<p>   netbios aliases = Mysambabox1</p>
<p>Set NetBIOS name and alias</p>
<p>   wins support = yes</p>
<p>Make Samba play the role of a WINS server. </p>
<p>Note: There should be only one WINS server on a network</p>
<p>   logon server = yes</p>
<p>Enable logon support.</p>
<p>Logon script parameters will be defined in a </p>
<p>[netlogon]</p>
<p> section</p>
<p>   log file = /var/log/samba/log.%m</p>
<p>Use a separate logfile for each machine that connects</p>
<p>   max log size = 1000</p>
<p>Maximum size of each logfile, in Kb</p>
<p>   syslog only = no</p>
<p>Do not use only syslog to log</p>
<p>   syslog = 0</p>
<p>Log everything to the logfiles </p>
<p>/var/log/smb/log.smbd</p>
<p> and </p>
<p>/var/log/smb/log.nmbd</p>
<p>, and log a minimum amount of information </p>
<p>to syslog.  This parameter can be set to a higher value to have syslog </p>
<p>log more information</p>
<p>   panic action = \</p>
<p>   /usr/share/samba/panic-action %d</p>
<p>Mail a backtrace to the sysadmin in case Samba crashes</p>
<p>[netlogon]</p>
<p>   comment = Netlogon for Windows clients</p>
<p>Section defining a logon script</p>
<p>   path = /home/netlogon</p>
<p>   logon script = %U.bat</p>
<p>Specifies a per-user script e.g. </p>
<p>/home/netlogon/jdoe.bat</p>
<p> will be </p>
<p>called when user jdoe logs in.</p>
<p>It is also possible to specify a per-clientname script </p>
<p>%m.bat</p>
<p>, which will</p>
<p>be called when a specific machine logs in.</p>
<p>   browseable = no</p>
<p>   writeable = no</p>
<p>   guest ok = no</p>
<p>Guest access to the service (i.e. access without entering a password) </p>
<p>is disabled</p>
<p>[Canon LaserJet 3]</p>
<p>   printer name = lp</p>
<p>   comment = Canon LaserJet 3 main printer</p>
<p>   path = /var/spool/lpd/samba</p>
<p>   printable = yes</p>
<p>   writeable = no</p>
<p>Section defining a printer accessible via the network</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>161/189</b></p>
<p><b>Samba share configuration</b></p>
<p><i>Samba share configuration</i></p>
<p><b>/etc/samba/smb.conf</b></p>
<p><b>     Samba configuration</b></p>
<p>[public]</p>
<p>Section defining a public share accessible on read/write by anyone</p>
<p>   comment = Public Storage on %L</p>
<p>Describe the public share to users</p>
<p>   path = /home/samba</p>
<p>Path of the public share on the server</p>
<p>   browsable = yes</p>
<p>Show the public share when browsing</p>
<p>   writeable = yes</p>
<p>Allow all users to write in this directory</p>
<p>[homes]</p>
<p>Section enabling users that have an account and a home directory</p>
<p>on the Samba server to access it and modify its contents from a </p>
<p>Samba client.</p>
<p>The </p>
<p>path</p>
<p> variable is not set, by default is </p>
<p>path=/home/%S</p>
<p>   comment = %U's home directory on %L from %m</p>
<p>Describe the share to the user</p>
<p>   browseable = no</p>
<p>Do not show the homes share when browsing</p>
<p>   writeable = yes</p>
<p>Allow the user to write in his home directory</p>
<p>[foobar]</p>
<p>Section defining a specific share</p>
<p>   path = /foobar</p>
<p>Path of the share on the server</p>
<p>   comment = Share Foobar on %L from %m</p>
<p>Describe the share to users</p>
<p>   browsable = yes</p>
<p>Show the share when browsing</p>
<p>   writeable = yes</p>
<p>Allow the users to write in this share</p>
<p>   valid users = jdoe, kgreen, +geeks</p>
<p>Allow access only to users &quot;jdoe&quot; and &quot;kgreen&quot;, and to local group</p>
<p>&quot;geeks&quot;</p>
<p>   invalid users = csmith</p>
<p>Deny access to user &quot;csmith&quot;</p>
<p>   read list = bcameron</p>
<p>Allow read-only access to user &quot;bcameron&quot;</p>
<p>   write list = fcastle</p>
<p>Allow read-write access to user &quot;fcastle&quot;</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>162/189</b></p>
<p><b>Samba access configuration</b></p>
<p><i>Samba access configuration</i></p>
<p><b>/etc/samba/smb.conf</b></p>
<p><b>     Samba configuration</b></p>
<p><b>User-level authentication</b></p>
<p>[global]</p>
<p>   security = user</p>
<p>Set up user-level authentication</p>
<p>   guest account = nobody</p>
<p>Map the guest account to the system user nobody (default)</p>
<p>   map to guest = Never</p>
<p>Specify how incoming requests are mapped to the guest account:</p>
<p>Bad User       </p>
<p>redirect from an invalid user to guest account on server</p>
<p>Bad Password   </p>
<p>redirect from an invalid password to guest account on server</p>
<p>Never          </p>
<p>reject unauthenticated users</p>
<p><b>Server-level authentication</b></p>
<p>[global]</p>
<p>   security = server</p>
<p>Set up server-level authentication</p>
<p>   password server = <i>srv1 srv2</i></p>
<p>Authenticate to server <i>srv1</i>, or to server <i>srv2</i> if the first one is unavailable</p>
<p><b>Domain-level authentication</b></p>
<p>[global]</p>
<p>   security = ADS</p>
<p>Set up domain-level authentication as an Active Directory member server</p>
<p>   realm = KRB_REALM</p>
<p>Join the specified realm.</p>
<p>Kerberos must be installed and an administrator account must be created:</p>
<p>net ads join -U Administrator%<i>password</i></p>
<p><b>Share-level authentication</b></p>
<p>[global]</p>
<p>   security = share</p>
<p>Set up share-level authentication</p>
<p>[foobar]</p>
<p>   path = /foobar</p>
<p>   username = <i>user</i></p>
<p>   only user = yes  </p>
<p>Define a &quot;foobar&quot; share accessible to any user which can supply <i>user</i>'s password.</p>
<p>The <i>user</i> must be created on the system:</p>
<p>useradd -c &quot;Foobar account&quot; -d /tmp -m -s /sbin/nologin <i>user</i></p>
<p>and added to the Samba password file:</p>
<p>smbpasswd -a <i>user</i></p>
<p><b>Samba macros</b></p>
<p>%S</p>
<p>Username</p>
<p>Macros applied only to configuration options used </p>
<p>once a connection has been established:</p>
<p>%U</p>
<p>Session username (the username that the client requested, </p>
<p>not necessarily the same as the one he got)</p>
<p>%G</p>
<p>Primary group of session username</p>
<p>%S</p>
<p>Name of the current service, if any</p>
<p>%h</p>
<p>Samba server hostname</p>
<p>%P</p>
<p>Root directory of the current service, if any</p>
<p>%M</p>
<p>Client hostname</p>
<p>%u</p>
<p>Username of the current service, if any</p>
<p>%L</p>
<p>NetBIOS name of the server</p>
<p>%g</p>
<p>Primary group name of username</p>
<p>%m</p>
<p>NetBIOS name of the client</p>
<p>%H</p>
<p>Home directory of username</p>
<p>%d</p>
<p>Process ID of the current server process</p>
<p>%N</p>
<p>Name of the NIS home directory server as </p>
<p>obtained from the NIS </p>
<p>auto.map</p>
<p> entry.</p>
<p>Same as </p>
<p>%L</p>
<p> if Samba was not compiled with </p>
<p>the </p>
<p>--with-automount</p>
<p> option</p>
<p>%a</p>
<p>Architecture of remote machine</p>
<p>%I</p>
<p>IP address of client machine</p>
<p>%i</p>
<p>Local IP address to which a client connected</p>
<p>%p</p>
<p>Path of service's home directory as obtained</p>
<p>from the NIS </p>
<p>auto.map</p>
<p> entry.</p>
<p>The NIS </p>
<p>auto.map</p>
<p> entry is split up as </p>
<p>%N:%p</p>
<p>%T</p>
<p>Current date and time</p>
<p>%D</p>
<p>Domain or workgroup of the current user</p>
<p>%w</p>
<p>Winbind separator</p>
<p>%$(<i>var</i>)</p>
<p>Value of the environment variable <i>var</i></p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>163/189</b></p>
<p><b>Samba setup</b></p>
<p><i>Samba setup</i></p>
<p><b>Samba setup</b></p>
<p>This procedure allows sharing on read-write the local directory </p>
<p>/smbshare</p>
<p> on server 10.1.1.1 to client 10.2.2.2.</p>
<p>Server setup: </p>
<p>1.</p>
<p>Create the group for write access to the share</p>
<p>groupadd -r geeks</p>
<p>2.</p>
<p>Create the user and assign it to the group</p>
<p>useradd -G geeks jdoe</p>
<p>3.</p>
<p>Add the user to Samba.</p>
<p>You will be prompted to enter a password</p>
<p>smbpasswd -a jdoe</p>
<p>4.</p>
<p>Assign correct ownership to the share</p>
<p>chgrp geeks /smbshare</p>
<p>5.</p>
<p>Set the SGID bit to the share</p>
<p>chmod 2775 /smbshare</p>
<p>6.</p>
<p>Set the correct SELinux label to the share</p>
<p>semanage fcontext -a -t samba_share_t '/smbshare'</p>
<p>restorecon -FR /smbshare</p>
<p>7.</p>
<p>Enable the SELinux boolean for write access to</p>
<p>the share </p>
<p>setsebool -P samba_export_all_rw=on</p>
<p>8.</p>
<p>Add a section for the share on </p>
<p>/etc/samba/smb.conf</p>
<p>:</p>
<p>[smbshare]</p>
<p>   path = /smbshare</p>
<p>   hosts allow = 10.2.2.2</p>
<p>   write list = @geeks</p>
<p>9.</p>
<p>Ensure that the </p>
<p>smb</p>
<p> and </p>
<p>nmb</p>
<p> services are running</p>
<p>Client setup:</p>
<p>1.</p>
<p>Add an entry to </p>
<p>/etc/fstab</p>
<p> to mount the Samba share device automatically:</p>
<p>//10.1.1.1/smbshare  <i>/mountpoint</i>  cifs  username=jdoe,password=s3cr3t  0 0</p>
<p>Client multiuser setup:</p>
<p>1.</p>
<p>Add an entry to </p>
<p>/etc/fstab</p>
<p> to mount the Samba share device automatically in multiuser mode:</p>
<p>//10.1.1.1/smbshare  <i>/mountpoint</i>  cifs  username=jdoe,password=s3cr3t,multiuser,sec=ntlmssp  0 0</p>
<p>2.</p>
<p>Login as another user (there must be a matching </p>
<p>Samba user on the Samba server 10.1.1.1)  </p>
<p>su - ksmith</p>
<p>3.</p>
<p>Store the Samba username and password in the </p>
<p>kernel keyring for the current session</p>
<p>cifscreds add 10.1.1.1</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>164/189</b></p>
<p><b>NFS</b></p>
<p><i>NFS</i></p>
<p>A Network File System (NFS) server makes filesystems available to remote clients for mounting.</p>
<p>NFS requires the portmapper to map incoming TCP/IP connections to the appropriate NFS RPC calls.  Some Linux </p>
<p>distributions use rpcbind instead of the portmapper.</p>
<p>For security reasons, the TCP Wrapper should be configured to limit access to the portmapper to NFS clients only:</p>
<p>file </p>
<p>/etc/hosts.deny  </p>
<p>should contain</p>
<p> portmap: ALL</p>
<p>file </p>
<p>/etc/hosts.allow </p>
<p>should contain</p>
<p> portmap: <i>IP_addresses_of_clients</i></p>
<p>NFS handles user permissions across systems by considering users with same UID and username as the same user.</p>
<p>Group permission is evaluated similarly, by GID and groupname.</p>
<p>rpc.nfsd</p>
<p>rpc.mountd</p>
<p>rpc.lockd</p>
<p>rpc.statd </p>
<p>NFS daemons</p>
<p>/etc/exports</p>
<p>List of the filesystems to be exported (via the command </p>
<p>exportfs</p>
<p>)</p>
<p>/var/lib/nfs/xtab</p>
<p>List of exported filesystems, maintained by </p>
<p>exportfs</p>
<p>/proc/fs/nfs/exports</p>
<p>Kernel export table (can be examined via the command </p>
<p>cat</p>
<p>)</p>
<p>exportfs -ra</p>
<p>Export or reexport all directories.</p>
<p>When exporting, fills the kernel export table </p>
<p>/proc/fs/nfs/exports</p>
<p>.</p>
<p>When reexporting, removes the entries in </p>
<p>/var/lib/nfs/xtab</p>
<p> that are </p>
<p>deleted from </p>
<p>/etc/exports</p>
<p> (therefore synchronizing the two files), and </p>
<p>removes the entries from </p>
<p>/proc/fs/nfs/exports</p>
<p> that are no longer valid</p>
<p>exportfs -ua</p>
<p>Unexport all directories.</p>
<p>Removes from </p>
<p>/proc/fs/nfs/exports</p>
<p> the entries that are listed in </p>
<p>/var/lib/nfs/xtab</p>
<p>, and clears the latter file</p>
<p>showmount</p>
<p>Show the remote client hosts currently having active mounts</p>
<p>showmount --directories</p>
<p>Show the directories currently mounted by a remote client host</p>
<p>showmount --exports</p>
<p>Show the filesystems currently exported i.e. the active export list</p>
<p>showmount --all</p>
<p>Show both remote client hosts and directories</p>
<p>showmount -e <i>nfsserver</i></p>
<p>Show the shares a NFS server has available for mounting</p>
<p>rpcinfo -p <i>nfsserver</i></p>
<p>Probe the portmapper on a NFS server and display the list of all registered </p>
<p>RPC services there</p>
<p>rpcinfo -t <i>nfsserver</i> nfs</p>
<p>Test a NFS connection by sending a null pseudo request (using TCP)</p>
<p>rpcinfo -u <i>nfsserver</i> nfs</p>
<p>Test a NFS connection by sending a null pseudo request (using UDP)</p>
<p>nfsstat</p>
<p>Display NFS/RPC client/server statistics.</p>
<p>Options:</p>
<p><b>NFS</b></p>
<p><b>RPC</b></p>
<p><b>both</b></p>
<p><b>server</b></p>
<p>-sn</p>
<p>-sr</p>
<p>-s</p>
<p><b>client</b></p>
<p>-cn</p>
<p>-cr</p>
<p>-c</p>
<p><b>both</b></p>
<p>-n</p>
<p>-r</p>
<p>-nr</p>
<p>mount -t nfs <i>nfsserver</i>:/share /usr</p>
<p>Command to be run on a client to mount locally a remote NFS share.</p>
<p>NFS shares accessed frequently should be added to </p>
<p>/etc/fstab</p>
<p> e.g.</p>
<p><i>nfsserver</i>:/share  /usr  nfs  intr  0 0</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>165/189</b></p>
<p><b>/etc/exports</b></p>
<p><i>/etc/exports</i></p>
<p><b>/etc/exports</b></p>
<p>/export/          10.3.3.3(rw)</p>
<p>/export2/         10.4.4.0/24</p>
<p>/export3/         *(ro,sync)</p>
<p>/home/ftp/pub     myhost(rw)  *.example.org(ro)</p>
<p>/home/crew        @FOOWORKGROUP(rw)  (ro)</p>
<p><b>filesystem</b> Filesystem on the NFS server to be exported to clients</p>
<p><b>client</b></p>
<p><b>identity</b></p>
<p>Client systems permitted to access the exported directory.  Can be specified by hostname, IP address, </p>
<p>wildcard, subnet, or @NIS workgroup.</p>
<p>Multiple client systems can be listed, and each one can have different options</p>
<p><b>client</b></p>
<p><b>options</b></p>
<p>ro</p>
<p>Read-only access (default)</p>
<p>rw</p>
<p>Read and write access.  The client may choose to mount read-only anyway</p>
<p>sync</p>
<p>Reply to requests only after the changes made by these requests have been committed </p>
<p>to stable storage</p>
<p>async</p>
<p>Reply to requests without waiting that changes are committed to stable storage. </p>
<p>Improves performances but might cause loss or corruption of data if server crashes</p>
<p>root_squash</p>
<p>Requests by user </p>
<p>root</p>
<p> on client will be done as user </p>
<p>nobody</p>
<p> on server (default)</p>
<p>no_root_squash</p>
<p>Requests by user </p>
<p>root</p>
<p> on client will be done as same user </p>
<p>root</p>
<p> on server</p>
<p>all_squash</p>
<p>Requests by a non-root user on client will be done as user </p>
<p>nobody</p>
<p> on server</p>
<p>no_all_squash</p>
<p>Requests by a non-root user on client will be attempted as same user on server (default)</p>
<p><b>NFS mount options</b></p>
<p>rsize=<i>nnn</i></p>
<p>Size for read transfers (from server to client)</p>
<p>wsize=<i>nnn</i></p>
<p>Size for write transfers (from client to server)</p>
<p>nfsvers=<i>n</i></p>
<p>Use NFS version <i>n</i> for transport</p>
<p>retry=<i>n</i></p>
<p>Keep retrying a mount attempt for <i>n</i> minutes before giving up</p>
<p>timeo=<i>n</i></p>
<p>A mount attempt times out after <i>n</i> tenths of a second</p>
<p>intr</p>
<p>User can interrupt a mount attempt</p>
<p>nointr</p>
<p>User cannot interrupt a mount attempt (default)</p>
<p>hard</p>
<p>The system will try a mount indefinitely (default)</p>
<p>soft</p>
<p>The system will try a mount until an RPC timeout occurs</p>
<p>bg</p>
<p>Try a mount in the foreground; all retries occur in the background</p>
<p>fg</p>
<p>All mount attempts occur in the foreground (default)</p>
<p>tcp</p>
<p>Connect using TCP</p>
<p>udp</p>
<p>Connect using UDP</p>
<p>sec=krb5p</p>
<p>Use Kerberos to encrypt all requests between client and server</p>
<p>v4.2</p>
<p>Enable NFS v4.2, which allows the server to export the SELinux context</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>166/189</b></p>
<p><b>NFS setup</b></p>
<p><i>NFS setup</i></p>
<p><b>NFS setup</b></p>
<p>This procedure allows sharing on read-write the local directory </p>
<p>/nfsshare</p>
<p> on server 10.1.1.1 to client 10.2.2.2. </p>
<p>Server setup:</p>
<p>1.</p>
<p>Ensure that the </p>
<p>nfs-server</p>
<p> service is running</p>
<p>2.</p>
<p>Change ownership of the share</p>
<p>chown nfsnobody /nfsshare</p>
<p>3.</p>
<p>Add an entry for the share on </p>
<p>/etc/exports</p>
<p>:</p>
<p>/nfsshare  10.2.2.2(rw)</p>
<p>4.</p>
<p>Reload the exports file</p>
<p>exportfs -r</p>
<p>Client setup:</p>
<p>1.</p>
<p>Add an entry to </p>
<p>/etc/fstab</p>
<p> to mount the NFS share device automatically:</p>
<p>10.1.1.1:/nfsshare  <i>/mountpoint</i>  nfs  defaults  0 0</p>
<p><b>Secure NFS setup</b></p>
<p>This procedure allows sharing on read-write the local directory </p>
<p>/nfsshare</p>
<p> on server 10.1.1.1 to client 10.2.2.2, securely </p>
<p>with Kerberos enabled.</p>
<p>Server setup:</p>
<p>1.</p>
<p>Install the appropriate server keytab on </p>
<p>/etc/krb5.keytab</p>
<p>2.</p>
<p>Ensure that the </p>
<p>nfs-secure-server</p>
<p> service is running</p>
<p>3.</p>
<p>Change ownership of the share</p>
<p>chown nfsnobody /nfsshare</p>
<p>4.</p>
<p>Add an entry for the share on </p>
<p>/etc/exports</p>
<p>:</p>
<p>/nfsshare  10.2.2.2(sec=krb5p,rw)</p>
<p>5.</p>
<p>Reload the exports file</p>
<p>exportfs -r</p>
<p>Client setup:</p>
<p>1.</p>
<p>Install the appropriate client keytab on </p>
<p>/etc/krb5.keytab</p>
<p>2.</p>
<p>Ensure that the </p>
<p>nfs-secure</p>
<p> service is running</p>
<p>3.</p>
<p>Add an entry to </p>
<p>/etc/fstab</p>
<p> to mount the NFS share device automatically:</p>
<p>10.1.1.1:/nfsshare  <i>/mountpoint</i>  nfs  defaults,sec=krb5p  0 0</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>167/189</b></p>
<p><b>iSCSI</b></p>
<p><i>iSCSI</i></p>
<p><b>iSCSI</b> (Internet Small Computer System Interface) is a network protocol that allows emulating an SCSI local storage device </p>
<p>over a TCP/IP network.  By default it uses TCP port 3260.</p>
<p>An iSCSI server can use a local block device (physical or virtual disk, disk partition, or Logical Volume), a file, a physical </p>
<p>SCSI device, or a ramdisk as the underlying storage resource (<b>backstore</b>) and make it available by assigning it a <b>LUN</b> </p>
<p>(Logical Unit Number).  An iSCSI server provides one or more <b>targets</b>, each of which presents one or more LUNs and is able</p>
<p>to accept connections from an iSCSI client (<b>initiator</b>).</p>
<p>Targets and initiators are called <b>nodes</b> and are identified by a unique <b>IQN</b> (iSCSI Qualified Name) e.g.</p>
<p>iqn.2017-11.org.example.subdomain:foo:bar</p>
<p>.  The IP address and port of a node is called a <b>portal</b>.</p>
<p>A target accepts connections from an initiator via a <b>TPG</b> (Target Portal Group) i.e. its IP address and port.  A TPG may have </p>
<p>in place an <b>ACL</b> so to accept connections only from a specific initiator's IQN.</p>
<p>targetcli</p>
<p>Target configurator (server side).  Can be used as a command line tool or as an interactive shell.</p>
<p>Configuration is saved to </p>
<p>/etc/target/saveconfig.json</p>
<p>iscsiadm</p>
<p>Administration tool for iSCSI devices (client side)</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>168/189</b></p>
<p><b>iSCSI setup</b></p>
<p><i>iSCSI setup</i></p>
<p><b>iSCSI setup</b></p>
<p>This procedure makes available the local disk </p>
<p>/dev/sbd</p>
<p> on server 10.1.1.1 to the client having IQN</p>
<p>iqn.2017-11.org.example:client</p>
<p>.</p>
<p>Server (target) setup:</p>
<p>1.</p>
<p>Ensure that the </p>
<p>targetcli</p>
<p> service is running</p>
<p>2.</p>
<p>Enter the targetcli shell</p>
<p>targetcli</p>
<p>3.</p>
<p>Create a backstore</p>
<p>cd /backstores/block</p>
<p>create mydisk /dev/sdb</p>
<p>4.</p>
<p>Create a IQN for the target.</p>
<p>This automatically creates a TPG for the IQN</p>
<p>cd /iscsi</p>
<p>create iqn.2017-11.org.example:target</p>
<p>5.</p>
<p>On the TPG, create an ACL to allow connections </p>
<p>from the initiator with a specific IQN</p>
<p>cd /iscsi/iqn.2017-11.org.example:target/tpg1/acls </p>
<p>create iqn.2017-11.org.example:client</p>
<p>6.</p>
<p>On the TPG, create a LUN for the backstore</p>
<p>cd /iscsi/iqn.2017-11.org.example:target/tpg1/luns</p>
<p>create /backstores/block/mydisk</p>
<p>7.</p>
<p>On the TPG, create a portal listening from the </p>
<p>server's IP address</p>
<p>cd /iscsi/iqn.2017-11.org.example:target/tpg1/portals</p>
<p>delete 0.0.0.0 ip_port=3260</p>
<p>create 10.1.1.1</p>
<p>8.</p>
<p>Verify the configuration</p>
<p>ls /</p>
<p>o- / ........................................................................................ [...]</p>
<p>  o- backstores ............................................................................. [...]</p>
<p>  | o- block ................................................................. [Storage Objects: 1]</p>
<p>  | | o- mydisk ........................................ [/dev/sdb (100.0MiB) write-thru activated]</p>
<p>  | |   o- alua .................................................................. [ALUA Groups: 1]</p>
<p>  | |     o- default_tg_pt_gp ...................................... [ALUA state: Active/optimized]</p>
<p>  | o- fileio ................................................................ [Storage Objects: 0]</p>
<p>  | o- pscsi ................................................................. [Storage Objects: 0]</p>
<p>  | o- ramdisk ............................................................... [Storage Objects: 0]</p>
<p>  o- iscsi ........................................................................... [Targets: 1]</p>
<p>  | o- iqn.2017-11.org.example:target ................................................... [TPGs: 1]</p>
<p>  |   o- tpg1 .............................................................. [no-gen-acls, no-auth]</p>
<p>  |     o- acls ......................................................................... [ACLs: 1]</p>
<p>  |     | o- iqn.2017-11.org.example:client ...................................... [Mapped LUNs: 1]</p>
<p>  |     |   o- mapped_lun0 ............................................... [lun0 block/mydisk (rw)]</p>
<p>  |     o- luns ......................................................................... [LUNs: 1]</p>
<p>  |     | o- lun0 .................................... [block/mydisk (/dev/sdb) (default_tg_pt_gp)]</p>
<p>  |     o- portals ................................................................... [Portals: 1]</p>
<p>  |       o- 10.1.1.1:3260 ................................................................... [OK]</p>
<p>  o- loopback ........................................................................ [Targets: 0]</p>
<p>9.</p>
<p>Exit the targetcli shell.</p>
<p>Configuration is automatically saved</p>
<p>exit</p>
<p>Client (initiator) setup:</p>
<p>1.</p>
<p>Set the correct initiator IQN in the file </p>
<p>/etc/iscsi/initiatorname.iscsi</p>
<p>:</p>
<p>InitiatorName=iqn.2017-11.org.example:client</p>
<p>2.</p>
<p>Ensure that the </p>
<p>iscsi</p>
<p> service is running</p>
<p>3.</p>
<p>Discover the iSCSI target(s) provided</p>
<p>by the portal.  This echoes the target(s) </p>
<p>IQN found</p>
<p>iscsiadm -m discovery -t sendtargets -p 10.1.1.1</p>
<p>4.</p>
<p>Login to the target IQN found</p>
<p>iscsiadm -m node -T iqn.2017-11.org.example:target -p 10.1.1.1 -l</p>
<p>The iSCSI device is now locally available and can be formatted and mounted.  Node records remain after logout or </p>
<p>reboot; the system will login again to the target IQN automatically</p>
<p>5.</p>
<p>Add an entry to </p>
<p>/etc/fstab</p>
<p> to mount the iSCSI device automatically:</p>
<p>UUID=<i>nnnnnnnn-nnnn-nnnn-nnnn-nnnnnnnnnnnn</i>  <i>/mountpoint</i>  <i>fstype</i>  _netdev  0 0</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>169/189</b></p>
<p><b>DHCP</b></p>
<p><i>DHCP</i></p>
<p>DHCP (Dynamic Host Configuration Protocol) is a protocol for network management that automatically provides a requesting</p>
<p>host with an IP address and other network configuration parameters.  It is based on BOOTP (Bootstrap Protocol).</p>
<p>A DHCP server listens for requests on UDP port 67 and answers to UDP port 68.  The assignment of an IP address to a host </p>
<p>is done through a sequence of DHCP messages initiated by the client host: DHCP Discover, DHCP Offer, DHCP Request, and </p>
<p>finally DHCP Acknowledgment.</p>
<p>Because DHCP Discover messages are broadcast and therefore not routed outside a LAN, a DHCP relay agent is necessary </p>
<p>for those clients situated outside the DHCP server's LAN.  The DHCP relay agent listens to DHCP Discover messages and </p>
<p>relays them in unicast to the DHCP server.</p>
<p>/etc/dhcpd.conf</p>
<p>Configuration file for the DHCP server</p>
<p>/etc/sysconfig/dhcrelay  </p>
<p>(SUSE)</p>
<p>Configuration file for the DHCP relay agent</p>
<p>/var/lib/dhcpd/dhcpd.leases</p>
<p>DHCP current leases</p>
<p><b>/etc/dhcpd.conf</b></p>
<p><b>     DHCP server configuration</b></p>
<p>option domain-name-servers 10.2.2.2;</p>
<p>option smtp-servers 10.3.3.3;</p>
<p>option pop-servers 10.4.4.4;</p>
<p>option time-servers 10.5.5.5;</p>
<p>option nntp-servers 10.6.6.6;</p>
<p>Global parameters for DNS, mail, NTP, and news servers </p>
<p>specification</p>
<p>shared-network geek-net {</p>
<p>Definition of a network</p>
<p>   default-lease-time 86400;</p>
<p>Time, in seconds, that will be assigned to a lease if a client</p>
<p>does not ask for a specific expiration time</p>
<p>   max-lease-time 172800;</p>
<p>Maximum time, in seconds, that can be assigned to a </p>
<p>lease if a client asks for a specific expiration time</p>
<p>   option routers 10.0.3.252;</p>
<p>   option broadcast-address 10.0.3.255;</p>
<p>   subnet 10.0.3.0 netmask 255.255.255.128 {</p>
<p>      range 10.0.3.1 10.0.3.101;</p>
<p>   }</p>
<p>   subnet 10.0.3.128 netmask 255.255.255.128 {</p>
<p>      range 10.0.3.129 10.0.3.229;</p>
<p>   }</p>
<p>}</p>
<p>Definition of different subnets in the network, with </p>
<p>specification of different ranges of IP addresses that will be</p>
<p>leased to clients depending on the client's subnet</p>
<p>group {</p>
<p>Definition of a group</p>
<p>   option routers 10.0.17.252;</p>
<p>   option broadcast-address 10.0.17.255;</p>
<p>   netmask 255.255.255.0;</p>
<p>   host linuxbox1 {</p>
<p>      hardware ethernet AA:BB:CC:DD:EE:FF;</p>
<p>      fixed-address 10.0.17.42;</p>
<p>      option host-name &quot;linuxbox1&quot;;</p>
<p>   }</p>
<p>   host linuxbox2 {</p>
<p>      hardware ethernet 33:44:55:66:77:88;</p>
<p>      fixed-address 10.0.17.66;</p>
<p>      option host-name &quot;linuxbox2&quot;;</p>
<p>   }</p>
<p>}       </p>
<p>Definition of different hosts to whom static IP addresses </p>
<p>will be assigned to, depending on their MAC address</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>170/189</b></p>
<p><b>PAM</b></p>
<p><i>PAM</i></p>
<p>PAM (Pluggable Authentication Modules) is an abstraction layer that allows applications to use authentication methods while </p>
<p>being implementation-agnostic.</p>
<p>/etc/pam.d/<i>service</i></p>
<p>PAM configuration for <i>service</i></p>
<p>/etc/pam.conf  </p>
<p>(obsolete)</p>
<p>PAM configuration for all services</p>
<p>ldd /usr/sbin/<i>service</i> | grep libpam</p>
<p>Check if <i>service</i> is enabled to use PAM</p>
<p><b>/etc/pam.d/<i>service</b></i></p>
<p>auth       requisite   pam_securetty.so</p>
<p>auth       required    pam_nologin.so</p>
<p>auth       required    pam_env.so</p>
<p>auth       required    pam_unix.so nullok</p>
<p>account    required    pam_unix.so</p>
<p>session    required    pam_unix.so</p>
<p>session    optional    pam_lastlog.so</p>
<p>password   required    pam_unix.so nullok obscure min=4 max=8</p>
<p><b>type</b></p>
<p>auth</p>
<p>Authentication module to verify user identity and group membership</p>
<p>account</p>
<p>Authorization module to determine user's right to access a resource (other than his identity)</p>
<p>password</p>
<p>Module to update a user's authentication credentials</p>
<p>session</p>
<p>Module (run at end and beginning of a user session) to set up the user environment</p>
<p><b>control</b></p>
<p>optional</p>
<p>Module is not critical to the success or failure of <i>service</i></p>
<p>sufficient</p>
<p>If this module successes, and no previous module has failed, module stack processing ends </p>
<p>successfully.  If this module fails, it is non-fatal and processing of the stack continues</p>
<p>required</p>
<p>If this module fails, processing of the stack continues until the end, and <i>service</i> fails</p>
<p>requisite</p>
<p>If this module fails, <i>service</i> fails and control returns to the application that invoked <i>service</i></p>
<p>include</p>
<p>Include modules from another PAM service file</p>
<p><b>module</b></p>
<p>PAM module and its options, e.g.:</p>
<p>pam_unix.so</p>
<p>Standard UNIX authentication module via </p>
<p>/etc/passwd</p>
<p> and </p>
<p>/etc/shadow</p>
<p>pam_nis.so</p>
<p>Module for authentication via NIS</p>
<p>pam_ldap.so</p>
<p>Module for authentication via LDAP</p>
<p>pam_fshadow.so</p>
<p>Module for authentication against an alternative shadow passwords file</p>
<p>pam_cracklib.so</p>
<p>Module for password strength policies (e.g. length, case, max number of retries)</p>
<p>pam_limits.so</p>
<p>Module for system policies and system resource usage limits</p>
<p>pam_listfile.so</p>
<p>Module to deny or allow the service based on an arbitrary text file</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>171/189</b></p>
<p><b>LDAP</b></p>
<p><i>LDAP</i></p>
<p>LDAP (Lightweight Directory Access Protocol) is a simplified version of the X.500 standard and uses TCP port 389.</p>
<p>LDAP allows to organize hierarchically a database of entries, each one of which is identified by a unique <b>DN (Distinguished </b></p>
<p><b>Name)</b>.  Each DN has a set of <b>attributes</b>, and each attribute has a <b>value</b>; an attribute may appear multiple times.  </p>
<p>Special attributes called <b>objectClass</b> define which attributes are allowed and which are required, and determine the </p>
<p><b>schema</b> of the LDAP.</p>
<p>dn: cn=John Doe,dc=example,dc=org</p>
<p>Distinguished Name</p>
<p><b>Examples of LDAP attributes</b></p>
<p><b>Attribute</b></p>
<p><b>Attribute with value</b></p>
<p><b>Meaning</b></p>
<p>cn</p>
<p>cn: John Doe</p>
<p>Common Name</p>
<p>dc</p>
<p>dc=example,dc=org</p>
<p>Domain Component</p>
<p>givenName</p>
<p>givenName: John</p>
<p>First name</p>
<p>sn</p>
<p>sn: Doe</p>
<p>Surname</p>
<p>mail</p>
<p>mail: jdoe@example.org</p>
<p>Email address</p>
<p>telephoneNumber</p>
<p>telephoneNumber: +1 555 1234 567</p>
<p>Telephone number</p>
<p>uid</p>
<p>uid: jdoe</p>
<p>User ID</p>
<p>c</p>
<p>c: US</p>
<p>Country code</p>
<p>l</p>
<p>l: San Francisco</p>
<p>Locality</p>
<p>st</p>
<p>st: California</p>
<p>State or province</p>
<p>street</p>
<p>street: 42, Penguin Road</p>
<p>Street</p>
<p>o</p>
<p>o: The Example Foundation</p>
<p>Organization</p>
<p>ou</p>
<p>ou: IT Dept</p>
<p>Organizational Unit</p>
<p>manager</p>
<p>manager: cn=Kim Green,dc=example,dc=org</p>
<p>Manager</p>
<p><b>LDIF (LDAP Data Interchange Format)</b></p>
<p>dn: cn=John Doe, dc=example, dc=org</p>
<p>changetype: modify</p>
<p>replace: mail</p>
<p>mail: johndoe@otherexample.com</p>
<p>-</p>
<p>add: jpegPhoto</p>
<p>jpegPhoto:&lt; file://tmp/jdoe.jpg</p>
<p>-</p>
<p>delete: description</p>
<p>-</p>
<p>This LDIF file will change the email address of </p>
<p>user &quot;jdoe&quot;, add a picture, and delete the </p>
<p>description attribute for the entry</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>172/189</b></p>
<p><b>ldapsearch</b></p>
<p><i>ldapsearch</i></p>
<p>All the LDAP commands below accept the following arguments, plus some extra arguments which are command-dependent.</p>
<p>-H ldap://<i>srv</i></p>
<p>Connect to the specified LDAP server</p>
<p>-H ldapi://</p>
<p>Connect to the localhost LDAP server using IPC instead of a network socket</p>
<p>-D <i>binddn</i></p>
<p>Bind (authenticate) to the LDAP server as the specified DN</p>
<p>-w <i>password</i></p>
<p>Authenticate with the specified <i>password</i></p>
<p>-W  </p>
<p>Prompt for authentication</p>
<p>-x</p>
<p>Use simple authentication instead of SASL</p>
<p>-v</p>
<p>Use verbose mode for output</p>
<p>ldapsearch <i>args</i></p>
<p>Query a LDAP server and return the output in LDIF</p>
<p>-b <i>base</i></p>
<p>Start searching from <i>base</i></p>
<p>-z <i>n</i></p>
<p>Retrieve at maximum <i>n</i> entries as result </p>
<p>-LLL</p>
<p>Terse output.  Outputs the result in LDIFv1, does not print comments, and </p>
<p>omits the LDIF version number</p>
<p><i>filter</i></p>
<p>Search filter.  If not specified, uses the default filter </p>
<p>(objectClass=*)</p>
<p><i>attributes</i></p>
<p>Attributes to return.  If not specified, returns all attributes</p>
<p>ldapmodify <i>args</i></p>
<p>Modify a LDAP entry</p>
<p>ldapadd <i>args</i></p>
<p>ldapmodify -a <i>args</i></p>
<p>Add a LDAP entry</p>
<p>ldapdelete <i>args</i></p>
<p>Delete a LDAP entry</p>
<p>-f <i>file.ldif</i></p>
<p>Modify the entry according to the LDIF file</p>
<p>ldappasswd <i>args</i></p>
<p>Change the password of a LDAP entry</p>
<p>-s <i>password</i></p>
<p>Set the new password as <i>password</i></p>
<p>-S  </p>
<p>Prompt for the new password</p>
<p>ldapsearch -H ldap://ldap.example.org -s base \ </p>
<p>-b &quot;ou=people,dc=example,dc=com&quot; &quot;(sn=Doe)&quot; \</p>
<p>cn sn telephoneNumber</p>
<p>Query a LDAP server for entries in the OU &quot;people&quot; </p>
<p>whose surname is &quot;Doe&quot;; print common name, </p>
<p>surname, and telephone number of the entries found</p>
<p>ldapmodify -b -r -f <i>file.ldif</i></p>
<p>Modify an entry according to the LDIF file specified</p>
<p>ldapadd -h ldap.example.org \ </p>
<p>-D &quot;cn=Admin,dc=example,dc=org&quot; -W -f <i>file.ldif</i></p>
<p>Authenticating as &quot;Admin&quot;, add an entry by adding </p>
<p>the content of the specified LDIF file to the directory</p>
<p>ldapdelete -h ldap.example.org \</p>
<p>-D &quot;cn=Admin,dc=example,dc=org&quot; -W \</p>
<p>&quot;uid=jdoe,dc=example,dc=org&quot;</p>
<p>Authenticating as &quot;Admin&quot;, delete the user &quot;jdoe&quot;</p>
<p>ldappasswd -h ldap.example.org \</p>
<p>-D &quot;cn=Admin,dc=example,dc=org&quot; -W -x \</p>
<p>-S &quot;uid=jdoe,ou=IT Dept,dc=example,dc=org&quot; </p>
<p>Authenticating as &quot;Admin&quot; on example.org, change </p>
<p>the password of user &quot;jdoe&quot; in the OU &quot;IT Dept&quot;</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>173/189</b></p>
<p><b>OpenLDAP</b></p>
<p><i>OpenLDAP</i></p>
<p>OpenLDAP is an open source implementation of LDAP, and was initially developed together with the LDAP protocol.  Its </p>
<p>related service is </p>
<p>slapd</p>
<p>, the Standalone OpenLDAP daemon.  </p>
<p>sssd</p>
<p>, the System Security Services Daemon, can be used to provide access to OpenLDAP as an authentication and identity </p>
<p>provider.</p>
<p>/var/lib/ldap/</p>
<p>Files constituting the OpenLDAP database</p>
<p>/etc/openldap/slapd.conf</p>
<p>/usr/local/etc/openldap/slapd.conf</p>
<p>OpenLDAP configuration file (deprecated)</p>
<p>/usr/local/etc/openldap/slapd.d/</p>
<p>From v2.3 onwards, directory containing the LDIF database </p>
<p>that stores the OpenLDAP configuration.  These LDIF files </p>
<p>must not be edited by hand  </p>
<p>slapcat -b cn=config</p>
<p>ldapsearch -Y EXTERNAL -H ldapi:/// -b cn=config</p>
<p>Show the OpenLDAP configuration</p>
<p>slaptest -u</p>
<p>Verify that the OpenLDAP configuration is correct</p>
<p>slapcat -l file.ldif</p>
<p>Dump the contents of an OpenLDAP database to an LDIF file</p>
<p>slapadd -l file.ldif</p>
<p>Import an OpenLDAP database from an LDIF file</p>
<p>slapindex</p>
<p>Regenerate OpenLDAP's database indexes</p>
<p>yum install openldap openldap-clients authconfig \</p>
<p>sssd nss-pam-ldapd authconfig-gtk  </p>
<p>(RHEL 7)</p>
<p>Install the OpenLDAP client </p>
<p>authconfig --enableldap --enableldapauth \ </p>
<p>--ldapserver=ldap://<i>ldapserver</i> \ </p>
<p>--ldapbasedn=&quot;dc=example,dc=org&quot; \</p>
<p>--enablesssd --update  </p>
<p>(RHEL 7)</p>
<p>Set up the LDAP client to connect to a <i>ldapserver</i>.</p>
<p>This will update the configuration files </p>
<p>/etc/sssd/sssd.conf </p>
<p>and</p>
<p> /etc/openldap/ldap.conf</p>
<p>authselect select sssd --force  </p>
<p>(RHEL 8)</p>
<p>Set up LDAP client authentication via </p>
<p>sssd</p>
<p>authconfig-gtk</p>
<p>system-config-authentication</p>
<p>OpenLDAP configuration GUI</p>
<p>getent group <i>groupname</i></p>
<p>Get entries about <i>groupname</i> from NSS libraries</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>174/189</b></p>
<p><b>SELinux</b></p>
<p><i>SELinux</i></p>
<p>Security-Enhanced Linux (SELinux) is a Linux kernel security module that provides a mechanism for supporting access </p>
<p>control security policies.</p>
<p>SELinux implements a Mandatory Access Control framework that allows the definition of fine-grained permissions for how </p>
<p><b>subjects</b> (i.e. processes) access <b>objects</b> (i.e. other processes, files, devices, ports, sockets); this improves security with </p>
<p>respect to the traditional Discretionary Access Control, which defines accesses based on users and groups.</p>
<p>Processes, files, and users have a <b>security context</b> structured as <i>user:role:type:level</i> e.g. </p>
<p>unconfined_u:object_r:user_home_t:s0</p>
<p>.  The third field defines a <i>type</i> for files or a <i>domain</i> for processes.   </p>
<p>The decisions SELinux takes about allowing or disallowing access are stored in the <b>AVC (Access Vector Cache)</b>.</p>
<p>SELinux creates a pseudo filesystem (SELinuxfs) containing commands used by the kernel for its operations; this filesystem </p>
<p>is usually mounted on </p>
<p>/selinux/</p>
<p> or </p>
<p>/sys/fs/selinux/</p>
<p>.</p>
<p>setenforce 0</p>
<p>echo 0 &gt; /<i>selinuxfs</i>/enforce  </p>
<p>Enter permissive mode (SELinux must be enabled)</p>
<p>setenforce 1</p>
<p>echo 1 &gt; /<i>selinuxfs</i>/enforce  </p>
<p>Enter enforcing mode (SELinux must be enabled)</p>
<p>getenforce</p>
<p>cat /<i>selinuxfs</i>/enforce</p>
<p>Display current mode</p>
<p>sestatus -v</p>
<p>Show SELinux mode, SELinuxfs mount point, etc.</p>
<p>SELinux state can be configured permanently in </p>
<p>/etc/selinux/config</p>
<p> (symlinked in </p>
<p>/etc/sysconfig/selinux</p>
<p>):</p>
<p>mode</p>
<p>SELINUX=</p>
<p>enforcing</p>
<p>SELinux fully enforces security policies</p>
<p>permissive</p>
<p>SELinux does not enforce security policies, but logs violations</p>
<p>disabled</p>
<p>SELinux security policies are disabled</p>
<p>policy</p>
<p>SELINUXTYPE=</p>
<p>targeted</p>
<p>SELinux protects targeted daemons</p>
<p>strict</p>
<p>(up to RHEL 6) SELinux fully protects the system</p>
<p>minimum</p>
<p>(RHEL 7 and later) SELinux only protects selected processes</p>
<p>mls</p>
<p>(RHEL 7 and later) Multi Level Security protection</p>
<p>ls -Z</p>
<p>List files and their security context.  The security context of a</p>
<p>file is stored in its extended attributes</p>
<p>ps -eZ</p>
<p>List processes and their security context</p>
<p>tar --selinux <i>otherargs</i></p>
<p>star -xattr -H=exustar <i>otherargs</i></p>
<p>Create or extract archives that retain the security context of </p>
<p>the original files</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>175/189</b></p>
<p><b>semanage</b></p>
<p><i>semanage</i></p>
<p>chcon <i>context</i> <i>file</i></p>
<p>Change the security context of <i>file</i> to the specified <i>context</i></p>
<p>chcon --reference=<i>file0</i> <i>file</i></p>
<p>Change the security context of <i>file</i> to be the same as <i>file0</i></p>
<p>restorecon -f <i>file</i></p>
<p>Restore the security context of <i>file</i> to the system default</p>
<p>getsebool <i>boolean</i></p>
<p>Get the value of a SELinux boolean</p>
<p>setsebool <i>boolean</i>=<i>value</i></p>
<p>Set the value of a SELinux boolean</p>
<p>semanage</p>
<p>Manage SELinux policies</p>
<p>semanage fcontext -l</p>
<p>List files and their assigned SELinux labels</p>
<p>semanage fcontext -a -t <i>label file</i></p>
<p>Assign the SELinux <i>label</i> to <i>file</i>.  It is then necessary to </p>
<p>apply the label via </p>
<p>restorecon -f <i>file</i></p>
<p>semanage login -l</p>
<p>List mappings between users and SELinux users</p>
<p>semanage port -l</p>
<p>List port numbers and their assigned SELinux type </p>
<p>definitions</p>
<p>semanage port -a -t <i>portlabel</i> -p tcp <i>n</i></p>
<p>Assign the SELinux <i>portlabel</i> to TCP port <i>n</i></p>
<p>semanage port -a -t http_port_t -p tcp 8888</p>
<p>Allow a local webserver to serve content on port 8888</p>
<p>semanage port -d -t http_port_t -p tcp 8888</p>
<p>Remove the binding of </p>
<p>http_port_t</p>
<p> port label to TCP 8888</p>
<p>semanage port -m -t http_cache_port_t -p tcp 8888</p>
<p>Modify the port label bound to TCP 8888</p>
<p>semanage permissive -a auditd_t</p>
<p>Add </p>
<p>auditd_t</p>
<p> to the list of permissive types/domains.</p>
<p>In this case, SELinux allows the </p>
<p>auditd</p>
<p> daemon all access </p>
<p>while logging its AVC violations  </p>
<p>semanage permissive -d auditd_t</p>
<p>Delete </p>
<p>auditd_t</p>
<p> from the list of permissive types/domains</p>
<p>semanage permissive -l</p>
<p>List all permissive types/domains</p>
<p>sepolicy</p>
<p>Inspect a SELinux policy</p>
<p>sepolicy manpage -a -p /usr/local/man/man8 &amp;&amp; mandb</p>
<p>Generate all SELinux policy manpages</p>
<p>seinfo</p>
<p>Query the components of a SELinux policy</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>176/189</b></p>
<p><b>sealert</b></p>
<p><i>sealert</i></p>
<p>/var/log/audit/audit.log</p>
<p>Logfile containing AVC denials, if </p>
<p>auditd</p>
<p> is running</p>
<p>/var/log/messages</p>
<p>Logfile containing AVC denials, if </p>
<p>rsyslogd</p>
<p> is running.</p>
<p>AVC denials can also be seen via </p>
<p>dmesg</p>
<p>sealert -a <i>logfile</i></p>
<p>Analyze a SELinux logfile and display verbosely SELinux </p>
<p>policy violations.  </p>
<p>SELinux violation events are logged as </p>
<p>type=AVC msg=audit(<i>timest.amp:id</i>): avc:  denied </p>
<p>(...)</p>
<p>grep <i>timest.amp:id</i> <i>logfile</i> | audit2why </p>
<p>Diagnostic a specific AVC denial event entry (identified by a </p>
<p><i>timestamp</i> and an <i>id</i>) from a SELinux <i>logfile</i></p>
<p>audit2why -d</p>
<p>Read AVC violations from the output of </p>
<p>dmesg</p>
<p>ausearch -a <i>id</i></p>
<p>Query the SELinux log for event <i>id</i></p>
<p>audit2allow -i <i>inputfile</i> -M <i>module</i></p>
<p>Generate a loadable <i>module</i> containing the appropriate </p>
<p>SELinux policy from a denied operation stored in <i>inputfile</i></p>
<p>ausearch -c '(<i>exe</i>)' --raw | audit2allow -M <i>module</i></p>
<p>Generate a loadable module to allow access on an </p>
<p>executable which caused an AVC violation</p>
<p>semodule -l</p>
<p>List installed SELinux policy modules</p>
<p>semodule -X <i>n</i> -i <i>module.pp</i></p>
<p>Install a SELinux policy module at priority <i>n</i>.</p>
<p>Installed modules are not removed after reboot.</p>
<p>Module files have usually the suffix </p>
<p>.pp</p>
<p> (policy package)</p>
<p>semodule -X <i>n</i> -r <i>module</i></p>
<p>Remove a SELinux policy module at priority <i>n</i>.  </p>
<p>Modules must be removed at the same priority at which they</p>
<p>were installed</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>177/189</b></p>
<p><b>Kickstart</b></p>
<p><i>Kickstart</i></p>
<p>Kickstart is a method to perform automatic installation and configuration of RHEL machines.</p>
<p>This can be done by specifying </p>
<p>inst.ks=hd:/dev/sda:/root/path/ksfile</p>
<p> either as a boot option, or an option to the </p>
<p>kernel command in GRUB 2.</p>
<p>/root/anaconda-ks.cfg</p>
<p>Kickstart file describing the current system.  This file is automatically generated </p>
<p>during the installation</p>
<p>system-config-kickstart</p>
<p>GUI tool to create a Kickstart file</p>
<p>ksvalidator <i>ksfile</i></p>
<p>Check the validity of a Kickstart file</p>
<p>ksverdiff -f RHEL6 -t RHEL7</p>
<p>Show the differences in the Kickstart syntax between RHEL 6 and RHEL 7</p>
<p> </p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>178/189</b></p>
<p><b>Red Hat Satellite 6</b></p>
<p><i>Red Hat Satellite 6</i></p>
<p>Red Hat <b>Satellite</b> is a system management software that allows provisioning and configuration of RHEL machines.  </p>
<p>Repository content is provided via Red Hat Subscription Management (RHSM).  </p>
<p>Satellite 5 was based on Spacewalk, an open source system management software for Linux machines.  Satellite 6 is a </p>
<p>complete overhaul of it and is composed of:</p>
<p>- <b>Foreman</b>, an open source lifecycle management tool able to provision servers via Kickstart and Puppet;</p>
<p>- <b>Katello</b>, a tool that handles Red Hat repository management (via the <b>Pulp</b> service) and subscription management (via the</p>
<p><b>Candlepin</b> service).</p>
<p>All these components above need a PostgreSQL database, except Pulp which needs a MongoDB database.</p>
<p>As a separate component, <b>Capsule</b> servers act as a proxy for many of the main Satellite functions e.g. repository storage.  </p>
<p>A Capsule is also integrated in each Satellite server.     </p>
<p>subscription-manager register</p>
<p>Register a system to the RHSM portal</p>
<p>subscription-manager attach</p>
<p>Attach a RHSM subscription to a registered system</p>
<p>foreman-maintain service list</p>
<p>List all Satellite services</p>
<p>foreman-maintain service status</p>
<p>foreman-maintain service start</p>
<p>foreman-maintain service stop</p>
<p>foreman-maintain service restart</p>
<p>Display status or start, stop, restart all Satellite services.</p>
<p>Performed via </p>
<p>systemctl</p>
<p> </p>
<p>foreman-maintain backup</p>
<p>Make a backup of Satellite</p>
<p>foreman-rake <i>command:option</i></p>
<p>Perform various administrative tasks</p>
<p>hammer</p>
<p>CLI tool for Foreman</p>
<p>pulp-admin-client</p>
<p>Tool to administer the Pulp server</p>
<p>virt-who</p>
<p>Agent for reporting virtual guest IDs and hypervisors to a Satellite server</p>
<p>foreman-debug </p>
<p>Collect Satellite configuration, log, and backend data for debug purposes</p>
<p>sosreport</p>
<p>Collect diagnostic and configuration data for technical support </p>
<p>citellus.py <i>sosreportfile</i></p>
<p>Perform some automated checks for troubleshooting a system</p>
<p> </p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>179/189</b></p>
<p><b>KVM</b></p>
<p><i>KVM</i></p>
<p>KVM (Kernel-based Virtual Machine) is a virtualization infrastructure for the Linux kernel that allows it to function as a </p>
<p>hypervisor.</p>
<p>/etc/libvirt/qemu/</p>
<p>Directory containing the XML files that define VMs properties.</p>
<p>libvirtd</p>
<p> must be restarted after modifying an XML file</p>
<p>/var/lib/libvirt/</p>
<p>Directory containing files related to the VMs</p>
<p>virt-manager</p>
<p>KVM GUI</p>
<p>virt-install --prompt</p>
<p>Interactive command-line program to create a VM</p>
<p>virt-install -n <i>vmname</i> -r 2048 \</p>
<p>--disk path=/var/lib/libvirt/images/vmname.img \</p>
<p>-l /root/vmstuff/inst/ \</p>
<p>-x &quot;ks=/root/vmstuff/kickstart.cfg&quot;</p>
<p>Create a VM with 2 Gb of RAM, specifying path of virtual disk, </p>
<p>location of installation files, and (as extra argument) the </p>
<p>Kickstart configuration to use </p>
<p>virt-clone --prompt</p>
<p>Interactive command-line program to clone a VM.</p>
<p>A VM must be shut off or paused before it can be cloned</p>
<p>virt-clone -o <i>vmname</i> -n <i>vmclonename</i></p>
<p>Clone a VM </p>
<p>virsh</p>
<p>Interface for VM management</p>
<p>virsh list --all</p>
<p>List all VMs present on the system</p>
<p>virsh start <i>vmname</i></p>
<p>Start a VM</p>
<p>virsh destroy <i>vmname</i></p>
<p>Brutally shut down a VM</p>
<p>virsh shutdown <i>vmname</i></p>
<p>Gracefully shut down a VM</p>
<p>virsh autostart <i>vmname</i></p>
<p>Set a VM to be automatically started when the system boots.</p>
<p>Done by symlinking the VM to </p>
<p>/etc/libvirt/qemu/autostart/</p>
<p>virsh autostart --disable <i>vmname</i></p>
<p>Disable the autostart of a VM at system boot</p>
<p>virsh edit <i>vmname</i></p>
<p>Edit the XML file defining a VM's properties</p>
<p>virt-what</p>
<p>Detect whether the current machine is a VM</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>180/189</b></p>
<p><b>Git</b></p>
<p><i>Git</i></p>
<p>Git is an open source version control system with a small footprint and very high performances.  A Git directory is a </p>
<p>complete repository with full history and version tracking abilities, independent of any remote repository.</p>
<p>Git commits are identified by a 40-hex-digits hash number, usually shortened to 7 digits, or even less if unambiguous.</p>
<p>git init</p>
<p>Initialize the current directory as a repository</p>
<p>git clone <i>repo</i></p>
<p>Clone a remote repository.  </p>
<p><i>repo</i> can be an URL (SSH, HTTP, HTTPS, FTP, FTPS, Git) or a local path e.g.</p>
<p>ssh://user@example.com:8888/path/to/repo.git</p>
<p>git://example.com:9999/path/to/repo.git</p>
<p>/path/to/repo.git</p>
<p>git checkout <i>branch</i></p>
<p>Start working into an already existing <i>branch</i></p>
<p>git checkout -B <i>branch</i></p>
<p>Create <i>branch</i> and start working into it</p>
<p>git checkout -- <i>file</i></p>
<p>Discard local changes done to <i>file</i></p>
<p>git checkout <i>branch file</i></p>
<p>Copy <i>file</i> from <i>branch</i> to the current branch, and add it to the staging area</p>
<p>git pull</p>
<p>Pull the changes from the remote repository branch to the local branch</p>
<p>git add <i>file</i></p>
<p>Add <i>file</i> to the staging area (i.e. content staged for the next commit), hence </p>
<p>starting to track it</p>
<p>git add .</p>
<p>Add all modified files to the staging area</p>
<p>git rm <i>file</i></p>
<p>Remove <i>file</i> from the content staged for the next commit</p>
<p>git status</p>
<p>See the status (e.g. files changed but not yet staged) of the current branch</p>
<p>git commit -m &quot;<i>Message</i>&quot;</p>
<p>Commit all staged files in the current branch</p>
<p>git commit -am &quot;<i>Message</i>&quot;</p>
<p>Add all changed files to the staging area in the current branch, and commit them</p>
<p>git merge <i>branch</i></p>
<p>Merge changes made on <i>branch</i> to the master branch</p>
<p>git push</p>
<p>Push the local commits from the current branch to the remote repository</p>
<p>git push origin <i>branch</i></p>
<p>Push the local commits from <i>branch</i> to the remote repository</p>
<p>git revert <i>commit</i></p>
<p>Revert a specific commit</p>
<p>git branch</p>
<p>Show local branches</p>
<p>git branch -r</p>
<p>Show remote branches</p>
<p>git branch -a</p>
<p>Show remote and local branches</p>
<p>git branch -a --contains <i>commit</i></p>
<p>Show on which branch was done a specific commit number</p>
<p>git branch -d <i>branch</i></p>
<p>Delete a local branch (which must have been merged in its upstream branch) </p>
<p>git branch -D <i>branch</i></p>
<p>Delete a local branch (irrespective of its merged status) </p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>181/189</b></p>
<p><b>Git search and configuration</b></p>
<p><i>Git search and configuration</i></p>
<p>git diff <i>commit1 commit2</i></p>
<p>Show the differences between two commits</p>
<p>git diff <i>branch1 branch2 </i></p>
<p>Show the differences between two branches</p>
<p>git diff <i>branch1 branch2 file</i></p>
<p>Show the differences between two branches for a specific file</p>
<p>git log --all -- <i>file</i></p>
<p>Show the commits which involved <i>file</i>, across all branches</p>
<p>git log -p --all -S '<i>string</i>'</p>
<p>git log -p --all -G '<i>regex</i>'</p>
<p>Show the commits whose added or deleted lines contain a specific word</p>
<p>git grep <i>string</i> `git show-ref --heads`</p>
<p>Search for <i>string</i> across all branches' heads (i.e. in the latest content only,</p>
<p>and not in all the previous commits)</p>
<p>git config --list</p>
<p>Get all currently set options and their values in the Git configuration</p>
<p>git config <i>option</i></p>
<p>Get the value of <i>option</i> </p>
<p>git config user.name<i> name</i></p>
<p>Set your username </p>
<p>git config user.email<i> email</i></p>
<p>Set your email address</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>182/189</b></p>
<p><b>Vagrant</b></p>
<p><i>Vagrant</i></p>
<p>Vagrant is an open source software that allows building and maintaining lightweight and portable virtual environments for </p>
<p>software development.  It relies on an underlying virtualization solution e.g. VirtualBox. </p>
<p>vagrant -h</p>
<p>Print the list of commands recognized by Vagrant</p>
<p>vagrant <i>command</i> -h</p>
<p>Print help about the Vagrant <i>command</i></p>
<p>vagrant init hashicorp/precise64</p>
<p>Initialize the current directory as a specific Vagrant environment (in this case, </p>
<p>Ubuntu 12.04 64-bit) by creating a Vagrantfile on it</p>
<p>vagrant up <i>vmname</i></p>
<p>Start a guest virtual machine and do a first provisioning according to the </p>
<p>Vagrantfile</p>
<p>vagrant provision <i>vmname</i></p>
<p>Provision a virtual machine</p>
<p>vagrant ssh <i>vmname</i></p>
<p>Connect via SSH to a virtual machine</p>
<p>vagrant halt <i>vmname</i></p>
<p>Shut down the virtual machine</p>
<p>vagrant destroy <i>vmname</i></p>
<p>Delete the virtual machine and free any resource allocated to it</p>
<p>vagrant status</p>
<p>Print the status of the virtual machines currently managed by Vagrant</p>
<p>vagrant global-status</p>
<p>Print the status of all Vagrant environments on the system, by reading cached </p>
<p>data.  Completes quickly but results may be outdated</p>
<p>vagrant global-status --prune</p>
<p>Print the status of all Vagrant environments on the system, after rebuilding </p>
<p>the environment information cache.  Results are always correct but completion</p>
<p>takes longer</p>
<p>The directory containing the Vagrantfile on the host can be accessed on the guest via </p>
<p>/vagrant</p>
<p>.  </p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>183/189</b></p>
<p><b>Puppet</b></p>
<p><i>Puppet</i></p>
<p>Puppet is a software configuration management tool.  It is based on a client-server architecture, where a <b>Puppet agent</b> </p>
<p>(client, running as </p>
<p>root</p>
<p> on each managed node) periodically gathers information (<b>facts</b>) about the local node state via the </p>
<p><b>Facter</b> tool, then communicates this information to the <b>Puppet master</b> (server, running as the </p>
<p>puppet</p>
<p> user and listening </p>
<p>on TCP port 8140).  The Puppet master then sends back to the Puppet agent a <b>catalog</b> containing the desired configuration </p>
<p>for that node.  The Puppet agent applies the needed changes so that the node's configuration converges with the desired </p>
<p>configuration, and sends back a report to the Puppet master.  Puppet changes are idempotent.</p>
<p>Puppet configurations are based on <b>resources</b> (e.g. &quot;package&quot;, &quot;service&quot;, &quot;file&quot;, &quot;user&quot; ...).  For each resource, a list of </p>
<p><b>attributes</b> is specified, with the desired value for each attribute.  </p>
<p>Each resource type is implemented through <b>providers</b> (e.g. </p>
<p>yum</p>
<p>, </p>
<p>rpm</p>
<p>, </p>
<p>apt</p>
<p>, </p>
<p>opkg</p>
<p> ... for the resource &quot;package&quot;).</p>
<p>Resources managed together as a single unit can be grouped into <b>classes</b>; classes are contained in <b>manifests</b> which are </p>
<p>files with the </p>
<p>.pp</p>
<p> extension.</p>
<p><b>Modules</b> are directories containing self-contained pieces of configuration and classes for a specific complex setting, e.g. an </p>
<p>Apache webserver or a MySQL server.</p>
<p>/etc/puppet/puppet.conf</p>
<p>Configuration file (Open Source Puppet)</p>
<p>/etc/puppetlabs/puppet/puppet.conf</p>
<p>Configuration file (Puppet Enterprise)</p>
<p>facter</p>
<p>Gather the facts about the managed node, </p>
<p>returning a list of key-value pairs</p>
<p>puppet agent</p>
<p>Main Puppet client.  </p>
<p>Retrieves the node's desired configuration from</p>
<p>the Puppet master and applies it</p>
<p>puppet agent --enable</p>
<p>Enable the Puppet agent on the node</p>
<p>puppet agent --disable &quot;<i>Reason for disabling</i>&quot;</p>
<p>Disable the Puppet agent on the node</p>
<p>cat $(puppet config print vardir)/state/agent_disabled.lock</p>
<p>Print the reason why the Puppet agent is </p>
<p>currently disabled.  If the Puppet agent is </p>
<p>enabled instead, the lockfile does not exist</p>
<p>puppet agent --noop</p>
<p>Perform a dry run, displaying the changes that </p>
<p>Puppet would have applied without actually </p>
<p>applying them</p>
<p>puppet --version</p>
<p>puppet agent --version</p>
<p>puppet master --version</p>
<p>Show version of different Puppet components</p>
<p>puppet module list</p>
<p>List all modules installed in Puppet</p>
<p>puppet resource user <i>username</i></p>
<p>Inspect the state of the resource &quot;user&quot; with </p>
<p>respect to <i>username</i></p>
<p>puppet resource service httpd enable=false</p>
<p>Modify the state of the resource &quot;service&quot; (in </p>
<p>this case, disable the HTTP server)</p>
<p>puppet describe user</p>
<p>Show information about the resource &quot;user&quot;</p>
<p>puppet describe --list</p>
<p>List all resource types</p>
<p>puppet describe user --providers</p>
<p>Return the list of providers for the resource </p>
<p>&quot;user&quot;</p>
<p>puppet apply <i>modulename</i>/init.pp</p>
<p>Apply a manifest one time only</p>
<p>puppet cert <i>operation</i></p>
<p>Manage the SSL certificates used for </p>
<p>communications between master and agents</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>184/189</b></p>
<p><b>Ansible</b></p>
<p><i>Ansible</i></p>
<p>Ansible is an open source tool for configuration management and software provisioning.  It is agentless and connects to the </p>
<p>managed machines via SSH pubkey authentication.  It only requires OpenSSH and Python to be installed on the managed </p>
<p>nodes.</p>
<p>The configuration for managed nodes is specified in one or more <b>playbook</b>, written in YAML and containing a number of </p>
<p><b>tasks</b>.  When a playbook is run, first it collects system and environment information (<b>facts</b>) which is then stored in multiple </p>
<p>variables named </p>
<p>ansible_<i>varname</i></p>
<p>. </p>
<p>/etc/ansible/hosts</p>
<p>Inventory file, containing the list of hosts managed by Ansible.</p>
<p>Can be in INI or YAML format</p>
<p>ansible <i>hosts</i> -m <i>module options</i></p>
<p>Apply the <i>options</i> concerning <i>module</i> to the specified <i>hosts</i></p>
<p>ansible-playbook <i>options</i> <i>playbook</i>.yml</p>
<p>Apply the specified playbook</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>185/189</b></p>
<p><b>HTML 4.01 components</b></p>
<p><i>HTML 4.01 components</i></p>
<p><b>Tag</b></p>
<p><b>Attributes</b></p>
<p><b>&lt;h1&gt;</b></p>
<p><b> ... </b></p>
<p><b>&lt;h6&gt; </b></p>
<p><b>Heading</b></p>
<p> </p>
<p>align=left|center|right|justify</p>
<p>Heading alignment †</p>
<p><b>&lt;br&gt; </b></p>
<p><b>Line break</b></p>
<p>Line break and </p>
<p>carriage return</p>
<p><b>&lt;hr&gt; </b></p>
<p><b>Horizontal line</b></p>
<p>align=left|center|right</p>
<p>Line alignment †</p>
<p>noshade</p>
<p>Solid rendering instead of 3D †</p>
<p>size=<i>npixels</i></p>
<p>Line height</p>
<p>width=<i>npixels|percent</i>%</p>
<p>Line width</p>
<p><b>&lt;p&gt; </b></p>
<p><b>Paragraph</b></p>
<p><b>&lt;div&gt; </b></p>
<p><b>Section</b></p>
<p>align=left|center|right|justify</p>
<p>Paragraph or section alignment †</p>
<p><b>&lt;span&gt; </b></p>
<p><b>Group</b></p>
<p>Group of elements</p>
<p><b>&lt;a&gt; </b></p>
<p><b>Anchor</b></p>
<p>Hyperlink</p>
<p>charset=<i>encoding</i></p>
<p>Character encoding of target URL</p>
<p>coords=<i>left,top,right,bottom</i>|</p>
<p><i>cx,cy,radius</i>|<i>x1,y1,...,xn,yn</i></p>
<p>Coordinates of region; depends </p>
<p>on </p>
<p>shape</p>
<p>href=<i>url</i></p>
<p>Target URL for the link</p>
<p>hreflang=<i>language</i></p>
<p>Language of document at the </p>
<p>target URL</p>
<p>name=<i>section</i></p>
<p>Name of anchor for document </p>
<p>bookmarking</p>
<p>rel|rev=alternate|stylesheet|</p>
<p>start|next|prev|contents|index|</p>
<p>glossary|copyright|chapter|</p>
<p>section|subsection|appendix|</p>
<p>help|bookmark</p>
<p>Relationship between this </p>
<p>document and the target URL </p>
<p>(</p>
<p>rel</p>
<p>) or vice versa (</p>
<p>rev</p>
<p>)</p>
<p>shape=rectangle|circle|polygon</p>
<p>Shape of region</p>
<p>target=_blank|_parent|_self|_top</p>
<p>Destination of target URL</p>
<p>type=<i>mimetype</i></p>
<p>MIME type of target URL</p>
<p><b>&lt;dl&gt; </b></p>
<p><b>Definition list</b></p>
<p><b>&lt;dt&gt; </b></p>
<p><b>Definition term</b></p>
<p><b>&lt;dd&gt;</b></p>
<p><b>Definition description</b></p>
<p>Description of a </p>
<p>definition term</p>
<p><b>&lt;ol&gt; </b></p>
<p><b>Ordered list</b></p>
<p>compact=compact</p>
<p>List must be more compact †</p>
<p>start=<i>firstnumber</i></p>
<p>Number to start the list on †</p>
<p>type=A|a|I|i|1</p>
<p>List numbers type †</p>
<p><b>&lt;ul&gt; </b></p>
<p><b>Unordered list</b></p>
<p>compact=compact</p>
<p>List must be more compact †</p>
<p>type=disc|square|circle</p>
<p>List type †</p>
<p><b>&lt;li&gt; </b></p>
<p><b>List item</b></p>
<p>type=disc|square|circle|A|a|I|i|1</p>
<p>List item type †</p>
<p>value=<i>itemno</i></p>
<p>List item value †</p>
<p>† = deprecated</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>186/189</b></p>
<p><b>HTML 4.01 text</b></p>
<p><i>HTML 4.01 text</i></p>
<p><b>Tag</b></p>
<p><b>Attributes</b></p>
<p><b>&lt;i&gt; </b></p>
<p><b>Italic</b></p>
<p><b>&lt;b&gt; </b></p>
<p><b>Bold</b></p>
<p><b>&lt;s&gt; </b></p>
<p><b>&lt;strike&gt;</b></p>
<p><b>Strike-through</b></p>
<p>Strike-through text<b> </b>†</p>
<p><b>&lt;u&gt; </b></p>
<p><b>Underlined</b></p>
<p>Underlined text †</p>
<p><b>&lt;big&gt; </b></p>
<p><b>Bigger </b></p>
<p><b>&lt;small&gt; </b></p>
<p><b>Smaller </b></p>
<p><b>&lt;sub&gt; </b></p>
<p><b>Subscript </b></p>
<p><b>&lt;sup&gt; </b></p>
<p><b>Superscript </b></p>
<p><b>&lt;tt&gt; </b></p>
<p><b>Teletype </b></p>
<p>Monospaced text</p>
<p><b>&lt;em&gt; </b></p>
<p><b>Emphasized </b></p>
<p><b>&lt;strong&gt; </b></p>
<p><b>Strong </b></p>
<p><b>&lt;del&gt; </b></p>
<p><b>Deleted</b></p>
<p><b>&lt;ins&gt; </b></p>
<p><b>Inserted</b></p>
<p>Deleted/inserted text</p>
<p>cite=<i>url</i></p>
<p>URL to document explaining </p>
<p>deletion/insertion</p>
<p>datetime=<i>yyyy-mm-dd</i></p>
<p>When the text was deleted/inserted</p>
<p><b>&lt;pre&gt; </b></p>
<p><b>Preformatted</b></p>
<p>width=<i>ncharacters</i></p>
<p>Max number of characters per line †</p>
<p><b>&lt;code&gt; </b></p>
<p><b>Code</b></p>
<p>Source code text</p>
<p><b>&lt;samp&gt; </b></p>
<p><b>Sample </b></p>
<p>Sample code text</p>
<p><b>&lt;kbd&gt; </b></p>
<p><b>Keyboard </b></p>
<p>Keyboard key</p>
<p><b>&lt;var&gt; </b></p>
<p><b>Variable </b></p>
<p>Variable name</p>
<p><b>&lt;cite&gt; </b></p>
<p><b>Citation </b></p>
<p>Citation block</p>
<p><b>&lt;blockquote&gt; </b></p>
<p><b>Quotation</b></p>
<p><b>&lt;q&gt; </b></p>
<p><b>Short quotation </b></p>
<p>cite=<i>url</i></p>
<p>URL to document containing the </p>
<p>quote</p>
<p><b>&lt;address&gt;</b></p>
<p><b> Address </b></p>
<p>Address block</p>
<p><b>&lt;abbr&gt; </b></p>
<p><b>Abbreviation </b></p>
<p><b>&lt;acronym&gt; </b></p>
<p><b>Acronym </b></p>
<p><b>&lt;dfn&gt; </b></p>
<p><b>Definition </b></p>
<p>Definition term</p>
<p><b>&lt;font&gt; </b></p>
<p><b>Font</b></p>
<p>Font †</p>
<p>color=rgb(<i>r</i>,<i>g</i>,<i>b</i>)|#<i>rrggbb</i>|<i>color</i></p>
<p>Text color</p>
<p>face=<i>fontname</i></p>
<p>Text font</p>
<p>size=<i>[1 ... 7]</i>|<i>[-6 ... +6]</i></p>
<p>Text size</p>
<p><b>&lt;bdo&gt; </b></p>
<p><b>Bidirectional override </b></p>
<p>dir=ltr|rtl</p>
<p>Direction of text: left-to-right or </p>
<p>right-to-left</p>
<p><b>&lt;xmp&gt; </b></p>
<p><b>XMP</b></p>
<p>Non-formatted text † </p>
<p>(ignores other HTML tags)</p>
<p><b>other tags</b></p>
<p>Attributes common to </p>
<p>almost all other tags</p>
<p>class=<i>class</i>|<i>style</i></p>
<p>Class of the element</p>
<p>id=<i>id</i></p>
<p>Unique ID of the element</p>
<p>style=<i>styledef</i></p>
<p>Inline style definition</p>
<p>title=<i>tooltip</i></p>
<p>Text of the tooltip to display</p>
<p>dir=ltr|rtl</p>
<p>Direction of text: left-to-right or </p>
<p>right-to-left</p>
<p>lang=<i>language</i></p>
<p>Language of the content</p>
<p>accesskey=<i>character</i></p>
<p>Keyboard shortcut for the element</p>
<p>tabindex=<i>ntab</i></p>
<p>N of tab for the element</p>
<p>† = deprecated</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>187/189</b></p>
<p><b>HTML 4.01 images</b></p>
<p><i>HTML 4.01 images</i></p>
<p><b>Tag</b></p>
<p><b>Attributes</b></p>
<p><b>&lt;img&gt;</b></p>
<p><b>Image</b></p>
<p>align=top|bottom|left|middle|right</p>
<p>Image alignment with respect to surrounding text †</p>
<p>alt=<i>alternatetext</i></p>
<p>Description of the image for text-only browsers</p>
<p>border=<i>npixels</i></p>
<p>Border width around the image †</p>
<p>height=<i>npixels|percent</i>%</p>
<p>Image height</p>
<p>hspace=<i>npixels</i></p>
<p>Blank space on the left and right side of image †</p>
<p>ismap=<i>url</i></p>
<p>URL for server-side image map</p>
<p>longdesc=<i>url</i></p>
<p>URL containing a long description of the image</p>
<p>src=<i>url</i></p>
<p>URL of the image</p>
<p>usemap=<i>url</i></p>
<p>URL for client-side image map</p>
<p>vspace=<i>npixels</i></p>
<p>Blank space on top and bottom of image †</p>
<p>width=<i>npixels|percent</i>%</p>
<p>Image width</p>
<p><b>&lt;map&gt;</b></p>
<p><b>Image map</b></p>
<p>id=<i>id</i></p>
<p>Unique ID for the map tag </p>
<p>name=<i>name</i></p>
<p>Unique name for the map tag</p>
<p><b>&lt;area&gt;</b></p>
<p><b>Area of</b></p>
<p><b>image map</b></p>
<p>alt=<i>alternatetext</i></p>
<p>Description of area for text-only browsers</p>
<p>coords=<i>left,top,right,bottom</i>|</p>
<p><i>cx,cy,radius</i>|<i>x1,y1,...,xn,yn</i></p>
<p>Coordinates of clickable area; depends on </p>
<p>shape</p>
<p>href=<i>url</i></p>
<p>Target URL of area</p>
<p>nohref=true|false</p>
<p>Excludes or includes the area from image map</p>
<p>shape=rectangle|circle|polygon</p>
<p>Shape of area</p>
<p>target=_blank|_parent|_self|_top</p>
<p>Destination of target URL</p>
<p>† = deprecated</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>188/189</b></p>
<p><b>HTML 4.01 tables</b></p>
<p><i>HTML 4.01 tables</i></p>
<p><b>Tag</b></p>
<p><b>Attributes</b></p>
<p><b>&lt;table&gt;</b></p>
<p><b>Table</b></p>
<p>align=left|center|right</p>
<p>Table alignment †</p>
<p>bgcolor=rgb(<i>r</i>,<i>g</i>,<i>b</i>)|#<i>rrggbb</i>|<i>color</i></p>
<p>Table background color †</p>
<p>border=<i>npixels</i></p>
<p>Border width</p>
<p>cellpadding=<i>npixels</i>|<i>percent</i>%</p>
<p>Space around the content of each cell</p>
<p>cellspacing=<i>npixels</i>|<i>percent</i>%</p>
<p>Space between cells</p>
<p>frame=void|above|below|</p>
<p>lhs|rhs|hsides|vsides|box|border</p>
<p>Visibility of sides of the table border </p>
<p>rules=none|groups|rows|cols|all</p>
<p>Horizontal or vertical divider lines</p>
<p>summary=<i>summary</i></p>
<p>Summary of the table for text-only browsers</p>
<p>width=<i>npixels</i>|<i>percent</i>%</p>
<p>Table width</p>
<p><b>&lt;tr&gt;</b></p>
<p><b>Table row</b></p>
<p>align=left|center|right|justify|char</p>
<p>Horizontal text alignment</p>
<p>bgcolor=rgb(<i>r</i>,<i>g</i>,<i>b</i>)|#<i>rrggbb</i>|<i>color</i></p>
<p>Row background color †</p>
<p>char=<i>character</i></p>
<p>Character to align text on, if </p>
<p>align=char</p>
<p>charoff=<i>npixels</i>|<i>percent</i>%</p>
<p>Alignment offset to first character, if </p>
<p>align=char</p>
<p>valign=top|middle|bottom|baseline</p>
<p>Vertical text alignment</p>
<p><b>&lt;td&gt;</b></p>
<p><b>Table cell</b></p>
<p><b>&lt;th&gt;</b></p>
<p><b>Table header</b></p>
<p>abbr=<i>content</i></p>
<p>Abbreviated content in a cell</p>
<p>align=left|center|right|justify|char</p>
<p>Horizontal text alignment</p>
<p>axis=<i>category</i></p>
<p>Cell name</p>
<p>bgcolor=rgb(<i>r</i>,<i>g</i>,<i>b</i>)|#<i>rrggbb</i>|<i>color</i></p>
<p>Cell background color †</p>
<p>char=<i>character</i></p>
<p>Character to align text on, if </p>
<p>align=char</p>
<p>charoff=<i>npixels</i>|<i>percent</i>%</p>
<p>Alignment offset to first character, if </p>
<p>align=char</p>
<p>colspan=<i>ncolumns</i></p>
<p>Number of columns this cell spans on</p>
<p>headers=<i>headerid</i></p>
<p>Cell header information for text-only browsers</p>
<p>height=<i>npixels</i></p>
<p>Cell height †</p>
<p>nowrap</p>
<p>Text in cell stays on a single line †</p>
<p>rowspan=<i>nrows</i></p>
<p>Number of rows this cell spans on</p>
<p>scope=col|colgroup|row|rowgroup</p>
<p>Target for cell header information</p>
<p>valign=top|middle|bottom|baseline</p>
<p>Vertical text alignment</p>
<p>width=<i>npixels|percent%</i></p>
<p>Cell width †</p>
<p>† = deprecated</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>189/189</b></p>
<p><b>7-bit ASCII table</b></p>
<p><i>7-bit ASCII table</i></p>
<p><b>Dec</b></p>
<p><b>Hex</b></p>
<p><b> Char</b></p>
<p><b>Dec</b></p>
<p><b>Hex</b></p>
<p><b> Char</b></p>
<p><b>Dec</b></p>
<p><b>Hex</b></p>
<p><b> Char</b></p>
<p><b>Dec</b></p>
<p><b>Hex</b></p>
<p><b> Char</b></p>
<p>0</p>
<p>0</p>
<p><b>NUL</b></p>
<p>Null</p>
<p>32</p>
<p>20</p>
<p><b>space</b></p>
<p>64</p>
<p>40</p>
<p><b>@</b></p>
<p>96</p>
<p>60</p>
<p><b>`</b></p>
<p>1</p>
<p>1</p>
<p><b>SOH</b></p>
<p>Start of heading</p>
<p>33</p>
<p>21</p>
<p><b>!</b></p>
<p>65</p>
<p>41</p>
<p><b>A</b></p>
<p>97</p>
<p>61</p>
<p><b>a</b></p>
<p>2</p>
<p>2</p>
<p><b>STX</b></p>
<p>Start of text</p>
<p>34</p>
<p>22</p>
<p><b>&quot;</b></p>
<p>66</p>
<p>42</p>
<p><b>B</b></p>
<p>98</p>
<p>62</p>
<p><b>b</b></p>
<p>3</p>
<p>3</p>
<p><b>ETX</b></p>
<p>End of text</p>
<p>35</p>
<p>23</p>
<p><b>#</b></p>
<p>67</p>
<p>43</p>
<p><b>C</b></p>
<p>99</p>
<p>63</p>
<p><b>c</b></p>
<p>4</p>
<p>4</p>
<p><b>EOT</b></p>
<p>End of transmission</p>
<p>36</p>
<p>24</p>
<p><b>$</b></p>
<p>68</p>
<p>44</p>
<p><b>D</b></p>
<p>100</p>
<p>64</p>
<p><b>d</b></p>
<p>5</p>
<p>5</p>
<p><b>ENQ</b></p>
<p>Enquiry</p>
<p>37</p>
<p>25</p>
<p><b>%</b></p>
<p>69</p>
<p>45</p>
<p><b>E</b></p>
<p>101</p>
<p>65</p>
<p><b>e</b></p>
<p>6</p>
<p>6</p>
<p><b>ACK</b></p>
<p>Acknowledge</p>
<p>38</p>
<p>26</p>
<p><b>&amp;</b></p>
<p>70</p>
<p>46</p>
<p><b>F</b></p>
<p>102</p>
<p>66</p>
<p><b>f</b></p>
<p>7</p>
<p>7</p>
<p><b>BEL</b></p>
<p>Bell</p>
<p>39</p>
<p>27</p>
<p><b>'</b></p>
<p>71</p>
<p>47</p>
<p><b>G</b></p>
<p>103</p>
<p>67</p>
<p><b>g</b></p>
<p>8</p>
<p>8</p>
<p><b>BS</b></p>
<p>Backspace</p>
<p>40</p>
<p>28</p>
<p><b>(</b></p>
<p>72</p>
<p>48</p>
<p><b>H</b></p>
<p>104</p>
<p>68</p>
<p><b>h</b></p>
<p>9</p>
<p>9</p>
<p><b>TAB</b></p>
<p>Horizontal tab</p>
<p>41</p>
<p>29</p>
<p><b>)</b></p>
<p>73</p>
<p>49</p>
<p><b>I</b></p>
<p>105</p>
<p>69</p>
<p><b>i</b></p>
<p>10</p>
<p>A</p>
<p><b>LF</b></p>
<p>Line feed</p>
<p>42</p>
<p>2A</p>
<p><b>*</b></p>
<p>74</p>
<p>4A</p>
<p><b>J</b></p>
<p>106</p>
<p>6A</p>
<p><b>j</b></p>
<p>11</p>
<p>B</p>
<p><b>VT</b></p>
<p>Vertical tab</p>
<p>43</p>
<p>2B</p>
<p><b>+</b></p>
<p>75</p>
<p>4B</p>
<p><b>K</b></p>
<p>107</p>
<p>6B</p>
<p><b>k</b></p>
<p>12</p>
<p>C</p>
<p><b>FF</b></p>
<p>Form feed</p>
<p>44</p>
<p>2C</p>
<p><b>,</b></p>
<p>76</p>
<p>4C</p>
<p><b>L</b></p>
<p>108</p>
<p>6C</p>
<p><b>l</b></p>
<p>13</p>
<p>D</p>
<p><b>CR</b></p>
<p>Carriage return</p>
<p>45</p>
<p>2D</p>
<p><b>-</b></p>
<p>77</p>
<p>4D</p>
<p><b>M</b></p>
<p>109</p>
<p>6D</p>
<p><b>m</b></p>
<p>14</p>
<p>E</p>
<p><b>SO</b></p>
<p>Shift out</p>
<p>46</p>
<p>2E</p>
<p><b>.</b></p>
<p>78</p>
<p>4E</p>
<p><b>N</b></p>
<p>110</p>
<p>6E</p>
<p><b>n</b></p>
<p>15</p>
<p>F</p>
<p><b>SI</b></p>
<p>Shift in</p>
<p>47</p>
<p>2F</p>
<p><b>/</b></p>
<p>79</p>
<p>4F</p>
<p><b>O</b></p>
<p>111</p>
<p>6F</p>
<p><b>o</b></p>
<p>16</p>
<p>10</p>
<p><b>DLE</b></p>
<p>Data link escape</p>
<p>48</p>
<p>30</p>
<p><b>0</b></p>
<p>80</p>
<p>50</p>
<p><b>P</b></p>
<p>112</p>
<p>70</p>
<p><b>p</b></p>
<p>17</p>
<p>11</p>
<p><b>DC1</b></p>
<p>Device control 1</p>
<p>49</p>
<p>31</p>
<p><b>1</b></p>
<p>81</p>
<p>51</p>
<p><b>Q</b></p>
<p>113</p>
<p>71</p>
<p><b>q</b></p>
<p>18</p>
<p>12</p>
<p><b>DC2</b></p>
<p>Device control 2</p>
<p>50</p>
<p>32</p>
<p><b>2</b></p>
<p>82</p>
<p>52</p>
<p><b>R</b></p>
<p>114</p>
<p>72</p>
<p><b>r</b></p>
<p>19</p>
<p>13</p>
<p><b>DC3</b></p>
<p>Device control 3</p>
<p>51</p>
<p>33</p>
<p><b>3</b></p>
<p>83</p>
<p>53</p>
<p><b>S</b></p>
<p>115</p>
<p>73</p>
<p><b>s</b></p>
<p>20</p>
<p>14</p>
<p><b>DC4</b></p>
<p>Device control 4</p>
<p>52</p>
<p>34</p>
<p><b>4</b></p>
<p>84</p>
<p>54</p>
<p><b>T</b></p>
<p>116</p>
<p>74</p>
<p><b>t</b></p>
<p>21</p>
<p>15</p>
<p><b>NAK</b></p>
<p>Negative ACK</p>
<p>53</p>
<p>35</p>
<p><b>5</b></p>
<p>85</p>
<p>55</p>
<p><b>U</b></p>
<p>117</p>
<p>75</p>
<p><b>u</b></p>
<p>22</p>
<p>16</p>
<p><b>SYN</b></p>
<p>Synchronous idle</p>
<p>54</p>
<p>36</p>
<p><b>6</b></p>
<p>86</p>
<p>56</p>
<p><b>V</b></p>
<p>118</p>
<p>76</p>
<p><b>v</b></p>
<p>23</p>
<p>17</p>
<p><b>ETB</b></p>
<p>End of Tx block</p>
<p>55</p>
<p>37</p>
<p><b>7</b></p>
<p>87</p>
<p>57</p>
<p><b>W</b></p>
<p>119</p>
<p>77</p>
<p><b>w</b></p>
<p>24</p>
<p>18</p>
<p><b>CAN</b></p>
<p>Cancel</p>
<p>56</p>
<p>38</p>
<p><b>8</b></p>
<p>88</p>
<p>58</p>
<p><b>X</b></p>
<p>120</p>
<p>78</p>
<p><b>x</b></p>
<p>25</p>
<p>19</p>
<p><b>EM</b></p>
<p>End of medium</p>
<p>57</p>
<p>39</p>
<p><b>9</b></p>
<p>89</p>
<p>59</p>
<p><b>Y</b></p>
<p>121</p>
<p>79</p>
<p><b>y</b></p>
<p>26</p>
<p>1A</p>
<p><b>SUB</b></p>
<p>Substitute</p>
<p>58</p>
<p>3A</p>
<p><b>:</b></p>
<p>90</p>
<p>5A</p>
<p><b>Z</b></p>
<p>122</p>
<p>7A</p>
<p><b>z</b></p>
<p>27</p>
<p>1B</p>
<p><b>ESC</b></p>
<p>Escape</p>
<p>59</p>
<p>3B</p>
<p><b>;</b></p>
<p>91</p>
<p>5B</p>
<p><b>[</b></p>
<p>123</p>
<p>7B</p>
<p><b>{</b></p>
<p>28</p>
<p>1C</p>
<p><b>FS</b></p>
<p>File separator</p>
<p>60</p>
<p>3C</p>
<p><b>&lt;</b></p>
<p>92</p>
<p>5C</p>
<p><b>\</b></p>
<p>124</p>
<p>7C</p>
<p><b>|</b></p>
<p>29</p>
<p>1D</p>
<p><b>GS</b></p>
<p>Group separator</p>
<p>61</p>
<p>3D</p>
<p><b>=</b></p>
<p>93</p>
<p>5D</p>
<p><b>]</b></p>
<p>125</p>
<p>7D</p>
<p><b>}</b></p>
<p>30</p>
<p>1E</p>
<p><b>RS</b></p>
<p>Record separator</p>
<p>62</p>
<p>3E</p>
<p><b>&gt;</b></p>
<p>94</p>
<p>5E</p>
<p><b>^</b></p>
<p>126</p>
<p>7E</p>
<p><b>~</b></p>
<p>31</p>
<p>1F</p>
<p><b>US</b></p>
<p>Unit separator</p>
<p>63</p>
<p>3F</p>
<p><b>?</b></p>
<p>95</p>
<p>5F</p>
<p><b>_</b></p>
<p>127</p>
<p>7F</p>
<p><b>DEL</b></p>
<p>Delete</p>
<p>Characters 0-31 and 127 are non-printable.</p>
<p>ascii</p>
<p>man ascii</p>
<p>Display an ASCII table</p>
<p>showkey -a</p>
<p>Prompt for pressing a key and display its ASCII value in decimal, octal, and hex</p>
<p><b>Linux Quick Reference Guide     8</b></p>
<p><b>th</b></p>
<p><b> ed., Jan 2020</b></p>
<p><b>© Daniele Raffo     www.crans.org/~raffo</b></p>
</body>
</html>